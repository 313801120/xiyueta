/*! xiyueta v1.1.4 | Author xiyueta Adream | MIT License By http://xiyueta.com/  */
function XiyuetaCommon(){}XiyuetaCommon.prototype.copyStr=function(e,l){var r="";for(let t=1;t<=l;t++)r+=e;return r},XiyuetaCommon.prototype.bystesLength=function(t){for(var e=0,l=0;l<t.length;l++)255<t.charCodeAt(l)?e+=2:e++;return e},XiyuetaCommon.prototype.getFileSize=function(t){return t<1048576?(t/1024).toFixed(2)+"KB":1048576==t?"1MB":1048576<t&&t<1073741824?(t/1048576).toFixed(2)+"MB":1048576<t&&1073741824==t?"1GB":1073741824<t&&t<1099511627776?(t/1073741824).toFixed(2)+"GB":"文件超过1TB"},function(){var i=new(window._XIYUETA=function(t){"use strict";this.htmlSource=t=null==t?"":t,this.htmlArr=[],this.common=new XiyuetaCommon,this.config={version:"1.1.4",httpurl:"",serverurl:"/api/downWeb/default.asp",jsdir:"js/",cssdir:"css/",imagesdir:"images/"},this.tplConfig={type:"xiyuetacms",item:4},this.htmlParse=function(t){null!=t&&(this.htmlSource=t,this.htmlArr=[]);for(var e="",l="",r="",i="",n=!1,s=!1,a=!1,h=!1,o=!1,u=0,f=0;f<=this.htmlSource.length-1;f++){var m,e=this.htmlSource.substr(f,1);n?(r+=e,h?">"==e&&"--\x3e"==r.substr(-3,3)&&(a=n=h=!1,this.htmlArr.push({lv:u+1,label:"!--",upHtml:i,html:r,tagpair:1}),i=r=""):s&&"\x3c!--"==r?h=!0:o?">"==e&&"%>"==r.substr(-2,2)&&(a=n=o=!1,this.htmlArr.push({lv:u+1,label:"<%",upHtml:i,html:r,tagpair:1}),i=r=""):s&&"<%"==r?o=!0:" "==e&&s?s=!1:">"==e&&(n=s=!1,m=2,"/"==l.substr(0,1)?a=!0:(u++,"/"!=l.substr(-1,1)&&-1=="|br|hr|img|link|meta|param|input|!doctype|".indexOf("|"+l.toLowerCase()+"|")||(a=!0,m=1,l=l.replace(/\//g,"").trim())),this.htmlArr.push({lv:u,label:l.toLowerCase(),upHtml:i,html:r,tagpair:m}),i=r="",a&&(u--,a=!1),"script"==l.toLowerCase()&&(m=this.htmlSource.substr(f+1).toLowerCase().indexOf("<\/script>"),r=this.htmlSource.substr(f+1,m),f+=m)),s&&(l+=e)):"<"==e?(i=r,r=e,a=!(s=n=!0),l=""):r+=e}""!=r&&this.htmlArr.push({lv:u,label:"",upHtml:"",html:r})},this.handleLeLabelParam=function(l,t,r){if(null==r&&null!=l[t])return l[t];for(var e=!1,i="",n="",s=!1,a="",h=!1,o=!0,u=0,f=!1,m=l.label.length+1;m<=l.html.length-1;m++){var p=l.html.substr(m,1);if(s)if(h)if(f)">"==p&&(f=!1),n+=p;else if(p==a||">"==p){if(l[i=i.toLowerCase()]=n,h=s=!1,a="",t==i){if(null==r)return n;{let t=u,e=u+n.length;o&&(t++,e++);var c=l.html.substr(0,t),g=l.html.substr(e);return l.html=c+r+g,l[i]=r,l}}if(">"==p&&null!=r)return l.html=l.html.substr(0,l.html.length-1)+" "+t+'="'+r+'">',l[t]=r,!0}else"<"==p&&(f=!0),n+=p;else'"'==p||"'"==p?(a=p,u=m,o=h=!0):" "!=p&&(a=" ",u=m,n=p,o=!(h=!0));else if(">"==p){if(null!=r)return l.html=l.html.substr(0,l.html.length-1)+" "+t+'="'+r+'">',l[t]=r,!0}else e?"="==p?(s=!(e=!1),a=n=""):" "!=p&&(i+=p):" "!=p&&(e=!0,i=p)}return""},this.getDocument=function(l="*All*",t,e,r){null==t&&(t=0),null==e&&(e=0),null==r&&(r=this.htmlArr.length-1);var i=!1,n="",s=0,a=0,h="",o=-1,u=!1,f="",m="",p="",c="",g=!1;if(-1!=(l=l.trim()).indexOf("'")||-1!=l.indexOf('"')){var d=!1;let e="";for(let t=0;t<=l.length;t++){var b=l.substr(t,1);0!=d||"'"!=b&&'"'!=b?1==d&&(" "==b?b="-Space-":"'"!=b&&'"'!=b||(d=!1,b="")):(d=!0,b=""),e+=b}l=e}var C,v=l.indexOf(" ");-1!=v&&(f=l.substr(v+1),l=l.substr(0,v)),-1!=l.indexOf(":eq(")?(h=(C=l.split(":eq("))[0],""!=f&&(u=!0,h+=" "+f),""!=(o=C[1].substr(0,C[1].indexOf(")")).trim())&&(o=parseInt(o))):-1!=l.indexOf("[")?(h=(C=l.split("["))[0],""!=f&&(u=!0,h+=" "+f),m=(C=(b=C[1].substr(0,C[1].indexOf("]")).trim()).split("="))[0],p=C[1].replace(/-Space-/g," "),-1!=m.indexOf("|")&&(m=(C=m.split("|"))[0],c=C[1])):(h=l,""!=f&&(u=!0,h+=" "+f));for(var x=e;x<=r;x++){var L,y=this.htmlArr[x];if(null!=y)if(0==u)if(!i||y.label!="/"+h&&"*All*"!=h||s!=y.lv)y.label!=h&&"*All*"!=h||0!=i||(1!=y.tagpair&&(i=!0,s=y.lv),a=x,""==f&&(""!=m?(b=this.handleLeLabelParam(y,m),(b="NOUL"==c?b.toLowerCase():b)==p&&(n+=","+x,2==y.tagpair?g=!0:t++)):t==o||-1==o?(n+=","+x,2==y.tagpair?g=!0:t++):1==y.tagpair&&t++));else{if(g&&(n+="|"+x),t==o)return n;g=i=!1,t++,n+=this.getDocument(l,t,a+1,x)}else!i||y.label!="/"+h.substr(0,y.label.length-1)&&"*All*"!=h||s!=y.lv?y.label!=h.substr(0,y.label.length)&&"*All*"!=h||0!=i||(1!=y.tagpair&&(i=!0,s=y.lv),a=x,""!=m?(b=this.handleLeLabelParam(y,m),(b="NOUL"==c?b.toLowerCase():b)==p&&(2==y.tagpair?g=!0:t++)):t!=o&&-1!=o||(2==y.tagpair?g=!0:t++)):(y=g?(L=f,0):(L=l,""!=f&&(L+=" "+f),t+1),t++,g=i=!1,n+=this.getDocument(L,y,a+1,x))}return n},this.each=function(t,e){var l=[];t=t.trim();for(var r,i,n=this.getDocument(t),s=n.split(","),a=1;a<=s.length-1;a++)-1!=(n=s[a]).indexOf("|")?(r=n.split("|"),i=this.htmlArr[r[0]],this.handleLeLabelParam(i,"NO&.NO"),i.innerHTML=this.getLabelHtml(parseInt(r[0]),parseInt(r[1]))):(i=this.htmlArr[n],this.handleLeLabelParam(i,"NO&.NO")),l.push(i);if(Array.isArray(l))for(var a=0,h=l.length;a<h&&0!=e.call(null,a,l[a]);a++);},this.getItem=function(t,e){null==e&&(e="");for(var l=[],r=(o=this.getDocument(t)).split(","),i=1;i<=r.length-1;i++)if(-1!=(o=r[i]).indexOf("|")){var n=o.split("|"),s=this.htmlArr[n[0]];if(""!=e)""!==(o=this.handleLeLabelParam(s,e))&&l.push(o);else{for(var a=s.html,h=parseInt(n[0])+1;h<=n[1];h++)null!=(s=this.htmlArr[h])&&(a+=s.upHtml+s.html);""!=a&&l.push(a)}}else{var o,s=this.htmlArr[o];""!=e?""!==(o=this.handleLeLabelParam(s,e))&&l.push(o):l.push(s.html)}return l},this.replace=function(t,e,l,r){for(var i,n=this.getDocument(t),s=n.split(","),a=1;a<=s.length-1;a++)i=-1!=(n=s[a]).indexOf("|")?(i=n.split("|"),this.htmlArr[i[0]]):this.htmlArr[n],""!=e&&(n=this.handleLeLabelParam(i,e))==l&&this.handleLeLabelParam(i,e,r)},this.attr=function(t,e,l){if(""==(e=(e=null==e?"":e).trim()))return"";if("object"==typeof t)return null==l?this.handleLeLabelParam(t,e):this.handleLeLabelParam(t,e,l);var r=(s=this.getDocument(t)).split(",");if(null==l){var i=(s=r[1]).split("|"),n=this.htmlArr[i[0]];return s=this.handleLeLabelParam(n,e)}for(var s,a=1;a<=r.length-1;a++)n=-1!=(s=r[a]).indexOf("|")?(i=s.split("|"),this.htmlArr[i[0]]):this.htmlArr[s],this.handleLeLabelParam(n,e,l);return""},this.getText=function(t){t=t.trim();for(var e="",l=this.getDocument(t),r=l.split(","),i=1;i<=r.length-1;i++)if(-1!=(l=r[i]).indexOf("|"))for(var n=l.split("|"),s=parseInt(n[0])+1;s<=n[1];s++)null!=this.htmlArr[s]&&(e+=this.htmlArr[s].upHtml);return e},this.getHtml=function(t,e){e="|"+e+"|";var l="",r=this.getDocument(t),t=r.split(",");if(t.length<2)return"";if(-1!=(r=t[1]).indexOf("|"))for(var t=r.split("|"),i=parseInt(t[0]),n=parseInt(t[1]),s=i;s<=n;s++){var a=this.htmlArr[s];a&&(i<s&&-1==e.indexOf("doc")&&(l+=a.upHtml),(-1!=e.indexOf("all")||i<s&&s<n&&-1!=e.indexOf("doc")&&"!--"!=a.label)&&(-1!=e.indexOf("lable")?l+="<"+a.label+">":l+=a.html))}else""!=r&&-1!=e.indexOf("all")&&(-1!=e.indexOf("label")?l+="<"+a.label+">":l=this.htmlArr[r].html);return l},this.setHtml=function(t,e,l){t=t.trim();for(var r=this.getDocument(t),i=r.split(","),n=1;n<=i.length-1;n++)if(-1!=(r=i[n]).indexOf("|"))for(var s=r.split("|"),a=parseInt(s[0]),h=parseInt(s[1]),o=a;o<=h;o++){var u=this.htmlArr[o];u&&(o==a?"all"==l&&(u.html=""):o<h?delete this.htmlArr[o]:o==h&&(u.upHtml=e,"all"==l&&(u.html="")))}},this.labelSwap=function(t,e){if(null==t||null==e)return!1;t=this.getDocument(t),e=this.getDocument(e);if(""==t||""==e)return!1;if(t=t.replace(/,/,""),e=e.replace(/,/,""),-1==t.indexOf("|"))var l=this.htmlArr[t];else{for(var r=t.split("|"),l=this.htmlArr[r[0]],i="",n=parseInt(r[0])+1;n<=r[1];n++)null!=(a=this.htmlArr[n])&&(i+=a.upHtml+a.html,delete this.htmlArr[n]);l.html+=i}if(-1==e.indexOf("|"))var s=this.htmlArr[e];else{for(var a,r=e.split("|"),s=this.htmlArr[r[0]],i="",n=parseInt(r[0])+1;n<=r[1];n++)null!=(a=this.htmlArr[n])&&(i+=a.upHtml+a.html,delete this.htmlArr[n]);s.html+=i}e=l.html;return l.html=s.html,s.html=e,!0},this.deleteDoc=function(t){if(t=t.trim(),""==(r=this.getDocument(t)))return!1;for(var e=r.split(","),l=1;l<=e.length-1;l++){var r=e[l];if(-1!=r.indexOf("|"))for(var i,n=r.split("|"),s=parseInt(n[0]),a=parseInt(n[1]),h=s;h<=a;h++)(i=this.htmlArr[h])&&(h==s?(i.html="",i.label=""):delete this.htmlArr[h]);else(i=this.htmlArr[r])&&(i.html="",i.label="")}return!0},this.setConfig=function(t){if(null==t)return this.config;null!=t.httpurl&&(this.config.httpurl=t.httpurl),null!=t.serverurl&&(this.config.serverurl=t.serverurl),null!=t.jsdir&&(this.config.jsdir=t.jsdir),null!=t.cssdir&&(this.config.cssdir=t.cssdir),null!=t.imagesdir&&(this.config.imagesdir=t.imagesdir)},this.printHtml=function(t){for(var e="",l=-1,r=-1,i=0,n=0;n<=this.htmlArr.length-1;n++){var s,a,h=this.htmlArr[n];h&&("format"==t?(s=h.upHtml.trim(),a=h.html.trim(),r=h.lv,"html"==h.label?i=-1:"head"!=h.label&&"body"!=h.label||(s+="\n"),""!=a&&0==("/"==h.label.substr(0,1)&&h.lv==l)&&(a="\n"+this.common.copyStr("    ",h.lv-1+i)+a,h.lv!=l&&""!=s&&"\n"!=s&&(r=h.lv,"/"!=h.label.substr(0,1)&&r--,s="\n"+this.common.copyStr("    ",r+i)+s)),e+=s+a):e+="zip"==t?h.upHtml.trim()+h.html.trim():h.upHtml+h.html,2==h.tagpair&&(l=h.lv))}return e="format"==t?e.trim():e},this.debug=function(t){console.log(this.htmlArr)}});console.log("%c XiYueTa %c v"+i.config.version+" 加载完成 ","font-size:18px;color:#00bbee","color:#000"),window.xiyueta=function(r,t,e){return{text:function(t){return null!=t?i.setHtml(r,t):i.getText(r)},html:function(t,e){return null!=t?i.setHtml(r,t,e):i.getHtml(r,e)},doc:function(t){return i.getHtml(r,"doc|"+t)},attr:function(t,e){return i.attr(r,t,e)},item:function(t){return i.getItem(r,t)},each:function(t){return i.each(r,t)},remove:function(){return i.deleteDoc(r)},handle:function(t,e,l){return i.handleLabelParam(r,t,e,l)},clear:function(t){return i.removeNotNeededLabel(t)},charset:function(t){return i.handleWebCharset(t)},fullurl:function(t){return i.common.fullHttpUrl(r,t)},geturlfilename:function(t){return i.common.getUrlFileName(t)},config:function(t){return i.setConfig(t)},tplconfig:function(t){return i.tplConfig},swap:function(t){return i.labelSwap(r,t)},replace:function(t,e,l){return i.replace(r,t,e,l)},scan:function(t){return i.scan(t)},cutlabel:function(t){return i.cutLabel(r,t)},webtpl:function(t){return i.webtpl(r,t)},nav:function(t){return i.nav(r,t)},news:function(t){return i.news(r,t)},parse:function(){return i.htmlParse(r)},print:function(t){return i.printHtml(t)},debug:function(t){return i.debug(t)},test:function(){alert(r+","+t+","+e)},author:function(){alert("作者：小云\nQQ313801120\n官网:xiyueta.com")}}}}(),function(){var r=new(window._XIYUETACSS=function(t){"use strict";this.cssSource=t=null==t?"":t,this.cssArr=[],this.common=new XiyuetaCommon,this.config={parentdir:"../",imagesdir:"images/"},this.cssParse=function(t){null!=t&&(this.cssSource=t,this.cssArr=[]);for(var e,l="",r="",i="",n="",s=!1,a=!1,h=!1,o=!1,u=!1,f=0,m=0;m<=this.cssSource.length-1;m++)e=l,l=this.cssSource.substr(m,1),s?(i+=l,h?"/"==l&&"*"==e&&(s=h=!1,this.cssArr.push({lv:1,label:"/*",upHtml:n,html:i}),n=i=""):a&&"*"==l&&"/"==e?h=!0:o?!u||";"!=l&&"\n"!=l?" "==l&&a?"@charset "==i.toLowerCase()?a=!(u=!0):"@font-face "==i.toLowerCase()&&(o=!1):"{"==l&&("@font-face "==i.toLowerCase()?o=!1:(o=s=a=!1,this.cssArr.push({lv:1,label:r.toLowerCase().trim(),upHtml:n,html:i}),f++,n=i="")):(o=s=a=u=!1,this.cssArr.push({lv:1,label:r.toLowerCase().trim(),upHtml:n,html:i}),n=i=""):"{"==l&&a?a=!1:"}"==l&&(s=a=!1,this.cssArr.push({lv:f+1,label:r.toLowerCase().trim(),upHtml:n,html:i}),n=i=""),a&&(" "!=l||" "!=e&&","!=e)&&(r+=l)):" "!=l&&";"!=l&&"\n"!=l?"}"==l&&1==f?(this.cssArr.push({lv:f,label:"}",upHtml:n,html:"}"}),n=i="",f--):(n=i,a=s=!0,"@"==(r=i=l)&&(o=!0)):i+=l;""!=i&&this.cssArr.push({lv:f,label:"",upHtml:"",html:i})},this.handleLeLabelParam=function(l,t="[All]",r){if(null==r&&null!=l[t])return l[t];var e,i="";-1!=t.indexOf("|")&&(t=(e=t.split("|"))[0],i=e[1],""==t&&(t="[All]"));for(var n=!1,s="",a="",h=!1,o="",u=!1,f=!0,m=0,p="",c=l.html.indexOf("{")+1;c<=l.html.length-1;c++){var g=l.html.substr(c,1);if(h)if(u)if(g==o||"}"==g||c==l.html.length-1){if(l[s=s.toLowerCase().trim()]=a,u=h=!1,o="",t==s||"[All]"==t)if(null==r){if("url"!=i)return a;""!=(a=this.getSetCssBg(a))&&(""!=p&&(p+="\n"),p+=a)}else{let t=m,e=m+a.length;f&&(t++,e++);var d=l.html.substr(0,t),b=l.html.substr(e);if("url"!=i)return l.html=d+r+b,l[s]=r,l;var C=this.getSetCssBg(a,r);""!=C&&(""!=p&&(p+="\n"),p+=C,l.html=d+C+b,c=(d+(l[s]=C)).length)}}else a+=g;else" "!=g&&(o=";",m=c,f=!(u=!0),a=g);else n?":"==g?(h=!(n=!1),o=a=""):" "!=g&&(s+=g):" "!=g&&(n=!0,s=g)}return p},this.getSetCss=function(t="[All]",e,l){t=t.trim();for(var r=0;r<=this.cssArr.length-1;r++){var i=this.cssArr[r];if(null!=i&&(t==i.label||"[All]"==t))return null==e?i.html:this.handleLeLabelParam(i,e,l)}},this.getSetCssBg=function(t,e){if(-1==t.indexOf(","))return this.handleCssBg(t,e);var l=t.split(","),r="";for(let t=0;t<l.length;t++){var i=l[t];""!=r&&(r+=","),r+=i=this.handleCssBg(i,e)}return r},this.handleCssBg=function(e,l){if(null==e)return"";if(-1==e.indexOf("(")||-1==e.indexOf(")"))return null==l||"dir="==l.substr(0,4)||"server="==l.substr(0,7)?"":e;if(-1==e.toLowerCase().indexOf("url"))return null==l||"dir="==l.substr(0,4)||"server="==l.substr(0,7)?"":e;var r="",i=!1,n=!1,s="",a=-1;for(let t=0;t<=e.length-1;t++){var h=e.substr(t,1);if(i)if(n){if(s==h){var o=e.substr(a,t-a);if(null!=l)if("server="==l.substr(0,7)){if(-1!=o.indexOf("data:image/"))return e;o=e.substr(0,a)+this.common.fullHttpUrl(l.substr(7),o)+e.substr(t)}else if("dir="==l.substr(0,4)){if(-1!=o.indexOf("data:image/"))return e;o=e.substr(0,a)+l.substr(4)+this.common.getUrlFileName(o)+e.substr(t)}else o=e.substr(0,a)+l+e.substr(t);return o}}else""!=h&&('"'==h||"'"==h?(n=!0,s=h,-1==a&&(a=t+1)):(n=!0,s=")",-1==a&&(a=t)));else if("("==h){if("url"==r.trim().toLowerCase().substr(-3,3))i=!0;else if(null==l)return""}else r+=h}return e},this.getSetAllCss=function(t="[All]",e,l){for(var r=","+(t=t.trim())+",",i="",n=0;n<=this.cssArr.length-1;n++){var s,a,h=this.cssArr[n];null!=h&&(s=","+h.label+",",h.label,-1==s.indexOf(r)&&"[All]"!=t||(null==e||"object"==typeof(a=this.handleLeLabelParam(h,e,l))?(""!=i&&(i+="\n"),i+=h.html):a&&(""!=i&&(i+="\n"),i+=a)))}return i},this.handleCssCharset=function(t){for(var e=0;e<=this.cssArr.length-1;e++){var l=this.cssArr[e];if(null!=l)if("@charset"==l.label)return null!=t?(l.html='@charset "'+t+'";',""):l.html.substr(9).replace(/"/g,"").replace(/'/g,"").replace(/;/g,"").trim().toLowerCase()}return""},this.handleCssBackGround=function(t,e=""){var l="";xiyuetaCSS().allcss("|url","server="+e),l=(l=xiyuetaCSS().allcss("|url")).replace(/,/g,"\n"),xiyuetaCSS().allcss("|url","dir="+this.config.parentdir+this.config.imagesdir);for(var r,i=l.split("\n"),n="",s=0;s<=i.length-1;s++)""!=(r=i[s])&&(""!=n&&(n+="[,]"),n+=(r=-1!=r.indexOf("?")?r.substr(0,r.indexOf("?")):r)+"[|]images/"+xiyueta().geturlfilename(r));return n},this.setConfig=function(t){if(null==t)return this.config;if(null!=t.imagesdir){this.config.imagesdir=t.imagesdir;for(var e=t.cssdir.split("/"),l="",r=0;r<=e.length-2;r++)l+="../";this.config.parentdir=l}null!=t.parentdir&&(this.config.parentdir=t.parentdir)},this.printCss=function(t){for(var e="",l=0;l<=this.cssArr.length-1;l++){var r,i=this.cssArr[l];null!=i&&(r=i.upHtml+i.html,""!=(r="zip"==t?"/*"==i.label?"":r.replace(/  /g," ").replace(/  /g," ").replace(/{ /g,"{").replace(/ {/g,"{").replace(/\n/g,"").trim():r)&&(e+=r+"\n"))}return e},this.debug=function(){console.log(this.cssArr)}});window.xiyuetaCSS=function(l){return{css:function(t,e){return r.getSetCss(l,t,e)},allcss:function(t,e){return r.getSetAllCss(l,t,e)},handlecssimg:function(t,e){return r.handleCssBackGround(t,e)},charset:function(t){return r.handleCssCharset(t)},parse:function(){return r.cssParse(l)},config:function(t){return r.setConfig(t)},print:function(t){return r.printCss(t)},debug:function(t){return r.debug(t)}}}}(),XiyuetaCommon.prototype.handleFileUrl=function(t){var e="",l=t.indexOf("://");for(-1!=l&&(e=t.substr(0,l+3),t=t.substr(l+3));-1!=t.indexOf("//");)t=t.replace(/\/\//g,"/");if(-1!=(t=-1!=t.indexOf("/./")?t.replace(/\/.\//g,"/"):t).indexOf("/../")){for(var r=[],i=0,n=t.split("/"),s=0;s<=n.length-1;s++)".."==(a=n[s])?(0==i?i=s-1:--i,0<=i&&delete r[i]):(r.push(a),i=0);for(t="",s=0;s<=r.length-1;s++){var a=r[s];null!=r[s]&&(""!=t&&(t+="/"),t+=r[s])}}return e+t},XiyuetaCommon.prototype.fullHttpUrl=function(t,e){if(null==e)return"";if(""==(e=e.replace(/\\/g,"/").toLowerCase())||""==e||"./"==e)return"";var l="",r="",i="",n=t.indexOf("://");return-1!=n&&(l=t.substr(0,n+3),n=(t=t.substr(n+3)).lastIndexOf("/"),i=l+t.substr(0,n+1),n=t.indexOf("/"),r=l+t.substr(0,n+1)),"//"==e.substr(0,2)?e="http:"+e:-1==e.indexOf("://")&&(e="/"==e.substr(0,1)?r+e:i+e),this.handleFileUrl(e)},XiyuetaCommon.prototype.getUrlFileName=function(t,e=""){if(""==t||null==t)return"";var l=(t=t.replace(/\\/g,"/").trim()).split("/"),r=l[l.length-1],i="",t="";return-1!=(r=-1!=r.indexOf("?")?r.substr(0,r.indexOf("?")):r).indexOf(".")&&(l=r.lastIndexOf("."),i=r.substr(0,l),t=r.substr(l+1).toLowerCase()),"img"==e?""==t?r+=".jpg":-1=="|jpg|bmp|jpeg|png|".indexOf("|"+t+"|")&&(r=i+".jpg"):"css"==e?""==t?r+=".css":-1=="|css|".indexOf("|"+t+"|")&&(r=i+".css"):"js"==e?""==t?r+=".js":-1=="|js|".indexOf("|"+t+"|")&&(r=i+".js"):r=i+"."+t,r},XiyuetaCommon.prototype.setFileName=function(t){return t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/\\/g,"撇")).replace(/\//g,"揦")).replace(/:/g,"：")).replace(/\*/g,"星")).replace(/\?/g,"？")).replace(/"/g,"“")).replace(/</g,"左")).replace(/>/g,"右")).replace(/\|/g,"横")).replace(/\./g,"。")).replace(/,/g,"，")).replace(/&nbsp;/g," ")).replace(/&quot;/g,"双")).replace(/\n/g,"")},_XIYUETA.prototype.handleLabelParam=function(t,e,l,r){for(var i="",n=!0,s=0;s<=this.htmlArr.length-1;s++){var a,h,o,u=this.htmlArr[s];null!=u&&-1!=("|"+t+"|").indexOf("|"+u.label+"|")&&(a=this.handleLeLabelParam(u,e),"link"==u.label&&("dns-prefetch"!=(h=this.handleLeLabelParam(u,"rel").trim().toLowerCase())&&"alternate"!=h||(a="")),-1!=("|"+l+"|").indexOf("clean")?(n=!0,""!=a&&-1==a.indexOf("apps.bdimg.com/")&&(o=a=this.common.fullHttpUrl(r,a),-1!=("|"+l+"|").indexOf("web")&&""!=(a=this.common.getUrlFileName(a,u.label))&&("img"==u.label?a=this.config.imagesdir+a:"script"==u.label?a=this.config.jsdir+a:"link"==u.label?-1!=(h=this.handleLeLabelParam(u,"rel").trim().toLowerCase()).indexOf("shortcut icon")?a=this.config.imagesdir+a:-1!=h.indexOf("stylesheet")?a=this.config.cssdir+a:(a="",n=!1):(n=!1,a="")),n&&""!=a&&(-1!=("|"+l+"|").indexOf("down")?(""!=i&&(i+="[,]"),i+=o+"[|]"+a):(""!=i&&(i+="[,]"),i+=a)),this.handleLeLabelParam(u,e,a))):""!=a&&(""!=i&&(i+="[,]"),i+=a))}return i},_XIYUETA.prototype.handleWebCharset=function(t){for(var e=0;e<=this.htmlArr.length-1;e++){var l=this.htmlArr[e];if(null!=l)if("meta"==l.label)if(-1!=l.html.toLowerCase().indexOf("charset=")){var r=this.handleLeLabelParam(l,"charset").toLowerCase().trim();if(""!=r)return null!=t&&this.handleLeLabelParam(l,"charset",t),r;if(-1!=(r=this.handleLeLabelParam(l,"content").toLowerCase().trim()).indexOf("utf-8"))return null!=t?(this.handleLeLabelParam(l,"content","text/html; charset="+t),""):"utf-8";if(-1!=r.indexOf("gb2312"))return null!=t?(this.handleLeLabelParam(l,"content","text/html; charset="+t),""):"gb2312"}}return""},_XIYUETA.prototype.removeNotNeededLabel=function(t){for(var e=0;e<=this.htmlArr.length-1;e++){var l=this.htmlArr[e];null!=l&&"/script"==l.label&&-1!=l.upHtml.indexOf("hm.baidu.com/h.js")&&(l.upHtml="")}},_XIYUETA.prototype.scan=function(t=""){t="|"+t+"|";var e,l,r=0,i=[],n=!1,s="",a="",h="",o=0,u=[];s+="网页编码："+this.handleWebCharset()+"\n",s+="网页大小："+this.common.getFileSize(this.common.bystesLength(this.htmlSource))+"\n";for(let t=0;t<=this.htmlArr.length-1;t++)(d=this.htmlArr[t])&&(2==d.tagpair&&("/"==d.label.substr(0,1)?(l=(e=d.label.substr(1)).length,e==a.substr(-1*l,l)?a=a.substr(0,a.length-l-1):(o++,d.upHtml+="\x3c!--xiyueta_tip：标签块超出"+d.html+"--\x3e",d.html="")):a+="|"+d.label),"/"!=d.label.substr(0,1)&&""!=d.label&&(-1==("|"+h+"|").indexOf("|"+d.label+"|")?(""!=h&&(h+="|"),h+=d.label,u[d.label]=1):u[d.label]++));if(""!=a){for(var f=a.split("|"),m="",p=1;p<=f.length-1;p++)m+="\x3c!--xiyueta_tip：缺少标签</"+f[p]+">--\x3e";(d=this.htmlArr[this.htmlArr.length-1])&&(d.html+=m),o+=f.length-1}var f=h.split("|"),c="";for(let t=0;t<=f.length-1;t++){var g=f[t];c+=g+"="+u[g]+","}s+="网页标签错误 "+o+"\n",s+="网页标签类型 "+f.length+"种 "+c+"\n",this.config.downcss=0;for(var d,b,C=this.getItem("link[rel|NOUL=stylesheet]","href"),v=this.getItem("script","src"),p=0;p<=this.htmlArr.length-1;p++)null!=(d=this.htmlArr[p])&&("body"==d.label?(r=d.lv,n=!0):0==n&&-1!="|div|span|table|ul|".indexOf("|"+d.label+"|")?(i.push(d.html),d.class=this.handleLeLabelParam(d,"class").trim().toLowerCase(),d.id=this.handleLeLabelParam(d,"id").trim().toLowerCase(),n=!0):n&&d.lv-r==1&&2==d.tagpair&&"/"!=d.label.substr(0,1)&&"!--"!=d.label&&"script"!=d.label.substr(0,6)&&(i.push(d.html),d.class=this.handleLeLabelParam(d,"class").trim().toLowerCase(),d.id=this.handleLeLabelParam(d,"id").trim().toLowerCase()),"link"==d.label&&"stylesheet"==d.rel&&(b=this.common.fullHttpUrl(this.config.httpurl,d.href),-1!=t.indexOf("|downcss|")&&null==d.content&&(this.getUrlStr(d,b),this.config.downcss++,alert("下载CSS"+b))));if(s+="共有CSS文件 "+C.length+" 条\n",s+="共有JS文件 "+v.length+" 条\n",s+="一层标签共 "+i.length+" 条\n",s+="\n",""!=C){s+="CSS列表：\n";for(let t=0;t<=C.length-1;t++)s+=this.common.fullHttpUrl(this.config.httpurl,C[t])+"\n"}if(""!=v){s+="\n\nJS列表：\n";for(let t=0;t<=v.length-1;t++)s+=this.common.fullHttpUrl(this.config.httpurl,v[t])+"\n"}if(""!=i){s+="\n\n一层标签列表：\n";for(let t=0;t<=i.length-1;t++)s+=i[t]+"\n"}return s},_XIYUETA.prototype.cutLabel=function(t,e){for(var l="",r=0;r<=this.htmlArr.length-1;r++)null!=(u=this.htmlArr[r])&&("/style"==u.label?l+=u.upHtml:"link"==u.label&&"stylesheet"==u.rel&&(l+=u.content));var i="*,body,",n=-1;if(""!=(p=this.getDocument(t))){var s=p=p.replace(/,/,""),a=p;-1!=p.indexOf("|")&&(s=(o=p.split("|"))[0],a=o[1]);for(var h,r=s;r<=parseInt(a)-1;r++)null!=(u=this.htmlArr[r])&&"/"!=u.label.substr(0,1)&&(-1==n&&(u.label,n=u.lv),n+1==u.lv&&u.label,n+2==u.lv&&u.label,n+3==u.lv&&u.label,i+=u.label+",",""!=(h=this.handleLeLabelParam(u,"id").toLowerCase())&&(i+="#"+h+","),""!=(h=this.handleLeLabelParam(u,"class").toLowerCase())&&(i+="."+h.replace(/ /g,",.")+","));var o=i.split(","),i="";for(let t=0;t<=o.length-1;t++)-1==(","+i+",").indexOf(","+o[t]+",")&&(""!=i&&(i+=","),i+=o[t]);var u,f="",m=new _XIYUETACSS;m.cssParse(l);for(let t=0;t<=m.cssArr.length-1;t++)if(null!=(u=m.cssArr[t])){var p=","+u.label+",";u.label;for(let t=0;t<=o.length-1;t++)-1==p.indexOf(","+o[t]+",")&&-1==p.indexOf(","+o[t]+" ")||-1==("\n"+f+"\n").indexOf("\n"+u.html+"\n")&&(f+=u.html+"\n")}m.debug(),xiyuetaCSS(f).parse(),""!=(f=xiyuetaCSS().print("zip"))&&(f="<style>"+f+"\n</style>\n");s=this.getHtml(t,"all");this.htmlParse(s);s=f+this.printHtml("format")}return s},_XIYUETA.prototype.getUrlStr=function(e,l){var r=this;$.ajax({url:this.config.serverurl+"?act=getUrlStr&n="+Math.random(),type:"POST",data:{httpurl:l},error:function(t,e,l){},success:function(t){xiyuetaCSS(t).parse(),xiyuetaCSS().allcss("|url","server="+l),e.content=xiyuetaCSS().print(),r.config.downcss--,0==r.config.downcss?alert("下载全部CSS完成，可以点击下一步 了"):alert("下载CSS完成,还乘"+r.config.downcss)}})},_XIYUETA.prototype.getLabelHtml=function(t,e){for(var l="",r=t;r<=e;r++){var i=this.htmlArr[r];null!=i&&(t<r&&(l+=i.upHtml),t<r&&r<e&&(l+=i.html))}return l},_XIYUETA.prototype.webtpl=function(e="",t){"object"==typeof t&&(null!=t.type&&(this.tplConfig.type=t.type),null!=t.item&&(this.tplConfig.item=t.item),"dedecms"==this.tplConfig.type?(this.tplConfig.webTitle="{dede:global.cfg_webname/}",this.tplConfig.webKeywords="{dede:global.cfg_keywords/}",this.tplConfig.webDescription="{dede:global.cfg_description/}",this.tplConfig.navFor="{dede:channel type='top' row='10'}\n",this.tplConfig.navTitle="[field:typename/]",this.tplConfig.navUrl="[field:typeurl/]",this.tplConfig.navEnd="{/dede:channel}",this.tplConfig.itemFor="自动",this.tplConfig.itemTitle="[field:title/]",this.tplConfig.itemUrl="[field:arcurl/]",this.tplConfig.itemImage="[field:image/]",this.tplConfig.itemAbout="[field:title/]",this.tplConfig.itemTime="[field:pubdate function=\"MyDate('Y-m-d H:i',@me)\"/]",this.tplConfig.itemTime1="[field:pubdate function=\"MyDate('Y-m-d',@me)\"/]",this.tplConfig.itemEnd="{/dede:arclist}"):(this.tplConfig.webTitle="<%=webTitle%>",this.tplConfig.webKeywords="<%=webKeywords%>",this.tplConfig.webDescription="<%=webDescription%>",this.tplConfig.navFor='<%rs.open "select * from " & db_PREFIX & "WebColumn where parentId=-1 order by sortRank asc" ,conn,1,1\nwhile not rs.eof\n%>\n',this.tplConfig.navTitle='<%=rs("columnName")%>',this.tplConfig.navUrl='?nav=<%=rs("columnName")%>',this.tplConfig.navEnd="<%rs.movenext:wend:rs.close%>",this.tplConfig.itemFor="自动",this.tplConfig.itemTitle='<%=rs("title")%>',this.tplConfig.itemUrl='detail.asp?id=<%=rs("id")%>',this.tplConfig.itemImage='<%=rs("smallimage")%>',this.tplConfig.itemAbout='<%=rs("aboutContent")%>',this.tplConfig.itemTime='<%=rs("addDateTime")%>',this.tplConfig.itemTime1='<%=format_Time(rs("addDateTime"),2)%>',this.tplConfig.itemEnd="<%rs.movenext:next:rs.close%>")),xiyueta("title").html(this.tplConfig.webTitle),xiyueta("meta[name|NOUL=keywords]").attr("content",this.tplConfig.webKeywords),xiyueta("meta[name|NOUL=description]").attr("content",this.tplConfig.webDescription);for(var l=!1,r=[],i=-1,n=0;n<=this.htmlArr.length-1;n++)null!=(h=this.htmlArr[n])&&("body"==h.label?(i=h.lv,l=!0):0==l&&-1!="|div|span|table|ul|".indexOf("|"+h.label+"|")?(this.handleLeLabelParam(h,"class").trim().toLowerCase(),this.handleLeLabelParam(h,"id").trim().toLowerCase(),r.push(h),l=!0,i=0):l&&h.lv-i==1&&2==h.tagpair&&"/"!=h.label.substr(0,1)&&"!--"!=h.label&&"script"!=h.label.substr(0,6)&&(this.handleLeLabelParam(h,"class").trim().toLowerCase(),this.handleLeLabelParam(h,"id").trim().toLowerCase(),r.push(h)));console.log("oneLevelArr",r),this.tplArr=[];var s=r.length-1;for(let t=0;t<=s;t++){var a=r[t];null!=a&&(e=null!=a.id?a.label+"[id="+a.id+"]":null!=a.class?a.label+"[class='"+a.class+"']":a.label,1==xiyueta(e).item().length&&(o=this.findLabelList(e)))}console.log("this.tplArr",this.tplArr);for(n=0;n<=this.tplArr.length-1;n++){var h,o,u=(o=(h=this.tplArr[n]).txt).lastIndexOf(" "),f=o.substr(0,u).trim(),u=o.substr(u+1).trim();-1!=xiyueta(f).text().indexOf("首页")?xiyueta(f).nav(u):xiyueta(f).news(u)}},_XIYUETA.prototype.findLabelList=function(e,l=""){var t=this.getDocument(e);if(-1!=t.indexOf("|")){var r=t.split("|"),i=parseInt(r[0].replace(",","")),n=parseInt(r[1]),s="",a=this.getLabelList(i,n);if(""!=a){r=a.split("|");for(let t=0;t<=r.length-1;t++){var h,o=e+" "+(h=-1!=(o=r[t]).indexOf(":")?o.substr(0,o.indexOf(":")):o.substr(0,o.indexOf("[")));-1==("|"+s+"|").indexOf("|"+a+"|")&&(s+=a+"|",o=this.getLabelCount(i,n,e,h),console.log("显示="+e+" "+h+"="+o),o>=this.tplConfig.item&&this.tplArr.push({txt:l=e+" "+h,num:o})),this.findLabelList(e+" "+r[t],l)}}}return""},_XIYUETA.prototype.getLabelCount=function(e,l,r,i){var n,s,a=0,h=-1;for(let t=e+1;t<=l;t++){var o=this.htmlArr[t];null!=o&&(n=null==n?o.lv:n)==o.lv&&i==o.label&&(h++,o=xiyueta(r+" "+o.label+":eq("+h+")").doc("lable"),null==s?(s=o,a++):s==o&&a++)}return a},_XIYUETA.prototype.getLabelList=function(e,l,r){var i=[],n="";for(let t=e+1;t<=l;t++){var s,a,h=this.htmlArr[t];null!=h&&(r=null==r?h.lv:r)==h.lv&&"/"!=h.label.substr(0,1)&&(null==i[h.label]?i[h.label]=0:i[h.label]++,""!=n&&(n+="|"),s=this.handleLeLabelParam(h,"class").trim().toLowerCase(),a=this.handleLeLabelParam(h,"id").trim().toLowerCase(),addParam=""!=a?"[id="+a+"]":""!=s?"[class='"+s+"']":":eq("+i[h.label]+")",n+=h.label+addParam)}return n},_XIYUETA.prototype.nav=function(e="",l){""!=e&&(e+=" "),aConfig="a"==l?e.trim():e+l.trim(),xiyueta(aConfig+" a").attr("href","#"),xiyueta(aConfig+" a").attr("title",""),xiyueta(aConfig+" a").attr("alt",""),xiyueta(aConfig+" a").html("");var t=xiyueta(e+l+":eq(0) span").text().trim(),r="",i="",n=!1,s=-1;""!=t&&("["==t.substr(0,1)&&(r="[",t=t.substr(1)),"]"==t.substr(-1,1)&&(i="]",t=t.substr(0,t.length-1)));new RegExp(/^[1-9]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$/).test(t)&&(xiyueta(e+l+" span").html(""),n=!0,s=2);var a=-1,h=-1,o="",u="",f=-1,m=-1,p=0;xiyueta(e+l).each(function(t,e){""==o?(o=e.html+e.innerHTML,f=1,a=t):o==e.html+e.innerHTML?f++:""!=u&&u==e.html+e.innerHTML?m++:(u=e.html+e.innerHTML,m=1,h=t),p++}),xiyueta(aConfig+":eq("+a+")    a").attr("href",this.tplConfig.navUrl),xiyueta(aConfig+":eq("+a+")    a").attr("title",this.tplConfig.navTitle),xiyueta(aConfig+":eq("+a+") a").html(this.tplConfig.navTitle),-1!=h&&(0<xiyueta(aConfig+":eq("+h+") a").item().length?(xiyueta(aConfig+":eq("+h+") a").attr("href",this.tplConfig.navUrl),xiyueta(aConfig+":eq("+h+") a").attr("title",this.tplConfig.navTitle),xiyueta(aConfig+":eq("+h+") a").html(this.tplConfig.navTitle)):xiyueta(e+l+":eq("+h+")").html(this.tplConfig.navTitle)),n&&(s=r+(s=0<s?'<%=format_Time(rs("addDateTime"),'+s+")%>":'<%=rs("addDateTime")%>')+i,xiyueta(e+l+":eq("+a+")  span").html(s),xiyueta(e+l+":eq("+h+")  span").html(s));o=xiyueta(e+l+":eq("+a+")").html(null,"all"),u=xiyueta(e+l+":eq("+h+")").html(null,"all");f<m&&(c=o,o=u,u=c);for(let t=0;t<=p;t++)xiyueta(e+l+":eq(1)").remove();var c=this.tplConfig.navFor;-1==m?c+=o:"dedecms"==this.tplConfig.type?(""!=u&&(u=u.replace(/"/g,"'").replace(/\[field:/g,"~").replace(/\/]/g,"~"),c=c.replace("}",' currentstyle="'+u+'"}')),c+=o+"\n"):c+='<%if nav=rs("columnName") then%>\n'+u+"\n<%else%>\n"+o+"\n<%end if%>\n",c+=this.tplConfig.navEnd,xiyueta(e+l+":eq(0)").html(c,"all")},_XIYUETA.prototype.news=function(e="",l){""!=e&&(e+=" "),aConfig="a"==l?e.trim():e+l.trim();var t=xiyueta(aConfig+":eq(0)").doc("lable");"<a></a>"==t?(xiyueta(aConfig+":eq(0) a").attr("href",this.tplConfig.itemUrl),xiyueta(aConfig+":eq(0) a").attr("title",this.tplConfig.itemTitle),xiyueta(aConfig+":eq(0) a").html(this.tplConfig.itemTitle)):"<a><img><h1></h1></a>"==t?(xiyueta(aConfig+":eq(0) a").attr("href",this.tplConfig.itemUrl),xiyueta(aConfig+":eq(0) img").attr("src",this.tplConfig.itemImage),xiyueta(aConfig+":eq(0) h1").html(this.tplConfig.itemTitle)):"<a><label><img></label><h1></h1><p></p><span></span></a>"==t?(xiyueta(aConfig+":eq(0) a").attr("href",this.tplConfig.itemUrl),xiyueta(aConfig+":eq(0) img").attr("src",this.tplConfig.itemImage),xiyueta(aConfig+":eq(0) h1").html(this.tplConfig.itemTitle),xiyueta(aConfig+":eq(0) p").html(this.tplConfig.itemAbout)):"<a></a><span></span>"==t?(xiyueta(aConfig+":eq(0) a").attr("href",this.tplConfig.itemUrl),xiyueta(aConfig+":eq(0) a").attr("title",this.tplConfig.itemTitle),xiyueta(aConfig+":eq(0) a").html(this.tplConfig.itemTitle),xiyueta(aConfig+":eq(0) span").html(this.handleItemTime(aConfig,this.tplConfig.itemTitle))):""==t?xiyueta(aConfig+":eq(0)").html(this.tplConfig.itemTitle):console.log("labelType(标签类型项没有处理)="+t);var r=xiyueta(e+l+":eq(0)").html(null,"all"),i=xiyueta(e+l).item().length;0==i&&(i=10);for(let t=0;t<=i;t++)xiyueta(e+l+":eq(1)").remove();t="dedecms"==this.tplConfig.type?"{dede:arclist titlelen='60' row='"+i+"'}":'<%rs.open "select * from " & db_PREFIX & "ArticleDetail order by id desc" ,conn,1,1\nfor i=1 to '+i+"\nif rs.eof then exit for\n%>\n",t+=r,t+=this.tplConfig.itemEnd,xiyueta(e+l+":eq(0)").html(t,"all")},_XIYUETA.prototype.handleItemTime=function(t,e){var l=xiyueta(t+":eq(0) span").text().trim(),r="",i="",n=!1,s=-1;""!=l&&("["==l.substr(0,1)&&(r="[",l=l.substr(1)),"]"==l.substr(-1,1)&&(i="]",l=l.substr(0,l.length-1)));new RegExp(/^[1-9]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$/).test(l)&&(n=!0,s=2),n&&(e=this.tplConfig.itemTime,e=r+(e=0<s?this.tplConfig.itemTime1:e)+i),xiyueta(t+":eq(0)  span").html(e)};