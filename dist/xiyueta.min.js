/*! xiyueta v1.1.1 | Author xiyueta Adream | MIT License By http://xiyueta.com/  */
function XiyuetaCommon(){}XiyuetaCommon.prototype.copyStr=function(e,r){var l="";for(let t=1;t<=r;t++)l+=e;return l},XiyuetaCommon.prototype.bystesLength=function(t){for(var e=0,r=0;r<t.length;r++)255<t.charCodeAt(r)?e+=2:e++;return e},XiyuetaCommon.prototype.getFileSize=function(t){return t<1048576?(t/1024).toFixed(2)+"KB":1048576==t?"1MB":1048576<t&&t<1073741824?(t/1048576).toFixed(2)+"MB":1048576<t&&1073741824==t?"1GB":1073741824<t&&t<1099511627776?(t/1073741824).toFixed(2)+"GB":"文件超过1TB"},function(){var n=new(window._XIYUETA=function(t){"use strict";this.htmlSource=t=null==t?"":t,this.htmlArr=[],this.common=new XiyuetaCommon,this.config={version:"1.0.8",httpurl:"",serverurl:"/api/downWeb/default.asp",jsdir:"js/",cssdir:"css/",imagesdir:"images/"},this.htmlParse=function(t){null!=t&&(this.htmlSource=t,this.htmlArr=[]);for(var e="",r="",l="",n="",s=!1,i=!1,a=!1,h=!1,u=!1,o=0,m=0;m<=this.htmlSource.length-1;m++){var f,e=this.htmlSource.substr(m,1);s?(l+=e,h?">"==e&&"--\x3e"==l.substr(-3,3)&&(a=s=h=!1,this.htmlArr.push({lv:o+1,label:"!--",upHtml:n,html:l,tagpair:1}),n=l=""):i&&"\x3c!--"==l?h=!0:u?">"==e&&"%>"==l.substr(-2,2)&&(a=s=u=!1,this.htmlArr.push({lv:o+1,label:"<%",upHtml:n,html:l,tagpair:1}),n=l=""):i&&"<%"==l?u=!0:" "==e&&i?i=!1:">"==e&&(s=i=!1,f=2,"/"==r.substr(0,1)?a=!0:(o++,"/"!=r.substr(-1,1)&&-1=="|br|hr|img|link|meta|param|input|!doctype|".indexOf("|"+r.toLowerCase()+"|")||(a=!0,f=1,r=r.replace(/\//g,"").trim())),this.htmlArr.push({lv:o,label:r.toLowerCase(),upHtml:n,html:l,tagpair:f}),n=l="",a&&(o--,a=!1),"script"==r.toLowerCase()&&(f=this.htmlSource.substr(m+1).toLowerCase().indexOf("<\/script>"),l=this.htmlSource.substr(m+1,f),m+=f)),i&&(r+=e)):"<"==e?(n=l,l=e,a=!(i=s=!0),r=""):l+=e}""!=l&&this.htmlArr.push({lv:o,label:"",upHtml:"",html:l})},this.handleLeLabelParam=function(r,t,l){if(null==l&&null!=r[t])return r[t];for(var e=!1,n="",s="",i=!1,a="",h=!1,u=!0,o=0,m=r.label.length+1;m<=r.html.length-1;m++){var f=r.html.substr(m,1);if(i)if(h)if(f==a||">"==f){if(r[n=n.toLowerCase()]=s,h=i=!1,a="",t==n){if(null==l)return s;{let t=o,e=o+s.length;u&&(t++,e++);var c=r.html.substr(0,t),p=r.html.substr(e);return r.html=c+l+p,r[n]=l,r}}if(">"==f&&null!=l)return r.html=r.html.substr(0,r.html.length-1)+" "+t+'="'+l+'">',r[t]=l,!0}else s+=f;else'"'==f||"'"==f?(a=f,o=m,u=h=!0):" "!=f&&(a=" ",o=m,s=f,u=!(h=!0));else if(">"==f){if(null!=l)return r.html=r.html.substr(0,r.html.length-1)+" "+t+'="'+l+'">',r[t]=l,!0}else e?"="==f?(i=!(e=!1),a=s=""):" "!=f&&(n+=f):" "!=f&&(e=!0,n=f)}return""},this.getDocument=function(t="*All*",e,r,l){null==e&&(e=0),null==r&&(r=0),null==l&&(l=this.htmlArr.length-1);var n,s,i=!1,a="",h=0,u=0,o="",m=-1,f=!1,c="",p="",g="",d="",b=!1;-1!=t.indexOf(" ")&&(t=(n=t.split(" "))[0],c=n[1]),-1!=t.indexOf(":eq(")?(o=(s=t.split(":eq("))[0],""!=c&&(f=!0,o+=" "+c),""!=(m=s[1].substr(0,s[1].indexOf(")")).trim())&&(m=parseInt(m))):-1!=t.indexOf("[")?(o=(s=t.split("["))[0],""!=c&&(f=!0,o+=" "+c),p=(s=(L=s[1].substr(0,s[1].indexOf("]")).trim()).split("="))[0],g=s[1],-1!=p.indexOf("|")&&(p=(s=p.split("|"))[0],d=s[1])):o=t;for(var v=r;v<=l;v++){var A,L,x=this.htmlArr[v];if(null!=x)if(0==f)if(!i||x.label!="/"+o&&"*All*"!=o||h!=x.lv)x.label!=o&&"*All*"!=o||0!=i||(1!=x.tagpair&&(i=!0,h=x.lv),u=v,""==c&&(""!=p?(L=this.handleLeLabelParam(x,p),(L="NOUL"==d?L.toLowerCase():L)==g&&(a+=","+v,2==x.tagpair?b=!0:e++)):e==m||-1==m?(a+=","+v,2==x.tagpair?b=!0:e++):1==x.tagpair&&e++));else{if(b&&(a+="|"+v),e==m)return a;b=i=!1,e++,a+=this.getDocument(t,e,u+1,v)}else!i||x.label!="/"+o.substr(0,x.label.length-1)&&"*All*"!=o||h!=x.lv?x.label==o.substr(0,x.label.length||"*All*"==o)&&0==i&&(1!=x.tagpair&&(i=!0,h=x.lv),u=v,""!=p?(L=this.handleLeLabelParam(x,p),(L="NOUL"==d?L.toLowerCase():L)==g&&(b=!0)):e!=m&&-1!=m||(b=!0)):(i=!1,x=b?(A=c,0):(A=t,""!=c&&(A+=" "+c),e+1),a+=this.getDocument(A,x,u+1,v))}return a},this.each=function(t,e){var r=[];t=t.trim();for(var l,n,s=this.getDocument(t),i=s.split(","),a=1;a<=i.length-1;a++)-1!=(s=i[a]).indexOf("|")?(l=s.split("|"),n=this.htmlArr[l[0]],this.handleLeLabelParam(n,"NO&.NO"),n.innerHTML=this.getLabelHtml(parseInt(l[0]),parseInt(l[1]))):(n=this.htmlArr[s],this.handleLeLabelParam(n,"NO&.NO")),r.push(n);if(Array.isArray(r))for(var a=0,h=r.length;a<h&&0!=e.call(null,a,r[a]);a++);},this.getItem=function(t,e){null==e&&(e="");for(var r=[],l=(u=this.getDocument(t)).split(","),n=1;n<=l.length-1;n++)if(-1!=(u=l[n]).indexOf("|")){var s=u.split("|"),i=this.htmlArr[s[0]];if(""!=e)""!==(u=this.handleLeLabelParam(i,e))&&r.push(u);else{for(var a=i.html,h=parseInt(s[0])+1;h<=s[1];h++)a+=(i=this.htmlArr[h]).upHtml+i.html;""!=a&&r.push(a)}}else{var u,i=this.htmlArr[u];""!=e?""!==(u=this.handleLeLabelParam(i,e))&&r.push(u):r.push(i.html)}return r},this.replace=function(t,e,r,l){for(var n,s=this.getDocument(t),i=s.split(","),a=1;a<=i.length-1;a++)n=-1!=(s=i[a]).indexOf("|")?(n=s.split("|"),this.htmlArr[n[0]]):this.htmlArr[s],""!=e&&(s=this.handleLeLabelParam(n,e))==r&&this.handleLeLabelParam(n,e,l)},this.attr=function(t,e,r){if(""==(e=(e=null==e?"":e).trim()))return"";if("object"==typeof t)return null==r?this.handleLeLabelParam(t,e):this.handleLeLabelParam(t,e,r);var l=(i=this.getDocument(t)).split(",");if(null==r){var n=(i=l[1]).split("|"),s=this.htmlArr[n[0]];return i=this.handleLeLabelParam(s,e)}for(var i,a=1;a<=l.length-1;a++)s=-1!=(i=l[a]).indexOf("|")?(n=i.split("|"),this.htmlArr[n[0]]):this.htmlArr[i],this.handleLeLabelParam(s,e,r);return""},this.getText=function(t){t=t.trim();for(var e="",r=this.getDocument(t),l=r.split(","),n=1;n<=l.length-1;n++)if(-1!=(r=l[n]).indexOf("|"))for(var s=r.split("|"),i=parseInt(s[0])+1;i<=s[1];i++)e+=this.htmlArr[i].upHtml;return e},this.getHtml=function(t,e){t=t.trim();var r="",l=this.getDocument(t),t=l.split(",");if(t.length<2)return"";if(-1!=(l=t[1]).indexOf("|"))for(var t=l.split("|"),n=parseInt(t[0]),s=parseInt(t[1]),i=n;i<=s;i++){var a=this.htmlArr[i];a&&(n<i&&(r+=a.upHtml),("all"==e||n<i&&i<s)&&(r+=a.html))}else""!=l&&"all"==e&&(r=this.htmlArr[l].html);return r},this.setHtml=function(t,e,r){t=t.trim();for(var l=this.getDocument(t),n=l.split(","),s=1;s<=n.length-1;s++)if(-1!=(l=n[s]).indexOf("|"))for(var i=l.split("|"),a=parseInt(i[0]),h=parseInt(i[1]),u=a;u<=h;u++){var o=this.htmlArr[u];o&&(u==a?"all"==r&&(o.html=""):u<h?delete this.htmlArr[u]:u==h&&(o.upHtml=e,"all"==r&&(o.html="")))}},this.labelSwap=function(t,e){if(null==t||null==e)return!1;t=this.getDocument(t),e=this.getDocument(e);if(""==t||""==e)return!1;if(t=t.replace(/,/,""),e=e.replace(/,/,""),-1==t.indexOf("|"))var r=this.htmlArr[t];else{for(var l=t.split("|"),r=this.htmlArr[l[0]],n="",s=parseInt(l[0])+1;s<=l[1];s++)null!=(a=this.htmlArr[s])&&(n+=a.upHtml+a.html,delete this.htmlArr[s]);r.html+=n}if(-1==e.indexOf("|"))var i=this.htmlArr[e];else{for(var a,l=e.split("|"),i=this.htmlArr[l[0]],n="",s=parseInt(l[0])+1;s<=l[1];s++)null!=(a=this.htmlArr[s])&&(n+=a.upHtml+a.html,delete this.htmlArr[s]);i.html+=n}e=r.html;return r.html=i.html,i.html=e,!0},this.deleteDoc=function(t){if(t=t.trim(),""==(l=this.getDocument(t)))return!1;for(var e=l.split(","),r=1;r<=e.length-1;r++){var l=e[r];if(-1!=l.indexOf("|"))for(var n,s=l.split("|"),i=parseInt(s[0]),a=parseInt(s[1]),h=i;h<=a;h++)(n=this.htmlArr[h])&&(h==i?(n.html="",n.label=""):delete this.htmlArr[h]);else(n=this.htmlArr[l])&&(n.html="",n.label="")}return!0},this.setConfig=function(t){if(null==t)return this.config;null!=t.httpurl&&(this.config.httpurl=t.httpurl),null!=t.serverurl&&(this.config.serverurl=t.serverurl),null!=t.jsdir&&(this.config.jsdir=t.jsdir),null!=t.cssdir&&(this.config.cssdir=t.cssdir),null!=t.imagesdir&&(this.config.imagesdir=t.imagesdir)},this.printHtml=function(t){for(var e="",r=-1,l=-1,n=0;n<=this.htmlArr.length-1;n++){var s,i,a=this.htmlArr[n];a&&("format"==t?(s=a.upHtml.trim(),i=a.html.trim(),l=a.lv,""!=i&&("/"==a.label.substr(0,1)&&a.lv==r||2==a.tagpair&&(i="\n"+this.common.copyStr("    ",a.lv-1)+i,a.lv!=r&&""!=s&&(l=a.lv,"/"!=a.label.substr(0,1)&&l--,s="\n"+this.common.copyStr("    ",l)+s))),e+=s+i):e+="zip"==t?a.upHtml.trim()+a.html.trim():a.upHtml+a.html,2==a.tagpair&&(r=a.lv))}return e},this.debug=function(t){console.log(this.htmlArr)}});console.log("%c XiYueTa %c v"+n.config.version+" 加载完成 ","font-size:18px;color:#00bbee","color:#000"),window.xiyueta=function(l){return{text:function(t){return t?n.setHtml(l,t):n.getText(l)},html:function(t,e){return t?n.setHtml(l,t,e):n.getHtml(l,e)},attr:function(t,e){return n.attr(l,t,e)},item:function(t){return n.getItem(l,t)},each:function(t){return n.each(l,t)},remove:function(){return n.deleteDoc(l)},handle:function(t,e,r){return n.handleLabelParam(l,t,e,r)},clear:function(t){return n.removeNotNeededLabel(t)},charset:function(t){return n.handleWebCharset(t)},fullurl:function(t){return n.common.fullHttpUrl(l,t)},geturlfilename:function(t){return n.common.getUrlFileName(t)},config:function(t){return n.setConfig(t)},swap:function(t){return n.labelSwap(l,t)},replace:function(t,e,r){return n.replace(l,t,e,r)},scan:function(t){return n.scan(t)},cutlabel:function(t){return n.cutLabel(l,t)},parse:function(){return n.htmlParse(l)},print:function(t){return n.printHtml(t)},debug:function(t){return n.debug(t)},author:function(){alert("作者：小云\nQQ313801120\n官网:xiyueta.com")}}}}(),function(){var l=new(window._XIYUETACSS=function(t){"use strict";this.cssSource=t=null==t?"":t,this.cssArr=[],this.common=new XiyuetaCommon,this.config={parentdir:"../",imagesdir:"images/"},this.cssParse=function(t){null!=t&&(this.cssSource=t,this.cssArr=[]);for(var e,r="",l="",n="",s="",i=!1,a=!1,h=!1,u=!1,o=0;o<=this.cssSource.length-1;o++)e=r,r=this.cssSource.substr(o,1),i?(n+=r,h?"/"==r&&"*"==e&&(i=h=!1,this.cssArr.push({lv:0,label:"/*",upHtml:s,html:n}),s=n=""):a&&"*"==r&&"/"==e?h=!0:u?" "==r&&a?a=!1:";"!=r&&"\n"!=r||(i=a=u=!1,this.cssArr.push({lv:0,label:l.toLowerCase().trim(),upHtml:s,html:n}),s=n=""):"{"==r&&a?a=!1:"}"==r&&(i=a=!1,this.cssArr.push({lv:0,label:l.toLowerCase().trim(),upHtml:s,html:n}),s=n=""),a&&(" "!=r||" "!=e&&","!=e)&&(l+=r)):" "!=r&&";"!=r&&"\n"!=r?(s=n,a=i=!0,"@"==(l=n=r)&&(u=!0)):n+=r;""!=n&&this.cssArr.push({lv:0,label:"",upHtml:"",html:n})},this.handleLeLabelParam=function(r,t="[All]",l){if(null==l&&null!=r[t])return r[t];var e,n="";-1!=t.indexOf("|")&&(t=(e=t.split("|"))[0],n=e[1],""==t&&(t="[All]"));for(var s=!1,i="",a="",h=!1,u="",o=!1,m=!0,f=0,c="",p=r.html.indexOf("{")+1;p<=r.html.length-1;p++){var g=r.html.substr(p,1);if(h)if(o)if(g==u||"}"==g){if(r[i=i.toLowerCase().trim()]=a,o=h=!1,u="",t==i||"[All]"==t)if(null==l){if("url"!=n)return a;""!=(a=this.getSetCssBg(a))&&(""!=c&&(c+="\n"),c+=a)}else{let t=f,e=f+a.length;m&&(t++,e++);var d=r.html.substr(0,t),b=r.html.substr(e);if("url"!=n)return r.html=d+l+b,r[i]=l,r;var v=this.getSetCssBg(a,l);""!=v&&(""!=c&&(c+="\n"),c+=v,r.html=d+v+b,p=(d+(r[i]=v)).length)}}else a+=g;else" "!=g&&(u=";",f=p,m=!(o=!0),a=g);else s?":"==g?(h=!(s=!1),u=a=""):" "!=g&&(i+=g):" "!=g&&(s=!0,i=g)}return c},this.getSetCss=function(t="[All]",e,r){t=t.trim();for(var l=0;l<=this.cssArr.length-1;l++){var n=this.cssArr[l];if(null!=n&&(t==n.label||"[All]"==t))return null==e?n.html:this.handleLeLabelParam(n,e,r)}},this.getSetCssBg=function(e,r){if(null==e)return"";if(-1==e.indexOf("("))return"";if(-1==e.indexOf(")"))return"";var l="",n=!1,s=!1,i="",a=-1;for(let t=0;t<=e.length-1;t++){var h=e.substr(t,1);if(n)if(s){if(i==h){var u=e.substr(a,t-a);if(null!=r)if("server="==r.substr(0,7)){if(-1!=u.indexOf("data:image/"))return e;u=e.substr(0,a)+this.common.fullHttpUrl(r.substr(7),u)+e.substr(t)}else if("dir="==r.substr(0,4)){if(-1!=u.indexOf("data:image/"))return e;u=e.substr(0,a)+r.substr(4)+this.common.getUrlFileName(u)+e.substr(t)}else u=e.substr(0,a)+r+e.substr(t);return u}}else""!=h&&('"'==h||"'"==h?(s=!0,i=h,-1==a&&(a=t+1)):(s=!0,i=")",-1==a&&(a=t)));else if("("==h){if("url"==l.trim().toLowerCase())n=!0;else if(null==r)return""}else l+=h}return e},this.getSetAllCss=function(t="[All]",e,r){for(var l=","+(t=t.trim())+",",n="",s=0;s<=this.cssArr.length-1;s++){var i,a,h=this.cssArr[s];null!=h&&(i=","+h.label+",",h.label,-1==i.indexOf(l)&&"[All]"!=t||(null==e||"object"==typeof(a=this.handleLeLabelParam(h,e,r))?(""!=n&&(n+="\n"),n+=h.html):a&&(""!=n&&(n+="\n"),n+=a)))}return n},this.handleCssCharset=function(t){for(var e=0;e<=this.cssArr.length-1;e++){var r=this.cssArr[e];if(null!=r)if("@charset"==r.label)return null!=t?(r.html='@charset "'+t+'";',""):r.html.substr(9).replace(/"/g,"").replace(/'/g,"").replace(/;/g,"").trim().toLowerCase()}return""},this.handleCssBackGround=function(t,e=""){var r="";xiyuetaCSS().allcss("|url","server="+e);r=xiyuetaCSS().allcss("|url","dir=images/");xiyuetaCSS().allcss("|url","dir="+this.config.parentdir+this.config.imagesdir);for(var l,n=r.split("\n"),s="",i=0;i<=n.length-1;i++)""!=(l=n[i])&&(""!=s&&(s+="[,]"),s+=l+"[|]images/"+xiyueta().geturlfilename(l));return s},this.setConfig=function(t){if(null==t)return this.config;if(null!=t.imagesdir){this.config.imagesdir=t.imagesdir;for(var e=t.cssdir.split("/"),r="",l=0;l<=e.length-2;l++)r+="../";this.config.parentdir=r}null!=t.parentdir&&(this.config.parentdir=t.parentdir)},this.printCss=function(t){for(var e="",r=0;r<=this.cssArr.length-1;r++){var l,n=this.cssArr[r];null!=n&&(l=n.upHtml+n.html,""!=(l="zip"==t?"/*"==n.label?"":l.replace(/  /g," ").replace(/  /g," ").replace(/{ /g,"{").replace(/ {/g,"{").replace(/\n/g,"").trim():l)&&(e+=l+"\n"))}return e},this.debug=function(){console.log(this.cssArr)}});window.xiyuetaCSS=function(r){return{css:function(t,e){return l.getSetCss(r,t,e)},allcss:function(t,e){return l.getSetAllCss(r,t,e)},handlecssimg:function(t,e){return l.handleCssBackGround(t,e)},charset:function(t){return l.handleCssCharset(t)},parse:function(){return l.cssParse(r)},config:function(t){return l.setConfig(t)},print:function(t){return l.printCss(t)},debug:function(t){return l.debug(t)}}}}(),XiyuetaCommon.prototype.handleFileUrl=function(t){var e="",r=t.indexOf("://");for(-1!=r&&(e=t.substr(0,r+3),t=t.substr(r+3));-1!=t.indexOf("//");)t=t.replace(/\/\//g,"/");if(-1!=(t=-1!=t.indexOf("/./")?t.replace(/\/.\//g,"/"):t).indexOf("/../")){for(var l=[],n=0,s=t.split("/"),i=0;i<=s.length-1;i++)".."==(a=s[i])?(0==n?n=i-1:--n,0<=n&&delete l[n]):(l.push(a),n=0);for(t="",i=0;i<=l.length-1;i++){var a=l[i];null!=l[i]&&(""!=t&&(t+="/"),t+=l[i])}}return e+t},XiyuetaCommon.prototype.fullHttpUrl=function(t,e){if(null==e)return"";if(""==(e=e.replace(/\\/g,"/").toLowerCase())||""==e||"./"==e)return"";var r="",l="",n="",s=t.indexOf("://");return-1!=s&&(r=t.substr(0,s+3),s=(t=t.substr(s+3)).lastIndexOf("/"),n=r+t.substr(0,s+1),s=t.indexOf("/"),l=r+t.substr(0,s+1)),"//"==e.substr(0,2)?e="http:"+e:-1==e.indexOf("://")&&(e="/"==e.substr(0,1)?l+e:n+e),this.handleFileUrl(e)},XiyuetaCommon.prototype.getUrlFileName=function(t,e=""){if(""==t||null==t)return"";var r=(t=t.replace(/\\/g,"/").trim()).split("/"),l=r[r.length-1],n="",t="";return-1!=(l=-1!=l.indexOf("?")?this.setFileName(l):l).indexOf(".")&&(r=l.lastIndexOf("."),n=l.substr(0,r),t=l.substr(r+1).toLowerCase()),"img"==e?""==t?l+=".jpg":-1=="|jpg|bmp|jpeg|png|".indexOf("|"+t+"|")&&(l=n+".jpg"):"css"==e?""==t?l+=".css":-1=="|css|".indexOf("|"+t+"|")&&(l=n+".css"):"js"==e&&(""==t?l+=".js":-1=="|js|".indexOf("|"+t+"|")&&(l=n+".js")),l},XiyuetaCommon.prototype.setFileName=function(e){arrA=new Array("\\","/",":","*","?",'"',"<",">","|",".",","),arrB=new Array("撇","揦","：","星","？","“","左","右","横","。","，");for(let t=0;t<=arrA.length-1;t++)e=e.replace(/newarrA[i]/g,arrB[t]);return e=(e=(e=e.replace(/&nbsp;/g," ")).replace(/&quot;/g,"双")).replace(/\n/g,"")},_XIYUETA.prototype.handleLabelParam=function(t,e,r,l){for(var n="",s=!0,i=0;i<=this.htmlArr.length-1;i++){var a,h,u,o=this.htmlArr[i];null!=o&&-1!=("|"+t+"|").indexOf("|"+o.label+"|")&&(a=this.handleLeLabelParam(o,e),"link"==o.label&&("dns-prefetch"!=(h=this.handleLeLabelParam(o,"rel").trim().toLowerCase())&&"alternate"!=h||(a="")),-1!=("|"+r+"|").indexOf("clean")?(s=!0,""!=a&&-1==a.indexOf("apps.bdimg.com/")&&(u=a=this.common.fullHttpUrl(l,a),-1!=("|"+r+"|").indexOf("web")&&""!=(a=this.common.getUrlFileName(a,o.label))&&("img"==o.label?a=this.config.imagesdir+a:"script"==o.label?a=this.config.jsdir+a:"link"==o.label?-1!=(h=this.handleLeLabelParam(o,"rel").trim().toLowerCase()).indexOf("shortcut icon")?a=this.config.imagesdir+a:-1!=h.indexOf("stylesheet")?a=this.config.cssdir+a:(a="",s=!1):(s=!1,a="")),s&&""!=a&&(-1!=("|"+r+"|").indexOf("down")?(""!=n&&(n+="[,]"),n+=u+"[|]"+a):(""!=n&&(n+="[,]"),n+=a)),this.handleLeLabelParam(o,e,a))):""!=a&&(""!=n&&(n+="[,]"),n+=a))}return n},_XIYUETA.prototype.handleWebCharset=function(t){for(var e=0;e<=this.htmlArr.length-1;e++){var r=this.htmlArr[e];if(null!=r)if("meta"==r.label)if(-1!=r.html.toLowerCase().indexOf("charset=")){var l=this.handleLeLabelParam(r,"charset").toLowerCase().trim();if(""!=l)return null!=t&&this.handleLeLabelParam(r,"charset",t),l;if(-1!=(l=this.handleLeLabelParam(r,"content").toLowerCase().trim()).indexOf("utf-8"))return null!=t?(this.handleLeLabelParam(r,"content","text/html; charset="+t),""):"utf-8";if(-1!=l.indexOf("gb2312"))return null!=t?(this.handleLeLabelParam(r,"content","text/html; charset="+t),""):"gb2312"}}return""},_XIYUETA.prototype.removeNotNeededLabel=function(t){for(var e=0;e<=this.htmlArr.length-1;e++){var r=this.htmlArr[e];null!=r&&"/script"==r.label&&-1!=r.upHtml.indexOf("hm.baidu.com/h.js")&&(r.upHtml="")}},_XIYUETA.prototype.scan=function(t=""){t="|"+t+"|";var e,r,l=0,n=[],s=!1,i="",a="",h="",u=0,o=[];i+="网页编码："+this.handleWebCharset()+"\n",i+="网页大小："+this.common.getFileSize(this.common.bystesLength(this.htmlSource))+"\n";for(let t=0;t<=this.htmlArr.length-1;t++)(d=this.htmlArr[t])&&(2==d.tagpair&&("/"==d.label.substr(0,1)?(r=(e=d.label.substr(1)).length,e==a.substr(-1*r,r)?a=a.substr(0,a.length-r-1):(u++,d.upHtml+="\x3c!--xiyueta_tip：标签块超出"+d.html+"--\x3e",d.html="")):a+="|"+d.label),"/"!=d.label.substr(0,1)&&""!=d.label&&(-1==("|"+h+"|").indexOf("|"+d.label+"|")?(""!=h&&(h+="|"),h+=d.label,o[d.label]=1):o[d.label]++));if(""!=a){for(var m=a.split("|"),f="",c=1;c<=m.length-1;c++)f+="\x3c!--xiyueta_tip：缺少标签</"+m[c]+">--\x3e";(d=this.htmlArr[this.htmlArr.length-1])&&(d.html+=f),u+=m.length-1}var m=h.split("|"),p="";for(let t=0;t<=m.length-1;t++){var g=m[t];p+=g+"="+o[g]+","}i+="网页标签错误 "+u+"\n",i+="网页标签类型 "+m.length+"种 "+p+"\n",this.config.downcss=0;for(var d,b,v=this.getItem("link[rel|NOUL=stylesheet]","href"),A=this.getItem("script","src"),c=0;c<=this.htmlArr.length-1;c++)null!=(d=this.htmlArr[c])&&("body"==d.label?(l=d.lv,s=!0):0==s&&-1!="|div|span|table|ul|".indexOf("|"+d.label+"|")?(n.push(d.html),d.class=this.handleLeLabelParam(d,"class").trim().toLowerCase(),d.id=this.handleLeLabelParam(d,"id").trim().toLowerCase(),s=!0):s&&d.lv-l==1&&2==d.tagpair&&"/"!=d.label.substr(0,1)&&"!--"!=d.label&&"script"!=d.label.substr(0,6)&&(n.push(d.html),d.class=this.handleLeLabelParam(d,"class").trim().toLowerCase(),d.id=this.handleLeLabelParam(d,"id").trim().toLowerCase()),"link"==d.label&&"stylesheet"==d.rel&&(b=this.common.fullHttpUrl(this.config.httpurl,d.href),t.indexOf("|downcss|")&&null==d.content&&(this.getUrlStr(d,b),this.config.downcss++,alert("下载CSS"+b))));if(i+="共有CSS文件 "+v.length+" 条\n",i+="共有JS文件 "+A.length+" 条\n",i+="一层标签共 "+n.length+" 条\n",i+="\n",""!=v){i+="CSS列表：\n";for(let t=0;t<=v.length-1;t++)i+=this.common.fullHttpUrl(this.config.httpurl,v[t])+"\n"}if(""!=A){i+="\n\nJS列表：\n";for(let t=0;t<=A.length-1;t++)i+=this.common.fullHttpUrl(this.config.httpurl,A[t])+"\n"}if(""!=n){i+="\n\n一层标签列表：\n";for(let t=0;t<=n.length-1;t++)i+=n[t]+"\n"}return i},_XIYUETA.prototype.cutLabel=function(t,e){for(var r="",l=0;l<=this.htmlArr.length-1;l++)null!=(o=this.htmlArr[l])&&("/style"==o.label?r+=o.upHtml:"link"==o.label&&"stylesheet"==o.rel&&(r+=o.content));var n="*,body,",s=-1;if(""!=(c=this.getDocument(t))){var i=c=c.replace(/,/,""),a=c;-1!=c.indexOf("|")&&(i=(u=c.split("|"))[0],a=u[1]);for(var h,l=i;l<=parseInt(a)-1;l++)null!=(o=this.htmlArr[l])&&"/"!=o.label.substr(0,1)&&(-1==s&&(o.label,s=o.lv),s+1==o.lv&&o.label,s+2==o.lv&&o.label,s+3==o.lv&&o.label,n+=o.label+",",""!=(h=this.handleLeLabelParam(o,"id").toLowerCase())&&(n+="#"+h+","),""!=(h=this.handleLeLabelParam(o,"class").toLowerCase())&&(n+="."+h.replace(/ /g,",.")+","));var u=n.split(","),n="";for(let t=0;t<=u.length-1;t++)-1==(","+n+",").indexOf(","+u[t]+",")&&(""!=n&&(n+=","),n+=u[t]);var o,m="",f=new _XIYUETACSS;f.cssParse(r);for(let t=0;t<=f.cssArr.length-1;t++)if(null!=(o=f.cssArr[t])){var c=","+o.label+",";o.label;for(let t=0;t<=u.length-1;t++)-1==c.indexOf(","+u[t]+",")&&-1==c.indexOf(","+u[t]+" ")||-1==("\n"+m+"\n").indexOf("\n"+o.html+"\n")&&(m+=o.html+"\n")}f.debug(),xiyuetaCSS(m).parse(),""!=(m=xiyuetaCSS().print("zip"))&&(m="<style>"+m+"\n</style>\n");i=this.getHtml(t,"all");this.htmlParse(i);i=m+this.printHtml("format")}return i},_XIYUETA.prototype.getUrlStr=function(e,r){var l=this;$.ajax({url:this.config.serverurl+"?act=getUrlStr&n="+Math.random(),type:"POST",data:{httpurl:r},error:function(t,e,r){},success:function(t){xiyuetaCSS(t).parse(),xiyuetaCSS().allcss("|url","server="+r),e.content=xiyuetaCSS().print(),l.config.downcss--,0==l.config.downcss?alert("下载全部CSS完成，可以点击下一步 了"):alert("下载CSS完成,还乘"+l.config.downcss)}})},_XIYUETA.prototype.getLabelHtml=function(t,e){for(var r="",l=t;l<=e;l++){var n=this.htmlArr[l];t<l&&(r+=n.upHtml),t<l&&l<e&&(r+=n.html)}return r},function(){var r=new(window._XIYUETATPL=function(t){"use strict";null==t&&(t=""),this.common=new XiyuetaCommon,this.nav=function(t,e){var r=new _XIYUETA;if(r.htmlParser(t),""!=(l=r.getDocument(e+":eq(0)"))){var l,t=l.substr(1,l.indexOf("|")-1),t=r.htmlArr[t];return console.log(t),r.attr("a:eq(0)","href",'?nav=<%=rs("columnName")%>'),r.setHtml("a:eq(0)",'<%=rs("columnName")%>'),l='<%rs.open "select * from " & db_PREFIX & "WebColumn where parentId=-1 order by sortRank asc" ,conn,1,1\nwhile not rs.eof\n%>\n'+(l=r.getHtml(e+":eq(0)","all")),t.upHtml+=l+="\n<%rs.movenext:wend:rs.close%>",r.deleteDoc(e),r.debug(),r.printHtml("format")}}});window.xiyuetaTPL=function(e){return{nav:function(t){return r.nav(e,t)}}}}();