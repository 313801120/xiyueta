/*! xiyueta v1.3.1 | Author xiyueta Adream | MIT License By http://xiyueta.com/  */
var _XIYUETACSS=function(t){"use strict";this.cssSource=t=null==t?"":t,this.cssArr=[],this.common=new XiyuetaCommon,this.lv=0,this.config={parentdir:"../",imagesdir:"images/"},this.cssParse=function(t){null!=t&&(this.cssSource=t,this.cssArr=[]);var e,l="",i="",s="",r="",n=!1,a=!1,h=!1,o=!1,u=!1,f=0;this.domList="";for(var p=0;p<=this.cssSource.length-1;p++)e=l,l=this.cssSource.substr(p,1),n?(s+=l,h?"/"==l&&"*"==e&&(n=h=!1,this.cssArr.push({lv:1,label:"/*",upHtml:r,downHtml:"",html:s}),r=s=""):a&&"*"==l&&"/"==e?h=!0:o?!u||";"!=l&&"\n"!=l?" "==l&&a?"@charset "==s.toLowerCase()?a=!(u=!0):"@font-face "==s.toLowerCase()&&(o=!1):"{"==l&&("@font-face "==s.toLowerCase()?o=!1:(o=n=a=!1,this.cssArr.push({lv:1,label:i.toLowerCase().replace(/ /g,"").trim(),upHtml:r,downHtml:"",html:s}),f++,r=s="")):(o=n=a=u=!1,this.cssArr.push({lv:1,label:i.toLowerCase().replace(/ /g,"").trim(),upHtml:r,downHtml:"",html:s}),r=s=""):"{"==l&&a?a=!1:"}"==l&&(n=a=!1,this.cssArr.push({lv:f+1,label:i.toLowerCase().replace(/ /g,"").trim(),upHtml:r,downHtml:"",html:s}),r=s=""),a&&(" "!=l||" "!=e&&","!=e)&&(i+=l)):" "!=l&&";"!=l&&"\n"!=l?"}"==l&&1==f?(this.cssArr.push({lv:f,label:"}",upHtml:r,downHtml:"",html:"}"}),r=s="",f--):(r=s,a=n=!0,"@"==(i=s=l)&&(o=!0)):s+=l;""!=s&&this.cssArr.push({lv:f,label:"",upHtml:"",downHtml:"",html:s}),this.lv=f},this.handleLabelParam=function(t,e,l){if(null==e&&(e="[All]"),null==l&&null!=t[e])return t[e];var i,s="";-1!=e.indexOf("|")&&(e=(i=e.split("|"))[0],s=i[1],""==e&&(e="[All]"));for(var r=!1,n="",a="",h=!1,o="",u=!1,f=!0,p=0,m=0,c=!1,g="",d=t.html.indexOf("{")+1;d<=t.html.length-1;d++){var b=t.html.substr(d,1);if(h)if(u){if(0!=(c=1==c&&")"==b?!1:c)||b!=o&&"}"!=b&&d!=t.html.length-1)a+=b,"("==b&&(c=!0);else if(t[n=n.toLowerCase().trim()]=a,u=h=!1,o="",e==n||"[All]"==e)if(null==l){if("url"!=s)return a;""!=(a=this.cssSrcUrl(a))&&(""!=g&&(g+="\n"),g+=a)}else{if(""==l){var x=t.html.substr(0,m),y=t.html.substr(d+1);return t.html=x+y,t}var v=p,C=p+a.length;f&&(v++,C++);x=t.html.substr(0,v),y=t.html.substr(C);if("url"!=s){A=x+l+y;return t.html=A,t[n]=l,t}C=this.cssSrcUrl(a,l);if(""!=C){""!=g&&(g+="\n"),g+=C;var A=x+C+y;return t.html=A,d=(x+(t[n]=C)).length,t}}}else" "!=b&&(o=";",p=d,f=!(u=!0),a=b);else r?":"==b?(h=!(r=!1),o=a=""):" "!=b&&(n+=b):" "!=b&&(r=!0,n=b,m=d)}return null!=l&&""!=l&&(t.html=t.html.replace("{","{"+e+":"+l+";")),g=""==g?void 0:g},this.getDocument=function(t,e,l){null==e&&(e=0),null==l&&(l=this.cssArr.length-1);var i=-1.1,s=-1.1,r=-1.1,n=-1.1,a="",h="",o="",u="",f="";if(t=(t=null==t?"":t).trim(),0==this.cssArr.length)return console.log("%c 需要先解析一段css文本","font-size:14px;color:#FF3300"),"";if(-1!=t.indexOf("'")||-1!=t.indexOf('"')||-1!=t.indexOf("(")){for(var p=!1,m="",c=0;c<=t.length;c++){var g=t.substr(c,1);0!=p||"'"!=g&&'"'!=g&&"("!=g&&")"!=g?1==p?" "==g?g="-Space-":"'"!=g&&'"'!=g&&"("!=g&&")"!=g||(p=!1,"'"!=g&&'"'!=g||(g="")):" "==g&&(g=""):(p=!0,"'"!=g&&'"'!=g||(g="")),m+=g}t=m}var d,b,x,y,v,C=t.indexOf(":");-1!=C&&(b=d="",x=(g=t.substr(C+1)).indexOf("("),y=g.indexOf(")"),-1!=x&&-1!=y?(d=g.substr(0,x).toLowerCase(),y=(b=g.substr(x+1)).indexOf(")"),b=b.substr(0,y).replace(/-Space-/g," ").trim()):d=g.toLowerCase(),"first"==d?i=0:"last"==d?i=-1:"even"==d?s=1:"odd"==d?s=0:"eq"==d?(i=0,(i=""!=b?parseInt(b):i)+""=="NaN"&&(i=-.1,t="")):"gt"==d?""!=b&&(r=parseInt(b)):"lt"==d?""!=b&&(n=parseInt(b)):"contains"==d?a=b:console.log(t,"没有动作 "+d),""==(t=t.substr(0,C))&&-.1!=i&&(t="(all)")),-1!=(C=t.indexOf("["))&&(y=(g=t.substr(C+1)).indexOf("]"),-1==(g=g.substr(0,y)).indexOf("=")?(h=g,o="*"):(h=(v=g.split("="))[0],o=v[1].replace(/-Space-/g," "),v=h.substr(h.length-1),-1!="!^$*~|".indexOf(v)&&(h=h.substr(0,h.length-1),u=v)),-1!=h.indexOf("|")&&(h=(v=h.split("|"))[0],"NOUL"==v[1]&&(o=o.toLowerCase(),f=v[1])),""==(t=t.substr(0,C))&&(t="(all)")),t=t.replace(/ /g,"");for(m="",c=e;c<=l;c++){var A=this.cssArr[c];null!=A&&(t!=A.label&&"(all)"!=t||(m+=","+c))}if(""!=m&&-1.1!=i){var L=m.split(",");""!=(m=i<0?L[L.length+i]:L[i+1])&&(m=","+m)}else if(""!=m&&-1.1!=s){L=m.split(",");m="";for(c=1;c<=L.length-1;c++)c%2==s&&(m+=","+L[c])}else if(""!=m&&-1.1!=r){L=m.split(",");m="";for(c=r+2;c<=L.length-1;c++)m+=","+L[c]}else if(""!=m&&-1.1!=n){L=m.split(",");m="",n>L.length-1&&(n=L.length-1);for(c=1;c<=n;c++)m+=","+L[c]}else if(""!=m&&""!=a){L=m.split(",");m="";for(c=1;c<=L.length-1;c++){g=L[c];this.domList=","+g,-1!=this.text("").indexOf(a)&&(m+=","+L[c])}}else if(""!=h){L=m.split(",");m="";for(c=1;c<=L.length-1;c++){var O=L[c];this.domList=","+O;var w=!0,g=this.css(h);"NOUL"==f&&null!=g&&(g=g.toLowerCase()),"^"==u?null!=g&&g.substr(0,o.length)==o||(w=!1):"|"==u?null!=g&&(g+"-").substr(0,o.length+1)==o+"-"||(w=!1):"$"==u?null!=g&&g.substr(-1*o.length)==o||(w=!1):"~"==u?null!=g&&-1!=(" "+g+" ").indexOf(" "+o+" ")||(w=!1):"*"==u?null!=g&&-1!=g.indexOf(o)||(w=!1):"!"==u?g==o&&(w=!1):null!=g&&"*"==o?w=!0:g!=o&&(w=!1),w&&(m+=","+O)}}return m},this.text=function(t,e,l,i){for(var s=this.domList,r="",n=(s=null==this.domList?this.getDocument(t,l,i):s).split(","),a=1;a<=n.length-1;a++){var h,o,u=this.cssArr[n[a]];null!=u&&(h=u.html.indexOf("{"),o=u.html.indexOf("}"),null==e?-1!=h&&-1!=o&&(r+=u.html.substr(h+1,o-h-1)):u.html=u.html.substr(0,h+1)+e+"}")}return r},this.html=function(t,e,l,i){for(var s=this.domList,r=(s=null==this.domList?this.getDocument(t,l,i):s).split(","),n=1;n<=r.length-1;n++){var a=this.cssArr[r[n]];if(null!=a){if(null==e)return a.html;a.html=e}}},this.after=function(t,e,l,i){for(var s=this.domList,r=(s=null==this.domList?this.getDocument(t,l,i):s).split(","),n=1;n<=r.length-1;n++){var a=this.cssArr[r[n]];null!=a&&null!=e&&(a.downHtml+=e)}return this},this.before=function(t,e,l,i){for(var s=this.domList,r=(s=null==this.domList?this.getDocument(t,l,i):s).split(","),n=1;n<=r.length-1;n++){var a=this.cssArr[r[n]];null!=a&&null!=e&&(a.upHtml+=e)}return this},this.remove=function(t,e,l){for(var i=this.domList,s=(i=null==this.domList?this.getDocument(t,e,l):i).split(","),r=1;r<=s.length-1;r++){var n=this.cssArr[s[r]];null!=n&&(n.html="",n.label="<del>")}return this},this.css=function(t,e,l,i,s){for(var r=this.domList,n=(r=null==this.domList?this.getDocument(t,i,s):r).split(","),a=1;a<=n.length-1;a++){var h=this.cssArr[n[a]];if(null!=h){if(null==l)return this.handleLabelParam(h,e);this.handleLabelParam(h,e,l)}}},this.getBackground=function(t,e,l){for(var i,s=this.domList,r="",n=(s=null==this.domList?this.getDocument(t,e,l):s).split(","),a=1;a<=n.length-1;a++)null!=this.cssArr[n[a]]&&(this.domList=","+n[a],null!=(i=this.css("","background"))&&(i=this.cssSrcUrl(i),r+=this.handleClearBackground(i)));return r},this.setBackground=function(t,e,l,i){for(var s,r=this.domList,n=(r=null==this.domList?this.getDocument(t,l,i):r).split(","),a=1;a<=n.length-1;a++)null!=this.cssArr[n[a]]&&(this.domList=","+n[a],null!=(s=this.css("","background"))&&("server="==e.substr(0,7)?(s=this.handleClearBackground(s),e=this.common.fullHttpUrl(e.substr(7),s)):"dir="==e.substr(0,4)&&(s=this.handleClearBackground(s),e=e.substr(4)+this.common.getUrlFileName(s)),this.css("","background","url("+e+")")));return this},this.getsrc=function(t,e,l,i){for(var s=this.domList,r="",n=(s=null==this.domList?this.getDocument(t,l,i):s).split(","),a=1;a<=n.length-1;a++)if(null!=this.cssArr[n[a]]){this.domList=","+n[a];var h=this.text("").replace(/;/g,","),o=this.cssSrcUrl(h),o=this.handleClearBackground(o);if(null!=e)for(var u=o.split(","),f=0;f<=u.length-1;f++)""!=(o=u[f])&&("server="==e.substr(0,7).toLowerCase()?o=this.common.fullHttpUrl(e.substr(7),o):"dir="==e.substr(0,4).toLowerCase()?o=e.substr(4)+this.common.getUrlFileName(o):"filename"==e.substr(0,8).toLowerCase()&&(o=this.common.getUrlFileName(o)),""!=r&&(r+=","),r+=o);else""!=o&&(""!=r&&(r+=","),r+=o)}return r},this.setSrcUrl=function(t,e,l,i){for(var s=this.domList,r=(s=null==this.domList?this.getDocument(t,l,i):s).split(","),n=1;n<=r.length-1;n++)if(null!=this.cssArr[r[n]]){this.domList=","+r[n];for(var a="",h=this.text(""),o=h.split(";"),u=0;u<=o.length-1;u++){s=o[u];""!=a&&(a+=";"),a+=s=this.cssSrcUrl(s,e)}h!=a&&this.text("",a)}return this},this.handleClearBackground=function(t){var e=t.indexOf("(");if(-1==(t=-1!=(e=(t=-1!=e?t.substr(e+1):t).indexOf(")"))?t.substr(0,e):t).indexOf("'")&&-1==t.indexOf('"')&&-1==t.indexOf("("))return t;for(var l=!1,i="",s=0;s<=t.length;s++){var r=t.substr(s,1);0!=l||"'"!=r&&'"'!=r&&"("!=r&&")"!=r?1==l?"'"!=r&&'"'!=r&&"("!=r&&")"!=r||(l=!1,"'"!=r&&'"'!=r||(r="")):" "==r&&(r=""):(l=!0,"'"!=r&&'"'!=r||(r="")),i+=r}return i.trim()},this.cssSrcUrl=function(t,e){if(-1==t.indexOf(","))return this.handleCssSrcUrl(t,e);for(var l=t.split(","),i="",s=0;s<l.length;s++){var r=l[s];""!=(r=this.handleCssSrcUrl(r,e))&&(""!=i&&(i+=","),i+=r)}return i},this.handleCssSrcUrl=function(t,e){if(null==t)return"";if(null==e){if(-1==t.indexOf("(")||-1==t.indexOf(")"))return null==e||"dir="==e.substr(0,4)||"server="==e.substr(0,7)?"":t;if(-1==t.toLowerCase().indexOf("url"))return null==e||"dir="==e.substr(0,4)||"server="==e.substr(0,7)?"":t}for(var l="",i=!1,s=!1,r="",n=-1,a=0;a<=t.length-1;a++){var h=t.substr(a,1);if(i)if(s){if(r==h){var o=t.substr(n,a-n);if(null!=e)if("server="==e.substr(0,7)){if(-1!=o.indexOf("data:"))return t;o=t.substr(0,n)+this.common.fullHttpUrl(e.substr(7),o)+t.substr(a)}else if("dir="==e.substr(0,4)){if(-1!=o.indexOf("data:"))return t;o=t.substr(0,n)+e.substr(4)+this.common.getUrlFileName(o)+t.substr(a)}else-1==o.indexOf("data:")&&(o=t.substr(0,n)+e+t.substr(a));return o}}else""!=h&&('"'==h||"'"==h?(s=!0,r=h,-1==n&&(n=a+1)):" "!=h&&(s=!0,r=")",-1==n&&(n=a)));else if("("==h){if("url"==l.trim().toLowerCase().substr(-3,3))i=!0;else if(null==e)return""}else l+=h}return t},this.handleCssCharset=function(t){for(var e=0;e<=this.cssArr.length-1;e++){var l=this.cssArr[e];if(null!=l)if("@charset"==l.label)return null!=t?(l.html='@charset "'+t+'";',""):l.html.substr(9).replace(/"/g,"").replace(/'/g,"").replace(/;/g,"").trim().toLowerCase()}return""},this.setConfig=function(t){if(null==t)return this.config;if(null!=t.imagesdir&&(this.config.imagesdir=t.imagesdir,null!=t.cssdir)){for(var e=t.cssdir.split("/"),l="",i=0;i<=e.length-2;i++)l+="../";this.config.parentdir=l}null!=t.parentdir&&(this.config.parentdir=t.parentdir)},this.printCss=function(t){for(var e="",l=0;l<=this.cssArr.length-1;l++){var i,s=this.cssArr[l];null!=s&&(i=s.upHtml+s.html+s.downHtml,"zip"==t?i="/*"==s.label?"":i.replace(/  /g," ").replace(/  /g," ").replace(/{ /g,"{").replace(/ {/g,"{").replace(/\n/g,"").trim():"format"==t&&(i=i.trim()+"\n"),""!=i&&(e+=i))}return e},this.debug=function(t){((t=null==t?!1:t)?xiyueta:console).log(this.cssArr)}},_xytcss=new _XIYUETACSS,xiyuetaCss=function(t,e,l){return new xiyuetaCss.fn.init(t,e,l)};xiyuetaCss.fn=xiyuetaCss.prototype={length:1,selector:"",docList:"",x:null,y:null},xiyuetaCss.extend=xiyuetaCss.fn.extend=function(){var t,e,l,i=arguments[0]||{},s=1,r=arguments.length;for(s===r&&(i=this,s--);s<r;s++)if(null!=(t=arguments[s]))for(e in t)l=t[e],"__proto__"!==e&&i!==l&&void 0!==l&&(i[e]=l);return i};var init=xiyuetaCss.fn.init=function(t,e,l){this.length=0,this.selector=t,this.x=e,this.y=l,null==this.selector&&(this.selector="[All]"),0<_xytcss.cssArr.length&&("string"==typeof t?(l=(e=_xytcss.getDocument(t,e,l)).split(","),this.length=l.length-1,this.domList=e):"#object"==typeof t&&(this.domList=","+t.x,this.selector="")),_xytcss.domList=this.domList,null==this.selector&&(this.selector="")};init.prototype=xiyuetaCss.fn,(xiyuetaCSS=$xytcss=$css=xiyuetaCss).fn.extend({parse:function(t){var e;return _xytcss.cssParse(t),0<_xytcss.cssArr.length&&"string"==typeof this.selector&&(t=(e=_xytcss.getDocument(this.selector,this.x,this.y)).split(","),this.length=t.length-1,_xytcss.domList=this.domList=e),this},text:function(t){return null!=t?(_xytcss.text(this.selector,t),this):_xytcss.text(this.selector)},html:function(t){return null!=t?(_xytcss.html(this.selector,t),this):_xytcss.html(this.selector)},css:function(t,e){return null!=e?(_xytcss.css(this.selector,t,e),this):_xytcss.css(this.selector,t)},remove:function(){return _xytcss.remove(this.selector,this.x,this.y),this},after:function(t){return _xytcss.after(this.selector,t,this.x,this.y),this},before:function(t){return _xytcss.before(this.selector,t,this.x,this.y),this},background:function(t){return null==t?_xytcss.getBackground(this.selector,this.x,this.y):(_xytcss.setBackground(this.selector,t,this.x,this.y),this)},getsrc:function(t){return _xytcss.getsrc(this.selector,t,this.x,this.y)},setsrc:function(t){return _xytcss.setSrcUrl(this.selector,t,this.x,this.y),this},charset:function(t){return _xytcss.handleCssCharset(t)},config:function(t){return _xytcss.setConfig(t)},print:function(t){return _xytcss.printCss(t)},debug:function(t){return _xytcss.debug(t)}}),xiyuetaCSS.fn.extend({eq:function(t){null==t||""==t?t=0:(t=parseInt(t))+""=="NaN"&&(t=-1.1);var e,l="";return-1.1==t?(this.selector="",this.length=0):(e=this.domList.split(","),0<=t?t++:t=e.length+t,l=e[t],this.length=1,(this.selector="")!=l&&(l=","+l)),_xytcss.domList=this.domList=l,this},first:function(){return this.eq(0),this},last:function(){return this.eq(-1),this},even:function(){for(var t=this.domList.split(","),e="",l=1;l<=t.length-1;l++)l%2==1&&(e+=","+t[l]);return _xytcss.domList=this.domList=e,this},odd:function(){for(var t=this.domList.split(","),e="",l=1;l<=t.length-1;l++)l%2==0&&(e+=","+t[l]);return _xytcss.domList=this.domList=e,this},slice:function(t,e){return _xytcss.domList=this.domList=_xytcss.slice(this.domList,this.x,this.y,t,e),-1!=this.domList.indexOf(",")?(e=this.domList.split(","),this.length=e.length-1):this.length=0,this},lv:function(){return _xytcss.lv}});var _XIYUETAASP=function(t){"use strict";this.aspSource=t=null==t?"":t,this.aspArr=[],this.common=new XiyuetaCommon,this.config={},this.phpPublicObjectList="",this.phpPublicFunList="",this.aspParse=function(t){null!=t&&(this.aspSource=t,this.aspArr=[]);var e,l="",i="",s="",r="",n="",a="",h="",o=!1,u=!1,f=0,p="",m=0;this.aspSource=this.aspSource.replace(/\t/g,"  ");for(var c=this.aspSource.split("\n"),g=0;g<=c.length-1;g++){for(var d,b,x,y=0;y<=c[g].length;y++)if(i=l,l=c[g].substr(y,1),s=c[g].substr(y+1,1),e=c[g].substr(y+1,2),0==o)"%"==l&&"<"==i?(o=!0,this.aspArr.push({lv:f,type:"<asp>",label:"<%",upHtml:h.substr(0,h.length-1),html:"<%",tagpair:2}),r=h=a="",f++):h+=l;else if("%"==l&&">"==s)o=!1,f--,this.aspArr.push({lv:f,type:"<asp>",label:"%>",upHtml:h,html:"%>",tagpair:2}),r=h=a="",y++,i=l,l=c[g].substr(y,1),s=c[g].substr(y+1,1);else if(a+=l,'"'==l||""!=p)'"'==l&&m++,m%2==0&&'"'!=s?(p+=l,this.aspArr.push({lv:f,type:"<str>",label:r,upHtml:h,html:p,tagpair:2}),m=0,r=h=a=p=""):p+=l;else if("("==l)f++,this.aspArr.push({lv:f,type:"<(>",label:l,upHtml:h,html:a,tagpair:2}),r=h=a="";else if(")"==l)this.aspArr.push({lv:f,type:"<)>",label:l,upHtml:h,html:a,tagpair:2}),r=h=a="",f--;else if(-1!="|&|,|+|-|*|/|=|:|>|<|".indexOf("|"+l+"|"))this.aspArr.push({lv:f,type:"<fuhao>",label:l,upHtml:h,html:a,tagpair:1}),"="!=l&&">"!=l||">"!=(b=this.aspArr[this.aspArr.length-2]).label&&"<"!=b.label||(b.label+=l,b.html+=" "+l,this.aspArr.pop()),r=h=a="";else{if("'"==l){this.aspArr.push({lv:f,type:"<note>",label:l,upHtml:a,html:c[g].substr(y+1),tagpair:1}),r=h=a="";break}""==l||" "==l||"\t"==l||-1=="' ()+-*/=><&,:".indexOf(s)&&y!=c[g].length&&"%>"!=e?" "!=l&&"\t"!=l&&(r+=l.toLowerCase()):(r+=l.toLowerCase(),n=-1!="0123456789".indexOf(r.substr(0,1))?"<int>":"("==s||-1!=",not,strcomp,vbtextcompare,step,dim,if,then,elseif,else,end,function,sub,sele/ct,case,call,for,to,next,set,nothing,do,while,loop,and,true,false,vbcrlf,in,class,new,mod,byval,byref,or,exit,rnd,lcase,ucse,asc,".indexOf(","+r+",")||-1!=r.indexOf(".")?"<fun>":"<var>",this.aspArr.push({lv:f,type:n,label:r,upHtml:h,html:a,tagpair:2}),"function"==r?"end"==(d=this.aspArr[this.aspArr.length-2]).label?(f--,d.lv--,d.label+="function",d.html+=" function",this.aspArr.pop()):"exit"==d.label?(d.label+="function",d.html+=" function",this.aspArr.pop()):f++:"sub"==r?"end"==(d=this.aspArr[this.aspArr.length-2]).label?(f--,d.lv--,d.label+="sub",d.html+=" sub",this.aspArr.pop()):"exit"==d.label?(d.label+="sub",d.html+=" sub",this.aspArr.pop()):f++:"if"==r?"end"==(d=this.aspArr[this.aspArr.length-2]).label?(f--,d.lv--,d.label+="if",d.html+=" if",this.aspArr.pop()):f++:"else"==r||"elseif"==r||"then"==r?(this.aspArr[this.aspArr.length-1].lv--,"else"==r&&"case"==(d=this.aspArr[this.aspArr.length-2]).label&&(d.lv,d.label+="else",d.html+=" else",this.aspArr.pop())):"select"==r?"end"==(d=this.aspArr[this.aspArr.length-2]).label?(f--,d.lv--,d.label+="select",d.html+=" select",this.aspArr.pop(),u&&(u=!1,f--,d.lv--)):f++:"case"==r?"select"==(b=this.aspArr[this.aspArr.length-2]).label?(b.label+="case",b.html+=" case",this.aspArr.pop()):u?this.aspArr[this.aspArr.length-1].lv--:(f++,u=!0):"class"==r?"end"==(d=this.aspArr[this.aspArr.length-2]).label?(f--,d.lv--,d.label+="class",d.html+=" class",this.aspArr.pop()):f++:"each"==r?"for"==(b=this.aspArr[this.aspArr.length-2]).label&&(b.label+="each",b.html+=" each",this.aspArr.pop()):"while"==r?("do"==(b=this.aspArr[this.aspArr.length-2]).label&&(b.label+="while",b.html+=" while",this.aspArr.pop()),f++):"do"==r?"exit"==(b=this.aspArr[this.aspArr.length-2]).label&&(b.label+="do",b.html+=" do",this.aspArr.pop()):"loop"==r?(f--,this.aspArr[this.aspArr.length-1].lv--):"for"==r?"exit"==(b=this.aspArr[this.aspArr.length-2]).label?(b.label+="for",b.html+=" for",this.aspArr.pop()):f++:"next"==r?(b=this.aspArr[this.aspArr.length-2],x=this.aspArr[this.aspArr.length-4],"resume"==b.label?(x.label+="errorresumenext",x.html+=" error resume next",this.aspArr.pop(),this.aspArr.pop(),this.aspArr.pop()):(f--,this.aspArr[this.aspArr.length-1].lv--)):"goto"==r&&(b=this.aspArr[this.aspArr.length-2],x=this.aspArr[this.aspArr.length-3],"error"==b.label&&(x.label+="errorgoto",x.html+=" error goto",this.aspArr.pop(),this.aspArr.pop())),n=r=h=a="")}g+1<c.length&&(this.aspArr.push({lv:f,type:"<br>",label:"\n",upHtml:h,html:"\n",tagpair:1}),h="")}""!=h&&this.aspArr.push({lv:f,type:"<html>",label:"",upHtml:h,html:"",tagpair:1})},this.tophp=function(){for(var t="",e="",l=[],i=[],s=[],r=0,n=!1,a=!1,h=!1,o="",u="",f="++",p="",m=!1,c=-1,g=-1,d=!1,b=-1,x="",y=",",v=","+this.phpPublicFunList,C=","+this.phpPublicObjectList,A=-1,L=[],O=!0,w="",_="",H=",",S=!1,T=0;T<=this.aspArr.length-1;T++){var I,O=!0;A==T&&(":"==(l=this.aspArr[T]).label?(e+=":",T++):e+=":",A=-1),0<T&&(i=this.aspArr[T-1]),l=this.aspArr[T],s={},T<this.aspArr.length-1&&(s=this.aspArr[T+1]),null!=L[l.lv]&&(e=L[l.lv]+"\n"+e,L[l.lv]=void 0),"<br>"==i.type&&(e+=this.common.copyStr("    ",l.lv+r)),1==l.phpDel||("<%"==l.label?(e+=l.upHtml+"<?",r--,"="!=s.label&&(e+="PHP","<br>"!=s.type&&"<note>"!=s.type&&"<asp>"!=s.type&&(e+=" "))):"%>"==l.label?e+="?>":"<br>"==l.type?(a&&(e+="}",a=!1),e+=l.upHtml+"\n"):"<note>"==l.type?e+="//"+l.html:"<html>"==l.type?e+=l.upHtml+l.html:"<var>"==l.type?"onerrorresumenext"==l.label||("onerrorgoto"==l.label?e+="$"+l.label:(!h&&0!=S||""==w||(H+=l.label+","),-1!=v.indexOf(","+l.label+",")?"class"==i.label?(O=!1,e+=l.label+"{"):"new"==i.label?e+=l.label+"()":"="==s.label?(e+="return ",T++):(e+=l.label,"<(>"!=s.type&&(e+="()")):0==h&&-1==H.indexOf(","+l.label+",")&&S?e+="$GLOBALS['"+l.label+"']":(e+="$"+l.label,h&&(e+="=''")),e+=this.getAddFenHao(e,s,a))):"<fuhao>"==l.type||"<int>"==l.type||"<(>"==l.type||"<)>"==l.type?n&&"="==l.label?e+="==":"&"==l.label?e+=".":"("==l.label?c==l.lv?e+="[":e+="(":")"==l.label?(c==l.lv?(e+="]","("!=s.label&&(c=-1)):b==l.lv?(t+=e+","+x+")",b=-1,x=e=""):g==l.lv?(g=-1,e+="){",""!=w&&(S=!0,"function"==_&&(e+="\n"+this.common.copyStr("    ",l.lv+r-1)+"$"+w+"=''"))):e+=")",e+=this.getAddFenHao(e,s,a)):","==l.label?m?(e+="]=",m=!1):b==l.lv?(x=e,e=""):h?(e+=";","<br>"!=s.type&&"<note>"!=s.type&&"<asp>"!=s.type||(h=!1)):e+=",":":"==l.label?(";"!=e.substr(e.length-1)&&(e+=";"),h=!1):"<>"==l.label?e+="!=":"<int>"==l.type?(e+=l.label,-1!=A||"selectcase"==p||"<br>"!=s.type&&"<note>"!=s.type&&"<asp>"!=s.type||(e+=";")):e+=l.label:"<str>"==l.type?(e+="'"+l.html.substr(1,l.html.length-2).replace(/""/g,'"').replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'",e+=this.getAddFenHao(e,s,a)):"<fun>"==l.type&&("response.write"==l.label?e+="echo":"response.end"==l.label?e+="die":"request.querystring"==l.label?e+="querystring":"request.form"==l.label?e+="form":"request.servervariables"==l.label?e+="servervariables":"err.number"==l.label?e+="0":"err.clear"==l.label?e+="echo('');":"nothing"==l.label?e+="null":"step"==l.label?(e+=";",f="+="+s.label,s.phpDel=!0):"byref"==l.label?e+="&":"isnumeric"==l.label?e+="is_numeric":"strcomp"==l.label?e+="aspStrComp":"vbtextcompare"==l.label?e+="''":"chr"==l.label?e+="aspchr":"hex"==l.label?e+="dechex":"and"==l.label?e+=" && ":"or"==l.label?e+=" || ":"mod"==l.label?e+=" % ":"not"==l.label?e+="!":"exitfor"==l.label?e+="break":"ubound"==l.label?e+="count":"split"==l.label?(y+=this.aspArr[T-2].label+".add,",t+=e+="explode(",e="",b=l.lv+1,T++):"new"==l.label?e+="new ":"function"==l.label||"sub"==l.label?(g=this.aspArr[T+2].lv,e+="function ",-1==v.indexOf(","+s.label+",")&&(v+=s.label+","),w=s.label,_=l.label):"endfunction"==l.label||"endsub"==l.label?("endsub"==l.label?e+=this.common.copyStr("    ",l.lv)+"return '';\n}":e+=this.common.copyStr("    ",l.lv)+"return @$"+w+";\n}",_=w="",S=!(H=",")):"exitfunction"==l.label?e+="return ''":"if"==l.label?(e+=l.label+"(",n=!0):"elseif"==l.label?(e+="}else if(",n=!0):"then"==l.label?(e+="){","<br>"!=s.type&&"<note>"!=s.type&&"<asp>"!=s.type&&(a=!0),n=!1):"else"==l.label?e+="}else{":"endif"==l.label?(e+="}",a=!1):"selectcase"==l.label?(e+="switch ","("!=s.label&&(e+="("),p="selectcase"):"endselect"==l.label?(null!=L[l.lv+1]&&(e=L[l.lv+1]+"\n"+e,L[l.lv+1]=void 0),e+="}",0):"caseelse"==l.label?(e+="default ",L[l.lv]=this.common.copyStr("    ",l.lv)+"break;",A=T+1,O=!!0):"case"==l.label?(e+=l.label+" ",L[l.lv]=this.common.copyStr("    ",l.lv)+"break;",A=T+2):"vbcrlf"==l.label?e+='"\\n"':"createobject"==l.label?(0<T-1&&(y+=this.aspArr[T-2].label+".add,"),T+1<this.aspArr.length&&'"scripting.dictionary"'==this.aspArr[T+2].html.toLowerCase()&&(e+="array();",T+=3)):-1!=y.indexOf(","+l.label+",")?(-1!=l.label.indexOf(".")?e+="$"+l.label.substr(0,l.label.indexOf("."))+"[":(e+="$"+l.label,c=s.lv),","==this.aspArr[T+2].label&&(m=!0)):-1!=y.indexOf(","+l.label+".")?(e+="$"+l.label,c=s.lv):"do"==l.label?e+="for(;;) {":"exitdo"==l.label?e+="break":"dowhile"==l.label?(e+="while","("!=s.label&&(e+="("),d=!0):"loop"==l.label?e+="}":"class"==l.label?(e+="class ",-1==v.indexOf(","+s.label+",")&&(v+=s.label+","),-1==C.indexOf(","+s.label+",")&&(C+=s.label+",")):"endclass"==l.label?e+="}":"foreach"==l.label?(I=this.aspArr[T+1],e+="foreach($"+this.aspArr[T+3].label+" as $key=>$"+I.label+"){",T+=3):"for"==l.label?(e+=l.label,"("!=s.label&&(e+="("),o="for",u=s.label,f="++"):"for"==o&&"to"==l.label?(I=this.aspArr[T+1],"ubound"==s.label?e+=";$"+u+"<":e+=";$"+u+"<=",o="forto"):"next"==l.label?e+="}":"dim"==l.label?h=!0:-1!=l.label.indexOf(".")?e+="$"+l.label.replace(/\./g,"->"):-1==",call,set,byval,".indexOf(","+l.label+",")&&(-1!=v.indexOf(","+l.label+",")?(w==l.label&&"function"!=i.label&&"sub"!=i.label&&(e+="$"),"class"==i.label?e+=l.label+"{":"new"==i.label?e+=l.label+"()":(e+=l.label,"<(>"!=s.type&&w!=l.label&&(e+="()"))):e+=l.label),"<br>"!=s.type&&"<note>"!=s.type||!O||-1==",endfunction,then,endif,next,else,endselect,endclass,".indexOf(","+l.label+",")&&0==d&&(e+=";"))),"forto"!=o||"<br>"!=s.type&&"<note>"!=s.type&&"<asp>"!=s.type||"to"==l.label?"selectcase"!=p||"<br>"!=s.type&&"<note>"!=s.type&&"<asp>"!=s.type||"selectcase"==l.label?!d||"<br>"!=s.type&&"<note>"!=s.type&&"<asp>"!=s.type||(")"!=i.label&&(e+=")"),e+="{",n=d=!1):(p="",")"!=i.label&&(e+=")"),e+="{"):(e+="$"+u+f,u=o="",")"!=i.label&&(e+=")"),e+="{"),"<br>"==l.type&&(h=!1,t+=e,e="")}return t+e},this.getAddFenHao=function(t,e,l){return("<br>"==e.type||"<note>"==e.type||"<asp>"==e.type)&&"{"!=t.substr(t.length-1,1)||l&&"else"==e.label?";":""},this.aspBeautify=function(){for(var t=0;t<=this.aspArr.length-1;t++){var e=this.aspArr[t];if("class"==e.label)t<this.aspArr.length&&(l=this.aspArr[t+1],this.phpPublicObjectList+=l.label+",",this.phpPublicFunList+=l.label+",");else if("then"==e.label){var l={};if("<br>"!=(l=t<this.aspArr.length-1?this.aspArr[t+1]:l).type&&"<note>"!=l.type&&"<asp>"!=l.type)for(var i=t+1;i<=this.aspArr.length-1;i++)--this.aspArr[i].lv}else if("sub"==e.label||"function"==e.label)t<this.aspArr.length-1&&(l=this.aspArr[t+1],this.phpPublicFunList+=l.label+",");else if("do"==e.label){if("<br>"==(l=this.aspArr[t+1]).type)for(i=t+1;i<=this.aspArr.length-1;i++)(e=this.aspArr[i]).lv++}else"echo"==e.label?e.label=e.html="aspEcho":"die"==e.label?e.label=e.html="aspDie":"print"==e.label&&(e.label=e.html="aspPrint")}if(""!=this.phpPublicFunList)for(var s=","+this.phpPublicFunList+",",t=0;t<=this.aspArr.length-1;t++)"<var>"==(e=this.aspArr[t]).type&&-1!=s.indexOf(","+e.label+",")&&(e.type="<fun>")},this.debug=function(){console.log(this.aspArr)}},_xytasp=new _XIYUETAASP;xiyuetaASP=$xytasp=$asp=function(t){return{parse:function(t){return _xytasp.aspParse(t),this},beautify:function(){return _xytasp.aspBeautify(t),this},tophp:function(t){return this.beautify(),((t=null==t?!1:t)?'<?PHP include_once "ASP.php" ?>\n':"")+_xytasp.tophp()},debug:function(t){return _xytasp.debug(t)}}};var _XIYUETA=function(t){"use strict";this.htmlSource=t=null==t?"":t,this.htmlArr=[],this.lv=0,this.common=new XiyuetaCommon,this.config={version:"1.3.1",httpurl:"",serverurl:"/api/downWeb/default.asp",jsdir:"js/",cssdir:"css/",imagesdir:"images/"},this.tplConfig={type:"xiyuetacms",item:4},this.parseHTML=function(t){null!=t&&(this.htmlSource=t,this.htmlArr=[]);for(var e="",l="",i="",s="",r=!1,n=!1,a=!1,h=!1,o=!1,u=0,f=0;f<=this.htmlSource.length-1;f++){var p,m,c,e=this.htmlSource.substr(f,1);r?(i+=e,h?">"==e&&"--\x3e"==i.substr(-3,3)&&(a=r=h=!1,this.htmlArr.push({lv:u+1,label:"!--",upHtml:s,downHtml:"",html:i,tagpair:1}),s=i=""):n&&"\x3c!--"==i?h=!0:o?">"==e&&"%>"==i.substr(-2,2)&&(a=r=o=!1,this.htmlArr.push({lv:u+1,label:"<%",upHtml:s,downHtml:"",html:i,tagpair:1}),s=i=""):n&&"<%"==i?o=!0:-1!=" \n\t".indexOf(e)&&n?n=!1:">"==e&&(r=n=!1,p=2,"/"==l.substr(0,1)?a=!0:(u++,"/"!=l.substr(-1,1)&&-1=="|br|hr|img|link|meta|param|input|!doctype|rect|line|col|".indexOf("|"+l.toLowerCase()+"|")||(a=!0,p=1,l=l.replace(/\//g,"").trim())),c=l.toLowerCase(),this.htmlArr.push({lv:u,label:c,upHtml:s,downHtml:"",html:i,tagpair:p}),s=i="",a&&(u--,a=!1),"script"==c?(m=this.htmlSource.substr(f+1).toLowerCase().indexOf("<\/script>"),i=this.htmlSource.substr(f+1,m),f+=m):"style"==c?(m=this.htmlSource.substr(f+1).toLowerCase().indexOf("</style>"),i=this.htmlSource.substr(f+1,m),f+=m):"textarea"==c?(m=this.htmlSource.substr(f+1).toLowerCase().indexOf("</textarea>"),i=this.htmlSource.substr(f+1,m),f+=m):"pre"==c&&(m=this.htmlSource.substr(f+1).toLowerCase().indexOf("</pre>"),i=this.htmlSource.substr(f+1,m),f+=m)),n&&(l+=e)):"<"==e?(c=this.htmlSource.substr(f+1,1).toLowerCase(),-1!="abcdefghijklmnopqrstuvwxyz!/%?".indexOf(c)?(s=i,i=e,a=!(n=r=!0),l=""):i+=e):i+=e}""!=i&&this.htmlArr.push({lv:u,label:"",upHtml:"",downHtml:"",html:i}),this.lv=u},this.handleLabelParam=function(t,e,l){if(null==l){if(null!=t[e])return t[e]}else l=l.toString();for(var i=!1,s="",r="",n=!1,a="",h=!1,o=!0,u=0,f=0,p=!1,m=t.label.length+1;m<=t.html.length-1;m++){var c,g=t.html.substr(m,1);if(n)if(h)if(p)">"==g&&(p=!1),r+=g;else if(g==a||">"==g){var d,s=s.toLowerCase();if(t[s]=r,h=n=!1,a="",e==s)return null==l?r:(""==l?(b=t.html.substr(0,f-1),x=t.html.substr(m+1),t.html=b+x):(y=(d=u)+r.length,o&&(d++,y++),b=t.html.substr(0,d),x=t.html.substr(y),t.html=b+l+x),t[s]=l,t);else if(">"==g&&null!=l)return""!=l&&(t.html=t.html.substr(0,t.html.length-1)+" "+e+'="'+l+'">'),t[e]=l,!0}else"<"==g&&(p=!0),r+=g;else'"'==g||"'"==g?(a=g,u=m,o=h=!0):" "!=g&&(a=" ",u=m,r=g,o=!(h=!0));else if(">"==g){if(null!=l)return""!=l&&(t.html=t.html.substr(0,t.html.length-1)+" "+e+'="'+l+'">'),t[e]=l,!0;if(e==(s=s.trim()))return null!=l&&(c=f+s.length,b=t.html.substr(0,c),x=t.html.substr(c),t.html=b+'="'+l+'"'+x),""}else if(i)if("="==g){if(-1!=(s=s.trim()).indexOf(" ")){var b,x,y=s.split(" ");if(e==(s=y[0]))return null!=l&&(b=t.html.substr(0,c),x=t.html.substr(c),t.html=b+'="'+l+'"'+x),""}n=!(i=!1),a=r=""}else s+=g;else" "!=g&&(i=!0,s=g,f=m)}},this.getDocument=function(t,e,l,i){if(null==t&&(t=""),null==i&&(i=!1),0==this.htmlArr.length)return console.log("%c 需要先解析一段html文本","font-size:14px;color:#FF3300"),"";if(-1!=t.indexOf(",")){for(var s="",r=t.split(","),n=0;n<=r.length-1;n++)s+=h=this.getDocument(r[n],e,l,i);for(var a="",r=s.split(","),n=0;n<=r.length-1;n++){var h=r[n];-1==(","+a+",").indexOf(","+h+",")&&(""!=a&&(a+=","),a+=h)}return a=""!=a?","+a:a}if(""==(t=t.trim()))return"";null==e&&(e=0),null==l&&(l=this.htmlArr.length-1);var o=-1.1,u=-1.1,f=-1.1,p=-1.1,m="",c=!1,g="",d="",b="",x="",y="",s="";if(-1!=t.indexOf("'")||-1!=t.indexOf('"')||-1!=t.indexOf("(")){for(var v=!1,s="",n=0;n<=t.length;n++){h=t.substr(n,1);0!=v||"'"!=h&&'"'!=h&&"("!=h&&")"!=h?1==v&&(" "==h?h="-Space-":"'"!=h&&'"'!=h&&"("!=h&&")"!=h||(v=!1,"'"!=h&&'"'!=h||(h=""))):(v=!0,"'"!=h&&'"'!=h||(h="")),s+=h}t=s}var C,A,L,O,w=t.indexOf(" ");if(-1!=w&&(g=t.substr(w+1).trim(),t=t.substr(0,w)),-1!=(w=t.indexOf(":"))&&(A=C="",L=(h=t.substr(w+1)).indexOf("("),O=h.indexOf(")"),-1!=L&&-1!=O?(C=h.substr(0,L).toLowerCase(),O=(A=h.substr(L+1)).indexOf(")"),A=A.substr(0,O).replace(/-Space-/g," ").trim()):C=h.toLowerCase(),"first"==C?o=0:"last"==C?o=-1:"even"==C?u=1:"odd"==C?u=0:"eq"==C?(o=0,(o=""!=A?parseInt(A):o)+""=="NaN"&&(o=-.1,t="")):"gt"==C?""!=A&&(f=parseInt(A)):"lt"==C?""!=A&&(p=parseInt(A)):"header"==C?c=!0:"contains"==C?m=A:console.log(t,"没有动作 "+C),""==(t=t.substr(0,w))&&-.1!=o&&(t="*")),-1!=(w=t.indexOf("["))&&(O=(h=t.substr(w+1)).indexOf("]"),-1==(h=h.substr(0,O)).indexOf("=")?(d=h,b="*"):(d=(H=h.split("="))[0],b=H[1].replace(/-Space-/g," "),H=d.substr(d.length-1),-1!="!^$*~|".indexOf(H)&&(d=d.substr(0,d.length-1),x=H)),-1!=d.indexOf("|")&&(d=(_=d.split("|"))[0],"NOUL"==_[1]&&(b=b.toLowerCase(),y=_[1])),""==(t=t.substr(0,w))&&(t="*")),"#"==t.substr(0,1)){if(0<o)return"";o=0}var _,H="";if(0<=(w=t.substr(1).lastIndexOf("."))&&(t=(_=t).substr(0,w+1),H=_.substr(w+2)),""!=(s=this.serchDocument(t,e,l,d,b,x,y,H))&&-1.1!=o){r=s.split(",");""!=(s=o<0?r[r.length+o]:r[o+1])&&(s=","+s)}else if(""!=s&&-1.1!=u){r=s.split(",");s="";for(n=1;n<=r.length-1;n++)n%2==u&&(s+=","+r[n])}else if(""!=s&&-1.1!=f){r=s.split(",");s="";for(n=f+2;n<=r.length-1;n++)s+=","+r[n]}else if(""!=s&&-1.1!=p){r=s.split(",");s="",p>r.length-1&&(p=r.length-1);for(n=1;n<=p;n++)s+=","+r[n]}else if(""!=s&&""!=m){r=s.split(",");s="";for(n=1;n<=r.length-1;n++)-1!=(h=r[n]).indexOf("|")&&(this.domList=","+h,-1!=this.getText("").indexOf(m)&&(s+=","+r[n]))}else if(c)for(s="",r="h1,h2,h3,h4,h5,h6,,h7,h8,h9".split(","),n=0;n<=r.length-1;n++)s+=h=this.getDocument(t+" "+r[n],e,l,i);if(""!=g&&""!=s){r=s.split(",");s="";for(var S,n=1;n<=r.length-1;n++)-1!=(h=r[n]).indexOf("|")&&(S=h.split("|"),e=parseInt(S[0])+1,l=parseInt(S[1])-1,s+=this.getDocument(g,e,l,!0))}if(0==i){r=s.split(",");s="";for(n=1;n<=r.length-1;n++){h=r[n];-1==(","+s+",").indexOf(","+h+",")&&(s+=","+h)}}return s},this.serchDocument=function(t,e,l,i,s,r,n,a){null==i&&(i=""),null==s&&(s=""),null==r&&(r=""),null==n&&(n=""),null==a&&(a="");for(var h=!1,o="",u=0,f=0,p=!1,m=e;m<=l;m++){var c,g,d=this.htmlArr[m];null!=d&&(h&&this.checkEndSelector(d,t)&&u==d.lv?(p&&(o+="|"+m),p=h=!1,o+=this.serchDocument(t,f+1,m,i,s,r,n,a)):this.checkStartSelector(d,t,a)&&0==h&&(2==d.tagpair&&(h=!0,u=d.lv),f=m,c=!0,""!=i&&(g=this.handleLabelParam(d,i),"NOUL"==n&&null!=g&&(g=g.toLowerCase()),"^"==r?null!=g&&g.substr(0,s.length)==s||(c=!1):"|"==r?null!=g&&(g+"-").substr(0,s.length+1)==s+"-"||(c=!1):"$"==r?null!=g&&g.substr(-1*s.length)==s||(c=!1):"~"==r?null!=g&&-1!=(" "+g+" ").indexOf(" "+s+" ")||(c=!1):"*"==r?null!=g&&-1!=g.indexOf(s)||(c=!1):"!"==r?g==s&&(c=!1):null!=g&&"*"==s?c=!0:g!=s&&(c=!1)),c&&(o+=","+m,2==d.tagpair&&(p=!0))))}return o},this.checkStartSelector=function(t,e,l){if(""==t.label)return!1;var i=e+" ",s=t.label.substr(0,1),r=e.substr(0,1);if("/"==s)return!1;{if("*"==r)return""==l||null!=(a=this.handleLabelParam(t,"class"))&&-1!=(" "+a+" ").indexOf(" "+l+" ");if("#"==r){var n=e.substr(1,i.indexOf(" ")-1),s=this.handleLabelParam(t,"id");if(s==n)return""==l||null!=(a=this.handleLabelParam(t,"class"))&&-1!=(" "+a+" ").indexOf(" "+l+" ")}else if("."==r){var n=e.substr(1,i.indexOf(" ")-1),a=" "+this.handleLabelParam(t,"class")+" ";if(-1!=a.indexOf(" "+n+" "))return""==l||null!=(a=this.handleLabelParam(t,"class"))&&-1!=(" "+a+" ").indexOf(" "+l+" ")}else if(t.label+" "==e.substr(0,t.label.length+1)+" ")return""==l||null!=(a=this.handleLabelParam(t,"class"))&&-1!=(" "+a+" ").indexOf(" "+l+" ")}return!1},this.checkEndSelector=function(t,e){t.label.substr(0,1);var l=e.substr(0,1);return"*"==l||("#"==l||"."==l||t.label=="/"+e.substr(0,t.label.length-1))},this.getText=function(t,e,l){t="object"==typeof t?(this.domList=","+t.x,t.x!=t.y&&(this.domList+="|"+t.y),""):t.trim();for(var i="",s=this.domList,r=(s=null==this.domList?this.getDocument(t,e,l):s).split(","),n=1;n<=r.length-1;n++)if(-1!=(s=r[n]).indexOf("|"))for(var a=s.split("|"),h=parseInt(a[0])+1;h<=a[1];h++)null!=this.htmlArr[h]&&(i+=this.htmlArr[h].upHtml);return i},this.getHtml=function(t,e,l,i){""!=(i=null==i?"":i)&&(i="|"+i+"|"),t="object"==typeof t?(this.domList=","+t.x,t.x!=t.y&&(this.domList+="|"+t.y),""):t.trim();var s="",r=this.domList,t=(r=null==this.domList?this.getDocument(t,e,l):r).split(",");if(!(t.length<2)){if(-1!=(r=t[1]).indexOf("|"))for(var t=r.split("|"),e=parseInt(t[0]),l=parseInt(t[1]),n=e;n<=l;n++){var a=this.htmlArr[n];a&&(e<n&&-1==i.indexOf("doc")&&(s+=a.upHtml),-1!=i.indexOf("all")?-1!=i.indexOf("label")?s+="<"+a.label+">":s+=a.html:e<n&&n<l&&(-1!=i.indexOf("doc")&&"!--"!=a.label?-1!=i.indexOf("label")?s+="<"+a.label+">":s+=a.html:""==i&&(s+=a.html)))}else""!=r&&-1!=i.indexOf("all")&&(-1!=i.indexOf("label")?s+="<"+a.label+">":s=this.htmlArr[r].html);return s}},this.setHtml=function(t,e,l,i,s){"object"==typeof t?r=","+t.x+"|"+t.y:(r=this.domList,null==this.domList&&(r=this.getDocument(t,e,l)));for(var r,n=r.split(","),a=1;a<=n.length-1;a++)if(-1!=(r=n[a]).indexOf("|"))for(var h=r.split("|"),e=parseInt(h[0]),l=parseInt(h[1]),o=e;o<=l;o++){var u=this.htmlArr[o];u&&(o==e?"all"==s&&(u.html=""):o<l?delete this.htmlArr[o]:o==l&&(u.upHtml=i,"all"==s&&(u.html="")))}return this},this.handleCssParam=function(t,e,l){var i,s;if(null==l){var r,n="a{"+(r=null==(r=this.attr(t,i,s,"style"))?"":r)+"}";return $xytcss("a").parse(n).css(e)}l=l.toString();n="a{"+(r=null==(r=this.attr(t,i,s,"style"))?"":r)+"}",$xytcss("a").parse(n).css(e,l),l=(l=$xytcss().print()).substr(2,l.length-3).trim();this.attr(t,i,s,"style",l)},this.css=function(t,e,l,i,s){if("object"==typeof i){for(var r in i)this.css(t,e,l,r,i[r]);return this}if(""==(i=(i=null==i?"":i).trim()))return"";if("object"==typeof t)return null==s?this.handleCssParam(t,i):this.handleCssParam(t,i,s);var n=this.domList,a=(n=null==this.domList?this.getDocument(t,e,l):n).split(",");if(null==s){if(null==(n=a[1]))return;var h=n.split("|"),o=this.htmlArr[h[0]];return n=this.handleCssParam(o,i)}for(var u=1;u<=a.length-1;u++)o=-1!=(n=a[u]).indexOf("|")?(h=n.split("|"),this.htmlArr[h[0]]):this.htmlArr[n],this.handleCssParam(o,i,s)},this.attr=function(t,e,l,i,s){if("object"==typeof i){for(var r in i)this.attr(t,e,l,r,i[r]);return this}if(""==(i=(i=null==i?"":i).trim()))return"";if("object"==typeof t)return null==s?this.handleLabelParam(t,i):this.handleLabelParam(t,i,s);var n=this.domList,a=(n=null==this.domList?this.getDocument(t,e,l):n).split(",");if(null==s){if(null==(n=a[1]))return;var h=n.split("|"),o=this.htmlArr[h[0]];return n=this.handleLabelParam(o,i)}for(var u=1;u<=a.length-1;u++)o=-1!=(n=a[u]).indexOf("|")?(h=n.split("|"),this.htmlArr[h[0]]):this.htmlArr[n],this.handleLabelParam(o,i,s)},this.val=function(t,e,l,i){"object"==typeof t?h=","+t.x+"|"+t.y:(h=this.domList,null==this.domList&&(h=this.getDocument(t,e,l)));var s=h.split(",");if(null==i){if(null==(h=s[1]))return"";var r=h.split("|");if("textarea"==(c=this.htmlArr[r[0]]).label)return c.x=r[0],c.y=r[1],this.getHtml(c);if("select"!=c.label)return this.handleLabelParam(c,"value");if(""==(o=this.getDocument("option",c.x,c.y)))return;for(var n=o.split(","),a=1;a<=n.length-1;a++)-1!=(f=n[a]).indexOf("|")&&(p=f.split("|"),m=this.htmlArr[p[0]],null==this.handleLabelParam(m,"selected")&&null!=u||(u=this.handleLabelParam(m,"value")));return u}for(var h,a=1;a<=s.length-1;a++)if(-1!=(h=s[a]).indexOf("|")){var o,r=h.split("|");if("textarea"==(c=this.htmlArr[r[0]]).label)c.x=r[0],c.y=r[1],this.setHtml(c,void 0,void 0,i);else if("select"==c.label){if(""!=(o=this.getDocument("option",c.x,c.y)))for(var u,f,p,m,n=o.split(","),a=1;a<=n.length-1;a++)-1!=(f=n[a]).indexOf("|")&&(p=f.split("|"),m=this.htmlArr[p[0]],this.handleLabelParam(m,"value")==i?this.handleLabelParam(m,"selected","selected"):this.handleLabelParam(m,"selected",null))}else this.handleLabelParam(c,"value",i)}else{var c=this.htmlArr[h];this.handleLabelParam(c,"value",i)}return""},this.each=function(t,e,l,i){var s=[];t=t.trim();for(var r,n,a=this.domList,h=(a=null==this.domList?this.getDocument(t,e,l):a).split(","),o=1;o<=h.length-1;o++)-1!=(a=h[o]).indexOf("|")?(r=a.split("|"),(n=this.htmlArr[r[0]]).x=parseInt(r[0]),n.y=parseInt(r[1])):((n=this.htmlArr[a]).x=parseInt(a),n.y=parseInt(a)),s.push(n);if("object"==typeof s)for(var o=0,u=s.length;o<u&&0!=i.call(s[o],o,s[o]);o++);},this.remove=function(t,e,l){if("object"==typeof t?r=","+t.x+"|"+t.y:(r=this.domList,null==this.domList&&(r=this.getDocument(t,e,l))),""==r)return!1;for(var i=r.split(","),s=1;s<=i.length-1;s++){var r=i[s];if(-1!=r.indexOf("|"))for(var n,a=r.split("|"),e=parseInt(a[0]),l=parseInt(a[1]),h=e;h<=l;h++)(n=this.htmlArr[h])&&(h==e?(n.html="",n.label=""):delete this.htmlArr[h]);else(n=this.htmlArr[r])&&(n.html="",n.label="")}return!0},this.addClass=function(t,e,l,i){if(null==i)return!1;if(""==(i=i.trim()))return!1;var s=i.split(" ");"object"==typeof t?a=","+t.x+"|"+t.y:(a=this.domList,null==this.domList&&(a=this.getDocument(t,e,l)));for(var r=a.split(","),n=1;n<=r.length-1;n++){for(var a,h=(a=r[n]).split("|"),h=this.htmlArr[h[0]],o=null!=(o=this.attr(h,e,l,"class"))?o.trim():"",u=0;u<=s.length-1;u++)""!=s[u]&&(""!=o&&(o+=" "),o+=s[u]);this.attr(h,e,l,"class",o)}},this.removeClass=function(t,e,l,i){if(null==i)return!1;if(""==(i=i.trim()))return!1;var s=i.split(" ");"object"==typeof t?a=","+t.x+"|"+t.y:(a=this.domList,null==this.domList&&(a=this.getDocument(t,e,l)));for(var r=a.split(","),n=1;n<=r.length-1;n++){var a,h=(a=r[n]).split("|"),h=this.htmlArr[h[0]];if(null!=(o=this.attr(h,e,l,"class"))){for(var o=" "+(o=o.trim())+" ",u=0;u<=s.length-1;u++)""!=s[u]&&(o=o.replace(" "+s[u]+" "," "));this.attr(h,e,l,"class",o.trim())}}},this.wrap=function(t,e,l,i,s){t="object"==typeof t?(this.domList=","+t.x,t.x!=t.y&&(this.domList+="|"+t.y),""):t.trim();for(var r,n=this.domList,a=(n=null==this.domList?this.getDocument(t,e,l):n).split(","),h=1;h<=a.length-1;h++)-1!=(n=a[h]).indexOf("|")?(r=n.split("|"),this.htmlArr[r[0]].upHtml+=i,this.htmlArr[r[1]].downHtml+=s):(this.htmlArr[n].upHtml+=i,this.htmlArr[n].downHtml+=s);return this},this.unwrap=function(t,e,l){t="object"==typeof t?(this.domList=","+t.x,t.x!=t.y&&(this.domList+="|"+t.y),""):t.trim();for(var i=this.domList,s=(i=null==this.domList?this.getDocument(t,e,l):i).split(","),r=1;r<=s.length-1;r++){var n,a=.1,h=0,o=0;-1!=(i=s[r]).indexOf("|")?(n=i.split("|"),a=this.htmlArr[n[0]].lv-1,h=parseInt(n[0]),o=parseInt(n[1])):(a=(f=this.htmlArr[i]).lv-1,h=o=parseInt(i));for(var u=h;0<=u;u--){var f=this.htmlArr[u];if("object"==typeof f&&this.htmlArr[u].lv==a){f.html="";break}}for(u=o;u<=this.htmlArr.length-1;u++){f=this.htmlArr[u];if("object"==typeof f&&this.htmlArr[u].lv==a){f.html="";break}}}return this},this.append=function(t,e,l,i){t="object"==typeof t?(this.domList=","+t.x,t.x!=t.y&&(this.domList+="|"+t.y),""):t.trim();for(var s,r=this.domList,n=(r=null==this.domList?this.getDocument(t,e,l):r).split(","),a=1;a<=n.length-1;a++)-1!=(r=n[a]).indexOf("|")?(s=r.split("|"),this.htmlArr[s[1]].upHtml+=i):this.htmlArr[r].downHtml+=i;return this},this.prepend=function(t,e,l,i){t="object"==typeof t?(this.domList=","+t.x,t.x!=t.y&&(this.domList+="|"+t.y),""):t.trim();for(var s,r=this.domList,n=(r=null==this.domList?this.getDocument(t,e,l):r).split(","),a=1;a<=n.length-1;a++)-1!=(r=n[a]).indexOf("|")?(s=r.split("|"),this.htmlArr[s[0]].html+=i):this.htmlArr[r].html+=i;return this},this.after=function(t,e,l,i){t="object"==typeof t?(this.domList=","+t.x,t.x!=t.y&&(this.domList+="|"+t.y),""):t.trim();for(var s,r=this.domList,n=(r=null==this.domList?this.getDocument(t,e,l):r).split(","),a=1;a<=n.length-1;a++)-1!=(r=n[a]).indexOf("|")?(s=r.split("|"),this.htmlArr[s[1]].downHtml+=i):this.htmlArr[r].downHtml+=i;return this},this.before=function(t,e,l,i){t="object"==typeof t?(this.domList=","+t.x,t.x!=t.y&&(this.domList+="|"+t.y),""):t.trim();for(var s,r=this.domList,n=(r=null==this.domList?this.getDocument(t,e,l):r).split(","),a=1;a<=n.length-1;a++)-1!=(r=n[a]).indexOf("|")?(s=r.split("|"),this.htmlArr[s[0]].upHtml+=i):this.htmlArr[r].upHtml+=i;return this},this.show=function(){for(var t=this.domList.split(","),e=1;e<=t.length-1;e++){var l,i=t[e];-1!=i.indexOf("|")?(l=i.split("|"),this.css(l[0],0,0,"display","")):this.css(i,0,0,"display","")}return this},this.hide=function(){for(var t=this.domList.split(","),e=1;e<=t.length-1;e++){var l,i=t[e];-1!=i.indexOf("|")?(l=i.split("|"),this.css(l[0],0,0,"display","none")):this.css(i,0,0,"display","none")}return this},this.slice=function(t,e,l,i,s){if(null==i&&null==s)return t;var r=t.split(",");if(i=isNaN(i)?0:parseInt(i),null==s?s=r.length:isNaN(s)?s=-1:(s=parseInt(s))<0&&(s=r.length-1- -1*s),i+""=="NaN"||s+""=="NaN")return t;for(var n="",a=1;a<=r.length-1;a++)i<=a&&a<=s&&(n+=","+r[a]);return n},this.printHTML=function(t){for(var e="",l=0,i=0;i<=this.htmlArr.length-1;i++){var s,r,n,a,h=this.htmlArr[i];h&&(h.id=i,"format"==t?(s=h.upHtml.trim(),r=h.downHtml.trim(),n=h.html.trim(),"html"==h.label?l=-1:"head"!=h.label&&"body"!=h.label||(s+="\n"),""!=n&&(a=!0,2==h.tagpair?"/"==h.label.substr(0,1)&&(a=this.upCheckThisLabel(h)):-1!="|br|hr|rect|line|col|".indexOf("|"+h.label+"|")&&(a=!1),a&&(n="\n"+this.common.copyStr("    ",h.lv-1+l)+n)),e+=s+n+r):e+="zip"==t?h.upHtml.trim()+h.html.trim()+h.downHtml.trim():h.upHtml+h.html+h.downHtml)}return e="format"==t?e.trim():e},this.upCheckThisLabel=function(t){if("/head"==t.label||"/body"==t.label)return!0;for(var e=t.id-1;0<=e;e--){var l=this.htmlArr[e];if(l){if(l.lv==t.lv)return!1;if(2==l.tagpair||"img"==l.label)return!0;if(-1!=(l.upHtml+l.downHtml).indexOf("\n"))return!0}}return!1},this.debug=function(t){((t=null==t?!1:t)?xiyueta:console).log(this.htmlArr)},this.info=function(){console.log("%c xiyueta%c v"+_xyt.config.version+" website: www.xiyueta.com ","font-size:22px;color:#00bbee","color:#000")}},_xyt=new _XIYUETA,xiyueta=function(t,e,l){return new xiyueta.fn.init(t,e,l)};function XiyuetaCommon(){this.copyStr=function(t,e){for(var l="",i=1;i<=e;i++)l+=t;return l},this.bystesLength=function(t){for(var e=0,l=0;l<t.length;l++)255<t.charCodeAt(l)?e+=2:e++;return e},this.getFileSize=function(t){return t<1048576?(t/1024).toFixed(2)+"KB":1048576==t?"1MB":1048576<t&&t<1073741824?(t/1048576).toFixed(2)+"MB":1048576<t&&1073741824==t?"1GB":1073741824<t&&t<1099511627776?(t/1073741824).toFixed(2)+"GB":"文件超过1TB"}}xiyueta.fn=xiyueta.prototype={length:1,selector:"",domList:void 0,x:null,y:null},xiyueta.extend=xiyueta.fn.extend=function(){var t,e,l,i=arguments[0]||{},s=1,r=arguments.length;for(s===r&&(i=this,s--);s<r;s++)if(null!=(t=arguments[s]))for(e in t)l=t[e],"__proto__"!==e&&i!==l&&void 0!==l&&(i[e]=l);return i},(init=xiyueta.fn.init=function(t,e,l){this.length=0,this.selector=t,this.domList=void 0,this.x=e,this.y=l,0<_xyt.htmlArr.length&&("string"==typeof t?(l=(e=_xyt.getDocument(t,e,l)).split(","),this.length=l.length-1,this.domList=e):"#object"==typeof t&&(this.domList=","+t.x,t.x!=t.y&&(this.domList+="|"+t.y),this.selector="")),_xyt.domList=this.domList,null==this.selector&&(this.selector="")}).prototype=xiyueta.fn,($=$xyt=xiyueta).log=function(t,e){if(null==e&&(e="<br>"),"object"==typeof t)for(var l in t){var i;-1==(t[l]+"").indexOf("function")&&(i=(i=t[l]+"").replace(/</g,"&lt;").replace(/\n/g,"<br>").replace(/ /g,"&nbsp;"),void 0===(i="object"==typeof t[l]?xiyueta.log(t[l]," , "):i)?document.write(l+e):document.write(l+":  "+i+e))}else t+="",document.write(t.replace(/</g,"&lt;").replace(/\n/g,"<br>").replace(/ /g,"&nbsp;")+e)},xiyueta.fn.extend({parse:function(t,e){var l;return _xyt.parseHTML(t),1!=(e=null==e&&0!=_xyt.lv?!0:e)||0<(l=this.repair(!1)).err&&""!=l.errList&&1==l.state&&(_xyt.parseHTML(this.print()),this.repairHTML=!0),0<_xyt.htmlArr.length&&"string"==typeof this.selector&&(l=(e=_xyt.getDocument(this.selector,this.x,this.y)).split(","),this.length=l.length-1,_xyt.domList=this.domList=e),this},find:function(t){if("string"==typeof this.selector&&""!=this.selector){for(var e=this.selector.split(","),l="",i=0;i<=e.length-1;i++)""!=l&&(l+=","),l+=e[i]+" "+t;this.selector=l;var s=_xyt.getDocument(this.selector,this.x,this.y),e=s.split(",");this.length=e.length-1,this.domList=s,_xyt.domList=this.domList}else"object"==typeof this.selector&&(this.x=this.selector.x+1,this.y=this.selector.y-1,this.selector=t);return this},text:function(t){return null!=t?(t=t.replace(/</g,"&lt;").replace(/>/g,"&gt;"),_xyt.setHtml(this.selector,this.x,this.y,t),this):_xyt.getText(this.selector,this.x,this.y)},html:function(t,e){return null!=t?(_xyt.setHtml(this.selector,this.x,this.y,t,e),this):_xyt.getHtml(this.selector,this.x,this.y,e)},attr:function(t,e){return null==e&&"object"!=typeof t?_xyt.attr(this.selector,this.x,this.y,t):(_xyt.attr(this.selector,this.x,this.y,t,e),this)},val:function(t){return null==t?_xyt.val(this.selector,this.x,this.y):(_xyt.val(this.selector,this.x,this.y,t),this)},remove:function(){return _xyt.remove(this.selector,this.x,this.y),this},each:function(t){return _xyt.each(this.selector,this.x,this.y,t)},css:function(t,e){return null==e&&"object"!=typeof t?_xyt.css(this.selector,this.x,this.y,t):(_xyt.css(this.selector,this.x,this.y,t,e),this)},print:function(t){return _xyt.printHTML(t)},debug:function(t){return _xyt.debug(t),this}}),xiyueta.fn.extend({eq:function(t){null==t||""==t?t=0:(t=parseInt(t))+""=="NaN"&&(t=-1.1);var e,l="";return-1.1==t?(this.selector="",this.length=0):(e=this.domList.split(","),0<=t?t++:t=e.length+t,l=e[t],this.length=1,(this.selector="")!=l&&(l=","+l)),_xyt.domList=this.domList=l,this},first:function(){return this.eq(0),this},last:function(){return this.eq(-1),this},even:function(){for(var t=this.domList.split(","),e="",l=1;l<=t.length-1;l++)l%2==1&&(e+=","+t[l]);return _xyt.domList=this.domList=e,this},odd:function(){for(var t=this.domList.split(","),e="",l=1;l<=t.length-1;l++)l%2==0&&(e+=","+t[l]);return _xyt.domList=this.domList=e,this},slice:function(t,e){return _xyt.domList=this.domList=_xyt.slice(this.domList,this.x,this.y,t,e),-1!=this.domList.indexOf(",")?(e=this.domList.split(","),this.length=e.length-1):this.length=0,this},addClass:function(t){return _xyt.addClass(this.selector,this.x,this.y,t),this},removeClass:function(t){return _xyt.removeClass(this.selector,this.x,this.y,t),this},wrap:function(t){var e=new _XIYUETA,l=0;e.parseHTML(t),e.repairHTML(!1);var i=e.printHTML();t!=i&&e.parseHTML(i);for(var s=0;s<=e.htmlArr.length-1;s++)(h=e.htmlArr[s]).lv>l&&2==h.tagpair&&(l=h.lv);for(var r="",n="",a=!1,s=0;s<=e.htmlArr.length-1;s++){var h,o=(h=e.htmlArr[s]).upHtml;"/"==h.label.substr(0,1)&&h.lv==l&&(a=!0,r+=o,o=""),0==a?r+=o+h.html:n+=o+h.html}return _xyt.wrap(this.selector,this.x,this.y,r,n),this},unwrap:function(){return _xyt.unwrap(this.selector,this.x,this.y),this},append:function(t){return _xyt.append(this.selector,this.x,this.y,t),this},prepend:function(t){return _xyt.prepend(this.selector,this.x,this.y,t),this},after:function(t){return _xyt.after(this.selector,this.x,this.y,t),this},before:function(t){return _xyt.before(this.selector,this.x,this.y,t),this},show:function(){return _xyt.show(this.selector),this},hide:function(){return _xyt.hide(this.selector),this},htmlwrap:function(t){return null!=t?(_xyt.setHtml(this.selector,this.x,this.y,t,"all"),this):_xyt.getHtml(this.selector,this.x,this.y,"all")},dom:function(t){return _xyt.getHtml(this.selector,this.x,this.y,"doc|"+t)},domwrap:function(){return _xyt.getHtml(this.selector,this.x,this.y,"doc|all")},domlabel:function(t){return _xyt.getHtml(this.selector,this.x,this.y,"doc|label|"+t)},domlabelwrap:function(){return _xyt.getHtml(this.selector,this.x,this.y,"doc|all|label")},lv:function(){return _xyt.lv}}),_XIYUETA.prototype.swap=function(t,e){if(null==t||null==e)return!1;t=this.getDocument(t),e=this.getDocument(e);if(""==t||""==e)return!1;if(-1==(t=t.split(",")[1]).indexOf("|"))var l=this.htmlArr[t];else{for(var i=t.split("|"),l=this.htmlArr[i[0]],s="",r=parseInt(i[0])+1;r<=i[1];r++)null!=(a=this.htmlArr[r])&&(s+=a.upHtml+a.html,delete this.htmlArr[r]);l.html+=s}if(-1==(e=e.split(",")[1]).indexOf("|"))var n=this.htmlArr[e];else{for(var a,i=e.split("|"),n=this.htmlArr[i[0]],s="",r=parseInt(i[0])+1;r<=i[1];r++)null!=(a=this.htmlArr[r])&&(s+=a.upHtml+a.html,delete this.htmlArr[r]);n.html+=s}e=l.html;return l.html=n.html,n.html=e,!0},_XIYUETA.prototype.getItem=function(t,e,l,i){null==i&&(i="");for(var s=[],r=(f=this.getDocument(t,e,l)).split(","),n=1;n<=r.length-1;n++)if(-1!=(f=r[n]).indexOf("|")){var a=f.split("|"),h=this.htmlArr[a[0]];if(""!=i)void 0!==(f=this.handleLabelParam(h,i))&&s.push(f);else{for(var o=h.html,u=parseInt(a[0])+1;u<=a[1];u++)null!=(h=this.htmlArr[u])&&(o+=h.upHtml+h.html);""!=o&&s.push(o)}}else{var f,h=this.htmlArr[f];""!=i?void 0!==(f=this.handleLabelParam(h,i))&&s.push(f):s.push(h.html)}return s},_XIYUETA.prototype.setConfig=function(t){if(null==t)return this.config;null!=t.httpurl&&(this.config.httpurl=t.httpurl),null!=t.serverurl&&(this.config.serverurl=t.serverurl),null!=t.jsdir&&(this.config.jsdir=t.jsdir),null!=t.cssdir&&(this.config.cssdir=t.cssdir),null!=t.imagesdir&&(this.config.imagesdir=t.imagesdir)},_XIYUETA.prototype.charset=function(t){for(var e=0;e<=this.htmlArr.length-1;e++){var l=this.htmlArr[e];if(null!=l)if("meta"==l.label)if(-1!=l.html.toLowerCase().indexOf("charset=")){var i=this.handleLabelParam(l,"charset");if(null!=(i=null!=i?i.toLowerCase().trim():i))return null!=t&&this.handleLabelParam(l,"charset",t),i;if(-1!=(i=null!=(i=this.handleLabelParam(l,"content"))?i.toLowerCase().trim():i).indexOf("utf-8"))return null!=t?(this.handleLabelParam(l,"content","text/html; charset="+t),""):"utf-8";if(-1!=i.indexOf("gb2312"))return null!=t?(this.handleLabelParam(l,"content","text/html; charset="+t),""):"gb2312"}}},_XIYUETA.prototype.getHandleSrc=function(t,e,l,i){for(var s="",r=!0,n=0;n<=this.htmlArr.length-1;n++){var a,h,o,u=this.htmlArr[n];null!=u&&-1!=("|"+t+"|").indexOf("|"+u.label+"|")&&(null==(a=this.handleLabelParam(u,e))&&(a=""),"link"==u.label&&("dns-prefetch"!=(h=(h=null==(h=this.handleLabelParam(u,"rel"))?"":h).trim().toLowerCase())&&"alternate"!=h||(a="")),-1!=("|"+l+"|").indexOf("clean")?(r=!0,""!=a&&-1==a.indexOf("apps.bdimg.com/")&&(o=a=this.common.fullHttpUrl(i,a),-1!=("|"+l+"|").indexOf("web")&&""!=(a=this.common.getUrlFileName(a,u.label))&&("img"==u.label?a=this.config.imagesdir+a:"script"==u.label?a=this.config.jsdir+a:"link"==u.label?-1!=(h=(h=null==(h=this.handleLabelParam(u,"rel"))?"":h).trim().toLowerCase()).indexOf("shortcut icon")?a=this.config.imagesdir+a:-1!=h.indexOf("stylesheet")?a=this.config.cssdir+a:(a="",r=!1):(r=!1,a="")),r&&""!=a&&(-1!=("|"+l+"|").indexOf("down")?(""!=s&&(s+="[,]"),s+=o+"[|]"+a):(""!=s&&(s+="[,]"),s+=a)),this.handleLabelParam(u,e,a))):""!=a&&(""!=s&&(s+="[,]"),s+=a))}return s},_XIYUETA.prototype.replace=function(t,e,l,i){for(var s,r=this.getDocument(t),n=r.split(","),a=1;a<=n.length-1;a++)s=-1!=(r=n[a]).indexOf("|")?(s=r.split("|"),this.htmlArr[s[0]]):this.htmlArr[r],""!=e&&(r=this.handleLabelParam(s,e))==l&&this.handleLabelParam(s,e,i)},_XIYUETA.prototype.repairHTML=function(t,e){var l;null==t&&(t=!1),null==e&&(e=0);var i=0,s=!1,r="",n=0,a=",";if(1<=this.htmlArr.length&&"no"==(h=this.htmlArr[0]).isFindDom)return!1;for(var h,o=0;o<=this.htmlArr.length-1;o++)(h=this.htmlArr[o])&&(h.nIndex=o,2==h.tagpair&&("/"==h.label.substr(0,1)?(f=h.label.substr(1),-1!=(","+a+",").indexOf(","+f+",")?a=a.replace(","+f+",",","):a+=h.label+","):a+=h.label+","));for(var u=a,o=0;o<=this.htmlArr.length-1;o++)if((h=this.htmlArr[o])&&2==h.tagpair&&"/"==h.label.substr(0,1)){var f=h.label.substr(1),s=!0;if(null!=(c=this.upFindSameLvObj(o,h))&&(h.label=="/"+c.label?(s=!1,this.setNoFindDom(c.nIndex,h.nIndex),1==e&&console.log("找(Lv1) "+h.label+" "+c.label+"("+h.nIndex+"-"+c.nIndex+")")):0==this.lv||1==c.lv&&1==h.lv&&-1==a.indexOf(","+h.label+",")?1==s&&(r="",t&&(r="\x3c!--xiyueta提示: 原标签(LV) "+h.label+" 替换成 /"+c.label+"--\x3e"),h.html="</"+c.label+">"+r,i+=2,n+=2,s=!1,this.setNoFindDom(c.nIndex,h.nIndex),1!=e&&2!=e||console.log("找(Lv2) LV整体层级正确或两标签都为第一层  "+h.label+" 替换成 /"+c.label+" ("+h.nIndex+"-"+c.nIndex+")")):1==e&&console.log("找(Lv else) 没找到，交给下面找同名 "+h.label+" ("+h.nIndex+")")),1==s)if(null==(l=this.upFindSameNameObj(o,h)))h.html=t?"\x3c!---xiyueta提示: 有多余结束标签 "+h.label+" --\x3e":"",n++,i++,this.setNoFindDom(h.nIndex,h.nIndex),this.reairHtmlLv(h,1),1!=e&&2!=e||console.log(" 找(Name 出错) 有多余结束标签 "+h.label+" ("+h.nIndex+")"),s=!1,a=a.replace(","+h.label+",",",");else{r="",t&&(l.html+="\x3c!---xiyueta提示: 有问题标签开始位置--\x3e",h.html="\x3c!---xiyueta提示: 有问题标签结束位置--\x3e"+h.html),1!=e&&2!=e||console.log("找(Name2 有问题) "+h.label+" 与 "+l.label+"("+h.nIndex+"-"+l.nIndex+") 之间有问题");var m="";this.setNoFindDom(l.nIndex,h.nIndex);var c=l.lv-h.lv;this.reairHtmlLv(h,c);for(var g=l.nIndex+1;g<=h.nIndex;g++){var d=this.htmlArr[g];if("/"!=d.label.substr(0,1)&&2==d.tagpair){var b=!1;for(p=d.nIndex+1;p<=h.nIndex;p++){var x=this.htmlArr[p];if(2==x.tagpair&&"/"==x.label.substr(0,1)&&x.lv==d.lv){b=!0;break}}0==b&&(m+="</"+d.label+">",t&&(m+="\x3c!--xiyueta提示: 追加 /"+d.label+" --\x3e"),1!=e&&2!=e||console.log(" 找(Name3)  追加结束标签 /"+d.label+" ("+d.nIndex+")"),n++,i++,a=a.replace(","+d.label+",",","))}}h.upHtml+=m}}var y=a.split(",");if(y.length>i){m="";for(o=0;o<=y.length-1;o++)""!=y[o]&&"/"!=y[o].substr(0,1)&&(r="",t&&(r="\x3c!--xiyueta提示: 追加 /"+y[o]+" --\x3e"),m="</"+y[o]+">"+r+m,n++,i++,1!=e&&2!=e||console.log("最后  追加结束标签 /"+y[o]));this.htmlArr[this.htmlArr.length-1].downHtml+=m}return{lv:this.lv,err:n,repair:i,state:n==i,errList:u=","==u?"":u}},_XIYUETA.prototype.setNoFindDom=function(t,e){for(var l=t;l<=e;l++){var i=this.htmlArr[l];i&&(i.isFindDom="no")}return null},_XIYUETA.prototype.upFindSameLvObj=function(t,e){for(var l=t-1;0<=l;l--){var i=this.htmlArr[l];if(i&&"no"!=i.isFindDom&&e.lv==i.lv)return i}return null},_XIYUETA.prototype.upFindSameNameObj=function(t,e){for(var l=t-1;0<=l;l--){var i=this.htmlArr[l];if(i&&"no"!=i.isFindDom&&e.label=="/"+i.label)return i}return null},_XIYUETA.prototype.reairHtmlLv=function(t,e){for(var l=t.nIndex;l<=this.htmlArr.length-1;l++)(t=this.htmlArr[l])&&(t.lv+=e)},xiyueta.fullurl=function(t,e){return _xyt.common.fullHttpUrl(t,e)},xiyueta.getUrlFileName=function(t,e){return _xyt.common.getUrlFileName(t,e)},xiyueta.fn.extend({swap:function(t){return _xyt.swap(this.selector,t),this},item:function(t){return _xyt.getItem(this.selector,this.x,this.y,t)},config:function(t){t=_xyt.setConfig(t);return null==t?this:t},charset:function(t){return null==t?_xyt.charset():(_xyt.charset(t),this)},handle:function(t,e,l){return _xyt.getHandleSrc(this.selector,t,e,l)},replace:function(t,e,l){return _xyt.replace(this.selector,t,e,l)},clear:function(){return this},repair:function(t,e){return _xyt.repairHTML(t,e)}}),_XIYUETA.prototype.scan=function(t){t="|"+(t=null==t?"":t)+"|";var e=0,l=[],i=!1,s="",r="",n=[],a=this.charset();s+="网页编码="+(a=null==a?"":a)+"\n",s+="网页大小="+this.common.getFileSize(this.common.bystesLength(this.htmlSource))+"\n";for(var h=0;h<=this.htmlArr.length-1;h++)(p=this.htmlArr[h])&&"/"!=p.label.substr(0,1)&&""!=p.label&&(-1==("|"+r+"|").indexOf("|"+p.label+"|")?(""!=r&&(r+="|"),r+=p.label,n[p.label]=1):n[p.label]++);for(var o=r.split("|"),u="",h=0;h<=o.length-1;h++){var f=o[h];u+=f+"("+n[f]+") "}var p=this.repairHTML();s+="网页LV="+this.lv+"\n",s+="网页错误标签数="+p.err+"\n",s+="网页错误标签为="+p.errList+"\n",s+="网页错误标签是否可修复="+p.state+"\n",s+="网页类型标签数="+o.length+"种 "+u+"\n",this.config.downcss=0;for(var m=xiyueta("link[rel|NOUL=stylesheet]").item("href"),c=xiyueta("script").item("src"),h=0;h<=this.htmlArr.length-1;h++)null!=(p=this.htmlArr[h])&&("body"==p.label?(e=p.lv,i=!0):0==i&&-1!="|div|span|table|ul|".indexOf("|"+p.label+"|")?(l.push(p.html),i=!0):i&&p.lv-e==1&&2==p.tagpair&&"/"!=p.label.substr(0,1)&&"!--"!=p.label&&"script"!=p.label.substr(0,6)&&l.push(p.html),"link"==p.label&&"stylesheet"==p.rel&&(g=this.common.fullHttpUrl(this.config.httpurl,p.href),-1!=t.indexOf("|downcss|")&&null==p.content&&(this.getUrlStr(p,g),this.config.downcss++,alert("下载CSS"+g))));if(s+="共有CSS文件 "+m.length+" 条\n",s+="共有JS文件 "+c.length+" 条\n",s+="一层标签共 "+l.length+" 条\n",s+="\n",""!=m){s+="CSS列表:\n";for(h=0;h<=m.length-1;h++)s+=(g=this.common.fullHttpUrl(this.config.httpurl,m[h]))+"\n"}if(""!=c){s+="\n\nJS列表:\n";for(var g,h=0;h<=c.length-1;h++)s+=(g=this.common.fullHttpUrl(this.config.httpurl,c[h]))+"\n"}if(""!=l){s+="\n\n一层标签列表:\n";for(h=0;h<=l.length-1;h++)s+=l[h]+"\n"}return s},xiyueta.fn.extend({scan:function(t){return _xyt.scan(t)}}),_XIYUETA.prototype.cutLabel=function(t,e){for(var l="",i=0;i<=this.htmlArr.length-1;i++)null!=(p=this.htmlArr[i])&&("/style"==p.label?l+=p.upHtml:"link"==p.label&&"stylesheet"==p.rel&&(l+=p.content));var s="*,body,",r=-1;if(""!=(m=this.getDocument(t))){var n=m=m.replace(/,/,""),a=m;-1!=m.indexOf("|")&&(n=(o=m.split("|"))[0],a=o[1]);for(var h,i=n;i<=parseInt(a)-1;i++)null!=(p=this.htmlArr[i])&&"/"!=p.label.substr(0,1)&&(-1==r&&(p.label,r=p.lv),r+1==p.lv&&p.label,r+2==p.lv&&p.label,r+3==p.lv&&p.label,s+=p.label+",",null!=(h=this.handleLabelParam(p,"id"))&&(s+="#"+h.toLowerCase()+","),null!=(h=this.handleLabelParam(p,"class"))&&(s+="."+h.toLowerCase().replace(/ /g,",.")+","));for(var o=s.split(","),s="",i=0;i<=o.length-1;i++)-1==(","+s+",").indexOf(","+o[i]+",")&&(""!=s&&(s+=","),s+=o[i]);var u="",f=new _XIYUETACSS;f.cssParse(l);for(var p,i=0;i<=f.cssArr.length-1;i++)if(null!=(p=f.cssArr[i]))for(var m=","+p.label+",",c=(p.label,0);c<=o.length-1;c++)-1==m.indexOf(","+o[c]+",")&&-1==m.indexOf(","+o[c]+" ")||-1==("\n"+u+"\n").indexOf("\n"+p.html+"\n")&&(u+=p.html+"\n");xiyuetaCSS().parse(u),""!=(u=xiyuetaCSS().print("zip"))&&(u="<style>"+u+"\n</style>\n");n=xiyueta(t).html(null,"all");this.parseHTML(n);n=u+this.printHTML("format")}return n},_XIYUETA.prototype.getUrlStr=function(e,l){var i=this;jQuery.ajax({url:this.config.serverurl+"?act=getUrlStr&n="+Math.random(),type:"POST",data:{httpurl:l},error:function(t,e,l){},success:function(t){xiyuetaCSS().parse(t),xiyuetaCSS().allcss("|url","server="+l),e.content=xiyuetaCSS().print(),i.config.downcss--,0==i.config.downcss?alert("下载全部CSS完成，可以点击下一步 了"):alert("下载CSS完成,还乘"+i.config.downcss)}})},xiyueta.fn.extend({cutlabel:function(t){return _xyt.cutLabel(this.selector,t)}}),XiyuetaCommon.prototype.handleFileUrl=function(t){var e="",l=t.indexOf("://");for(-1!=l&&(e=t.substr(0,l+3),t=t.substr(l+3));-1!=t.indexOf("//");)t=t.replace(/\/\//g,"/");if(-1!=(t=-1!=t.indexOf("/./")?t.replace(/\/.\//g,"/"):t).indexOf("/../")){for(var i=[],s=0,r=t.split("/"),n=0;n<=r.length-1;n++)".."==(a=r[n])?(0==s?s=n-1:--s,0<=s&&delete i[s]):(i.push(a),s=0);for(t="",n=0;n<=i.length-1;n++){var a=i[n];null!=i[n]&&(""!=t&&(t+="/"),t+=i[n])}}return e+t},XiyuetaCommon.prototype.fullHttpUrl=function(t,e){if(null==e)return"";if(""==(e=e.replace(/\\/g,"/"))||"./"==e)return"";var l="",i="",s="",r=t.indexOf("://");return-1!=r&&(l=t.substr(0,r+3),r=(t=t.substr(r+3)).lastIndexOf("/"),s=l+t.substr(0,r+1),r=t.indexOf("/"),i=l+t.substr(0,r+1)),"//"==e.substr(0,2)?e="http:"+e:-1==e.indexOf("://")&&(e="/"==e.substr(0,1)?i+e:s+e),this.handleFileUrl(e)},XiyuetaCommon.prototype.getUrlFileName=function(t,e){if(null==e&&(e=""),""==t||null==t)return"";var l=(t=t.replace(/\\/g,"/").trim()).split("/"),i=l[l.length-1],s="",t="";return-1!=(i=-1!=i.indexOf("?")?i.substr(0,i.indexOf("?")):i).indexOf(".")&&(l=i.lastIndexOf("."),s=i.substr(0,l),t=i.substr(l+1).toLowerCase()),"image"==e?""==t?i+=".jpg":-1=="|bmp|jpg|jpeg|gif|png|".indexOf("|"+t+"|")&&(i=s+".jpg"):"css"==e?""==t?i+=".css":-1=="|css|".indexOf("|"+t+"|")&&(i=s+".css"):"js"==e?""==t?i+=".js":-1=="|js|".indexOf("|"+t+"|")&&(i=s+".js"):i=s+"."+t,i},XiyuetaCommon.prototype.setFileNameA=function(t){return t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/\\/g,"pie")).replace(/\//g,"la")).replace(/:/g,"maohao")).replace(/\*/g,"xin")).replace(/\?/g,"wen")).replace(/"/g,"yinhao")).replace(/</g,"zou")).replace(/>/g,"you")).replace(/\|/g,"heng")).replace(/\./g,"juhao")).replace(/,/g,"douhao")).replace(/&nbsp;/g," ")).replace(/&quot;/g,"shuang")).replace(/\n/g,"")},XiyuetaCommon.prototype.checkUrl=function(t){return!!/^\b(((https?|ftp):\/\/)?[-a-z0-9]+(\.[-a-z0-9]+)*\.(?:com|edu|gov|int|mil|net|org|biz|info|name|museum|asia|coop|aero|[a-z][a-z]|((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]\d)|\d))\b(\/[-a-z0-9_:\@&?=+,.!\/~%\$]*)?)$/i.test(t=null==t?"":t)},XiyuetaCommon.prototype.getDomain=function(t){if("string"!=typeof t)return"";if(-1<t.indexOf("//")){var e=t.indexOf("//",1),e=t.substring(e+1,t.length),t=e.indexOf("/",1);return e=e.substring(1,t)}return""},_XIYUETA.prototype.setTplConfig=function(t){if(null==t)return this.tplConfig;"object"==typeof t&&(null!=t.type&&(this.tplConfig.type=t.type),null!=t.item&&(this.tplConfig.item=t.item),"dedecms"==this.tplConfig.type?(this.tplConfig.webTitle="{dede:global.cfg_webname/}",this.tplConfig.webKeywords="{dede:global.cfg_keywords/}",this.tplConfig.webDescription="{dede:global.cfg_description/}",this.tplConfig.navFor="{dede:channel type='top' row='10'}\n",this.tplConfig.navTitle="[field:typename/]",this.tplConfig.navUrl="[field:typeurl/]",this.tplConfig.navEnd="{/dede:channel}",this.tplConfig.itemFor="自动",this.tplConfig.itemTitle="[field:title/]",this.tplConfig.itemUrl="[field:arcurl/]",this.tplConfig.itemImage="[field:image/]",this.tplConfig.itemAbout="[field:title/]",this.tplConfig.itemBody="[field:title/]",this.tplConfig.itemTime="[field:pubdate function=\"MyDate('Y-m-d H:i',@me)\"/]",this.tplConfig.itemTime1="[field:pubdate function=\"MyDate('Y-m-d',@me)\"/]",this.tplConfig.itemEnd="{/dede:arclist}"):(this.tplConfig.webTitle="<%=webTitle%>",this.tplConfig.webKeywords="<%=webKeywords%>",this.tplConfig.webDescription="<%=webDescription%>",this.tplConfig.navFor='<%rs.open "select * from " & db_PREFIX & "WebColumn where parentId=-1 and isThrough=1 order by sortRank asc" ,conn,1,1\nwhile not rs.eof\n%>\n',this.tplConfig.navTitle='<%=rs("columnName")%>',this.tplConfig.navUrl='<%=getNavUrl(rs("id"),rs("columnType"))%>',this.tplConfig.navEnd="<%rs.movenext:wend:rs.close%>",this.tplConfig.itemFor="自动",this.tplConfig.itemTitle='<%=rs("title")%>',this.tplConfig.itemUrl='detail.asp?id=<%=rs("id")%>',this.tplConfig.itemImage='<%=rs("smallimage")%>',this.tplConfig.itemAbout='<%=rs("aboutContent")%>',this.tplConfig.itemBody='<%=cutStr(rs("bodyContent"),260,"...")%>',this.tplConfig.itemTime='<%=rs("addDateTime")%>',this.tplConfig.itemTime1='<%=format_Time(rs("addDateTime"),2)%>',this.tplConfig.itemEnd="<%rs.movenext:next:rs.close%>"))},_XIYUETA.prototype.webtpl=function(t,e){null==t&&(t=""),this.setTplConfig(e),xiyueta("title").html(this.tplConfig.webTitle),xiyueta("meta[name|NOUL=keywords]").attr("content",this.tplConfig.webKeywords),xiyueta("meta[name|NOUL=description]").attr("content",this.tplConfig.webDescription);for(var l=!1,i=[],s=-1,r=0;r<=this.htmlArr.length-1;r++)null!=(m=this.htmlArr[r])&&("body"==m.label?(s=m.lv,l=!0):0==l&&-1!="|div|span|table|ul|table|".indexOf("|"+m.label+"|")?(m.x=r,i.push(m),l=!0,s=0):l&&m.lv-s==1&&2==m.tagpair&&"/"!=m.label.substr(0,1)&&"!--"!=m.label&&"script"!=m.label.substr(0,6)&&(m.x=r,i.push(m)));console.log("oneLevelArr一层",i),this.tplArr=[];for(var n=i.length-1,r=0;r<=n;r++){var a=i[r];null!=a&&(t=null!=a.id?a.label+"[id="+a.id+"]":null!=a.class?a.label+"[class='"+a.class+"']":a.label,h=a.x,o=this.getHtmlArrY(a,a.x),xiyueta(t,h,o).item().length,this.getSubList(h,o))}console.log("this.tplArr处理",this.tplArr);for(r=0;r<=this.tplArr.length-1;r++){var h=(m=this.tplArr[r]).x,o=m.y,u=m.label,f=u.lastIndexOf(" "),p=u.substr(0,f).trim(),f=u.substr(f+1).trim();-1!=xiyueta("*",h,o).text().indexOf("首页")?(console.log("导航 x:"+h+",y:"+o+" "+f+" "+m.count),xiyueta(p,h,o).nav(f)):(console.log("新闻 x:"+h+",y:"+o+" "+f+" "+m.count),xiyueta(p,h,o).news(f))}if("xiyuetacms"==this.tplConfig.type&&-1!=this.htmlSource.indexOf("版权所有")){alert("有版权所有");for(r=0;r<=this.htmlArr.length-1;r++){var m=this.htmlArr[r];if(void 0!==m&&-1!=m.upHtml.indexOf("版权所有"))for(var c=r-1;0<c;c--){var g=this.htmlArr[c];null!=g&&2==g.tagpair&&"/"!=g.label.substr(0,1)&&(xiyueta(g.label,c,r).html("<%=copyright%>"),c=0)}}}},_XIYUETA.prototype.getHtmlArrY=function(t,e){for(var l=e+1;l<=this.htmlArr.length-1;l++)if(this.htmlArr[l].lv==t.lv)return l;return null},_XIYUETA.prototype.getSubList=function(t,e,l){for(var i="",s=t+1;s<=e;s++){var r,n,a=this.htmlArr[s];null!=a&&(l=null==l?a.lv:l)==a.lv&&"/"!=a.label.substr(0,1)&&(r=this.getHtmlArrY(a,s),-1==("|"+i+"|").indexOf("|"+a.label+"|")&&"<"!==a.label.substr(0,1)&&"{"!==a.label.substr(0,1)&&(i+=a.label+"|",(n=this.getLabelCount(t,e,a.label,a.lv))>=this.tplConfig.item&&this.tplArr.push({label:a.label,x:s,y:e,count:n})),2==a.tagpair&&this.getSubList(s,r))}return""},_XIYUETA.prototype.getLabelCount=function(t,e,l,i){for(var s,r=0,n=t+1;n<=e;n++){var a,h=this.htmlArr[n];null!=h&&(i=null==i?h.lv:i)==h.lv&&l==h.label&&(a=this.getHtmlArrY(h,n),a=xiyueta(h.label,n,a).dom("lable"),null==s?(s=a,r++):s==a&&r++)}return r},_XIYUETA.prototype.nav=function(t,e,l,i){""!=(t=null==t?"":t)&&(t+=" "),aConfig="a"==i&&""!=t?t.trim():t+i.trim(),null==this.tplConfig.webTitle&&xiyueta().tplconfig({}),"a"==i?(xiyueta(aConfig,e,l).attr("href","#"),xiyueta(aConfig,e,l).attr("title",""),xiyueta(aConfig,e,l).attr("alt",""),xiyueta(aConfig,e,l).html("")):(xiyueta(aConfig+" a",e,l).attr("href","#"),xiyueta(aConfig+" a",e,l).attr("title",""),xiyueta(aConfig+" a",e,l).attr("alt",""),xiyueta(aConfig+" a",e,l).html(""));var s=-1,r=-1,n="",a="",h=-1,o=-1,u=0;xiyueta(aConfig,e,l).each(function(t,e){""==n?(n=e.html+e.innerHTML,h=1,s=t):n==e.html+e.innerHTML?h++:""!=a&&a==e.html+e.innerHTML?o++:(a=e.html+e.innerHTML,o=1,r=t),u++});var f,p,m,c=xiyueta(aConfig+":eq("+s+")",e,l).dom("doc|label|");"a"==i&&""==c?(xiyueta(aConfig+":eq("+s+")",e,l).attr("href",this.tplConfig.navUrl),xiyueta(aConfig+":eq("+s+")",e,l).attr("title",this.tplConfig.navTitle),xiyueta(aConfig+":eq("+s+")",e,l).html(this.tplConfig.navTitle)):"<a></a>"==c?(xiyueta(aConfig+":eq("+s+") a",e,l).attr("href",this.tplConfig.navUrl),xiyueta(aConfig+":eq("+s+") a",e,l).attr("title",this.tplConfig.navTitle),xiyueta(aConfig+":eq("+s+") a",e,l).html(this.tplConfig.navTitle)):console.log("未找到",c),-1!=r&&("a"==i&&""==c?(xiyueta(aConfig+":eq("+r+")",e,l).attr("href",this.tplConfig.navUrl),xiyueta(aConfig+":eq("+r+")",e,l).attr("title",this.tplConfig.navTitle),xiyueta(aConfig+":eq("+r+")",e,l).html(this.tplConfig.navTitle)):"<a></a>"==c&&(xiyueta(aConfig+":eq("+r+") a",e,l).attr("href",this.tplConfig.navUrl),xiyueta(aConfig+":eq("+r+") a",e,l).attr("title",this.tplConfig.navTitle),xiyueta(aConfig+":eq("+r+") a",e,l).html(this.tplConfig.navTitle)),a=xiyueta(aConfig+":eq("+r+")",e,l).html(null,"all"),"xiyuetacms"==this.tplConfig.type&&(f=xiyueta(aConfig+":eq("+s+")",e,l).html())==(p=xiyueta(aConfig+":eq("+r+")",e,l).html())&&(f=xiyueta(aConfig+":eq("+s+")",e,l).attr("class"))!=(p=xiyueta(aConfig+":eq("+r+")",e,l).attr("class"))&&(m=f,c=p,o<h&&(m=p,c=f),xiyueta(aConfig+":eq("+s+")",e,l).attr("class",'<%=IIF(isFocusNav(rs),"'+m+'","'+c+'")%>')));n=xiyueta(aConfig+":eq("+s+")",e,l).html(null,"all");h<o&&(d=n,n=a,a=d);for(var g=0;g<=u;g++)xiyueta(t+i+":eq(1)",e,l).remove();var d=this.tplConfig.navFor;-1==o?d+=n:"dedecms"==this.tplConfig.type?(""!=a&&(a=a.replace(/"/g,"'").replace(/\[field:/g,"~").replace(/\/]/g,"~"),d=d.replace("}",' currentstyle="'+a+'"}')),d+=n+"\n"):-1!=n.indexOf("isFocusNav(rs)")?d+=n:-1!=a.indexOf("isFocusNav(rs)")?d+=a:d+="<%if isFocusNav(rs) then%>\n"+a+"\n<%else%>\n"+n+"\n<%end if%>\n",d+=this.tplConfig.navEnd,xiyueta(t+i+":eq(0)",e,l).html(d,"all")},_XIYUETA.prototype.news=function(t,e,l,i){""!=(t=null==t?"":t)&&(t+=" "),aConfig="a"==i&&""!=t?t.trim():t+i.trim();var s=xiyueta(aConfig+":eq(0)",e,l).dom("doc|label|");if(null==this.tplConfig.webTitle&&xiyueta().tplconfig({}),"<a></a>"==s)xiyueta(aConfig+":eq(0) a",e,l).attr("href",this.tplConfig.itemUrl),""!=xiyueta(aConfig+":eq(0) a",e,l).attr("title")&&xiyueta(aConfig+":eq(0) a",e,l).attr("title",this.tplConfig.itemTitle),xiyueta(aConfig+":eq(0) a",e,l).html(this.tplConfig.itemTitle);else if("<a><img><h1></h1></a>"==s)xiyueta(aConfig+":eq(0) a",e,l).attr("href",this.tplConfig.itemUrl),""!=xiyueta(aConfig+":eq(0) a",e,l).attr("title")&&xiyueta(aConfig+":eq(0) a",e,l).attr("title",this.tplConfig.itemTitle),xiyueta(aConfig+":eq(0) img",e,l).attr("src",this.tplConfig.itemImage),xiyueta(aConfig+":eq(0) h1",e,l).html(this.tplConfig.itemTitle);else if("<a><label><img></label><h1></h1><p></p><span></span></a>"==s)xiyueta(aConfig+":eq(0) a",e,l).attr("href",this.tplConfig.itemUrl),""!=xiyueta(aConfig+":eq(0) a",e,l).attr("title")&&xiyueta(aConfig+":eq(0) a",e,l).attr("title",this.tplConfig.itemTitle),xiyueta(aConfig+":eq(0) img",e,l).attr("src",this.tplConfig.itemImage),xiyueta(aConfig+":eq(0) h1",e,l).html(this.tplConfig.itemTitle),xiyueta(aConfig+":eq(0) p",e,l).html(this.tplConfig.itemAbout);else if("<a><img><span></span></a>"==s)xiyueta(aConfig+":eq(0) img",e,l).attr("src",this.tplConfig.itemImage),xiyueta(aConfig+":eq(0) span",e,l).html(this.tplConfig.itemTitle),xiyueta(aConfig+":eq(0) a",e,l).attr("href",this.tplConfig.itemUrl),""!=xiyueta(aConfig+":eq(0) a",e,l).attr("title")&&xiyueta(aConfig+":eq(0) a",e,l).attr("title",this.tplConfig.itemTitle);else if("<a></a><span></span>"==s)xiyueta(aConfig+":eq(0) a",e,l).attr("href",this.tplConfig.itemUrl),""!=xiyueta(aConfig+":eq(0) a",e,l).attr("title")&&xiyueta(aConfig+":eq(0) a",e,l).attr("title",this.tplConfig.itemTitle),xiyueta(aConfig+":eq(0) a",e,l).html(this.tplConfig.itemTitle),xiyueta(aConfig+":eq(0) span",e,l).html(this.handleItemTime(aConfig,e,l,this.tplConfig.itemTitle));else if("<div><a><div><img></div><div><p></p></div></a></div>"==s)xiyueta(aConfig+":eq(0) a",e,l).attr("href",this.tplConfig.itemUrl),""!=xiyueta(aConfig+":eq(0) a",e,l).attr("title")&&xiyueta(aConfig+":eq(0) a",e,l).attr("title",this.tplConfig.itemTitle),xiyueta(aConfig+":eq(0) img",e,l).attr("src",this.tplConfig.itemImage),""!=xiyueta(aConfig+":eq(0) img",e,l).attr("alt")&&xiyueta(aConfig+":eq(0) img",e,l).attr("alt",this.tplConfig.itemTitle),xiyueta(aConfig+":eq(0) p",e,l).html(this.tplConfig.itemTitle);else if("<div><a><i></i><h3></h3><span><span></span></span></a></div>"==s){xiyueta(aConfig+":eq(0) a",e,l).attr("href",this.tplConfig.itemUrl),""!=xiyueta(aConfig+":eq(0) a",e,l).attr("title")&&xiyueta(aConfig+":eq(0) a",e,l).attr("title",this.tplConfig.itemTitle),xiyueta(aConfig+":eq(0) h3",e,l).html(this.tplConfig.itemTitle),xiyueta(aConfig+":eq(0) span:eq(1)",e,l).html(this.tplConfig.itemBody);for(var r=xiyueta(void 0,e,l).item("style"),n=0;n<=r.length-1;n++){xiyuetaCSS().parse("aa{"+r[n]+"}"),xiyuetaCSS().config({parentdir:""});var a,h=xiyuetaCSS().allcss("|url");xiyuetaCSS().allcss("|url",this.tplConfig.itemImage),""!=h&&(a=xiyuetaCSS().print().trim(),xiyueta().replace("style",r[n],a.substr(3,a.length-4)))}}else"<a><img><p></p></a>"==s?(xiyueta(aConfig+":eq(0) a",e,l).attr("href",this.tplConfig.itemUrl),""!=xiyueta(aConfig+":eq(0) a",e,l).attr("title")&&xiyueta(aConfig+":eq(0) a",e,l).attr("title",this.tplConfig.itemTitle),xiyueta(aConfig+":eq(0) img",e,l).attr("src",this.tplConfig.itemImage),""!=xiyueta(aConfig+":eq(0) img",e,l).attr("alt")&&xiyueta(aConfig+":eq(0) img",e,l).attr("alt",this.tplConfig.itemTitle),xiyueta(aConfig+":eq(0) p",e,l).html(this.tplConfig.itemTitle)):"<a><div><img></div><div><div><div></div></div></div></a>"==s?(xiyueta(aConfig+":eq(0) a",e,l).attr("href",this.tplConfig.itemUrl),""!=xiyueta(aConfig+":eq(0) a",e,l).attr("title")&&xiyueta(aConfig+":eq(0) a",e,l).attr("title",this.tplConfig.itemTitle),xiyueta(aConfig+":eq(0) img",e,l).attr("src",this.tplConfig.itemImage),""!=xiyueta(aConfig+":eq(0) img",e,l).attr("alt")&&xiyueta(aConfig+":eq(0) img",e,l).attr("alt",this.tplConfig.itemTitle),xiyueta(aConfig+":eq(0) div:eq(3)",e,l).html(this.tplConfig.itemTitle)):""==s?(xiyueta(aConfig+":eq(0)",e,l).html(this.tplConfig.itemTitle),"a"==i&&(xiyueta(aConfig+":eq(0)",e,l).attr("href",this.tplConfig.itemUrl),""!=xiyueta(aConfig+":eq(0) a",e,l).attr("title")&&xiyueta(aConfig+":eq(0) a",e,l).attr("title",this.tplConfig.itemTitle))):console.log("labelType(标签类型项没有处理)="+s);var s=xiyueta(t+i+":eq(0)",e,l).html(null,"all"),o=xiyueta(t+i,e,l).item().length;0==o&&(o=10);for(n=0;n<=o;n++)xiyueta(t+i+":eq(1)",e,l).remove();h="dedecms"==this.tplConfig.type?"{dede:arclist titlelen='60' row='"+o+"'}":'<%rs.open "select * from " & db_PREFIX & "ArticleDetail where parentId in("& getNameToAllId("产品中心") &") order by sortRank desc" ,conn,1,1\nfor i=1 to '+o+"\nif rs.eof then exit for\n%>\n",h+=s,h+=this.tplConfig.itemEnd,xiyueta(t+i+":eq(0)",e,l).html(h,"all")},_XIYUETA.prototype.handleItemTime=function(t,e,l,i){var s=xiyueta(t+":eq(0) span",e,l).text().trim(),r="",n="",a=!1,h=-1;""!=s&&("["==s.substr(0,1)&&(r="[",s=s.substr(1)),"]"==s.substr(-1,1)&&(n="]",s=s.substr(0,s.length-1)));new RegExp(/^[1-9]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$/).test(s)&&(a=!0,h=2),a&&(i=this.tplConfig.itemTime,i=r+(i=0<h?this.tplConfig.itemTime1:i)+n),xiyueta(t+":eq(0)  span",e,l).html(i)},xiyueta.fn.extend({tplconfig:function(t){return _xyt.setTplConfig(t)},nav:function(t){return _xyt.nav(this.selector,this.x,this.y,t)},news:function(t){return _xyt.news(this.selector,this.x,this.y,t)},webtpl:function(t){return _xyt.webtpl(this.selector,t)}});

module.exports = $
