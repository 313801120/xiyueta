/*! xiyueta v1.3.7 | Author xiyueta Adream http://xiyueta.com/ | Released under the MIT license  */
String.prototype.trim=function(){return(this+"").replace(/(^\s*)|(\s*$)/g,"")};var _CONSOLE=function(){this.log=function(t,e){if("object"==typeof t){var r,s;for(r in t)-1==(t[r]+"").indexOf("function")&&(s=(s=t[r]+"").replace(/</g,"&lt;").replace(/\n/g,"<br>").replace(/ /g,"&nbsp;"),void 0===(s="object"==typeof t[r]?this.log(t[r]):s)?response.write(r+"<br>"):response.write(r+":  "+s+"<br>"))}else"string"==typeof e&&(t+=" "+e),response.write(t+"<br>")}},console=new _CONSOLE;function XiyuetaCommon(){this.copyStr=function(t,e){for(var r="",s=1;s<=e;s++)r+=t;return r},this.timeFormat=function(t,e){var r,s={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};for(r in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length))),s)new RegExp("("+r+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?s[r]:("00"+s[r]).substr((""+s[r]).length)));return e},this.secondToDate=function(t){t=parseFloat(t)/1e3;return t=null!=t&&""!=t?60<t&&t<3600?parseInt(t/60)+" 分钟 "+parseInt(60*(parseFloat(t/60)-parseInt(t/60)))+" 秒 ":3600<=t&&t<86400?parseInt(t/3600)+" 小时 "+parseInt(60*(parseFloat(t/3600)-parseInt(t/3600)))+" 分钟 "+parseInt(60*(parseFloat(60*(parseFloat(t/3600)-parseInt(t/3600)))-parseInt(60*(parseFloat(t/3600)-parseInt(t/3600)))))+" 秒 ":parseInt(t)+" 秒 ":t},this.bystesLength=function(t){for(var e=0,r=0;r<t.length;r++)255<t.charCodeAt(r)?e+=2:e++;return e},this.getFileSize=function(t){return t<1048576?(t/1024).toFixed(2)+"KB":1048576==t?"1MB":1048576<t&&t<1073741824?(t/1048576).toFixed(2)+"MB":1048576<t&&1073741824==t?"1GB":1073741824<t&&t<1099511627776?(t/1073741824).toFixed(2)+"GB":"文件超过1TB"},this.renderSize=function(t){if(null==t||""==t)return"0 Bytes";var e=new Array("Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"),t=parseFloat(t),r=Math.floor(Math.log(t)/Math.log(1024));return(t/Math.pow(1024,r)).toFixed(2)+e[r]},this.isArray=function(t){return"object"==typeof t&&t.constructor==Array}}var _XIYUETA=function(){"use strict";this.version="1.3.7",this.htmlSource="",this.htmlArr=[],this.lv=0,this.isHtmlErr=!1,this.common=new XiyuetaCommon,this.config={httpurl:"",serverurl:"/api/downWeb/default.asp",jsdir:"js/",cssdir:"css/",imagesdir:"images/",urlToNameList:"",urlDefaultFileName:"default"},this.tplConfig={type:"xiyuetacms",minrow:4},this.singleLabelList="|br|hr|img|link|meta|param|input|!doctype|rect|line|col|wbr|base|basefont|area|";for(var e={},t="Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),r=0;r<t.length;r++){var s=t[r];e["[object "+s+"]"]=s.toLowerCase()}this.toType=function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?e[Object.prototype.toString.call(t)]||"object":typeof t},this.parseHTML=function(t){this.htmlSource=t+="";var e="",r="",s="",l="",i=!(this.htmlArr=[]),n=!1,h=!1,a=!1,o=!1,u=!1,f=0,m=-1;this.isHtmlErr=!1;for(var c=0;c<this.htmlSource.length;c++){var d,p,g,b,x=e,e=this.htmlSource.substr(c,1);i?(s+=e,a?">"==e&&"--\x3e"==s.substr(s.length-3,3)&&(h=i=a=!1,this.htmlArr.push({_index:++m,lv:f+1,label:"!--",upHtml:l,downHtml:"",html:s,tagpair:1}),l=s=""):n&&"\x3c!--"==s?a=!0:o?">"==e&&"%"==x&&(h=i=o=!1,s=l+s,l=""):n&&"<%"==s?o=!0:u?">"==e&&"?"==x&&(h=i=u=!1,s=l+s,l=""):n&&"<?"==s?u=!0:-1!=" \n\t".indexOf(e)&&n?n=!1:"<"==e?"%"==(b=this.htmlSource.substr(c+1,1).toLowerCase())?0<(d=this.htmlSource.substr(c+1).indexOf("%>"))&&(s+=this.htmlSource.substr(c+1).substr(0,d+2),c+=d+2):"?"==b?0<(d=this.htmlSource.substr(c+1).indexOf("?>"))&&(s+=this.htmlSource.substr(c+1).substr(0,d+2),c+=d+2):(i=n=!1,s=l,c--):">"==e&&(i=n=!1,x=2,"/"==r.substr(0,1)?h=!0:(f++,"/"!=r.substr(r.length-1,1)&&-1==this.singleLabelList.indexOf("|"+r.toLowerCase()+"|")||(h=!0,x=1,r=r.replace(/\//g,"").trim())),p=r.toLowerCase(),this.htmlArr.push({_index:++m,lv:f,label:p,upHtml:l,downHtml:"",html:s,tagpair:x}),f<1&&(this.isHtmlErr=!0),l=s="",h&&(f--,h=!1),"script"==p?(g=this.htmlSource.substr(c+1).toLowerCase().indexOf("<\/script>"),s=this.htmlSource.substr(c+1,g),c+=g):"style"==p?(g=this.htmlSource.substr(c+1).toLowerCase().indexOf("</style>"),s=this.htmlSource.substr(c+1,g),c+=g):"textarea"==p&&(g=this.htmlSource.substr(c+1).toLowerCase().indexOf("</textarea>"),s=this.htmlSource.substr(c+1,g),c+=g)),n&&(r+=e)):"<"==e?(b=this.htmlSource.substr(c+1,1).toLowerCase(),-1!="abcdefghijklmnopqrstuvwxyz!/%?".indexOf(b)?(l=s,s=e,h=!(n=i=!0),r=""):s+=e):s+=e}""!=s&&this.htmlArr.push({_index:++m,lv:f,label:"",upHtml:l,html:s,downHtml:""}),this.lv=f},this.handleLabelParam=function(t,e,r){if(null==t)return"";if(null==r){if(null!=t[e])return t[e]}else r+="";for(var s=!1,l=!1,i="",n="",h=!1,a="",o=!1,u=!0,f=0,m=0,c=!1,d=t.label.length+1;d<t.html.length;d++){var p,g,b,x,y=t.html.substr(d,1);if(h)if(o)if(c)">"==y&&(c=!1),n+=y;else if(y==a||">"==y){if(t[i=i.toLowerCase()]=n,o=h=!1,a="",e==i)return null==r?n:(""==r?(b=t.html.substr(0,m-1).trim(),">"!=(x=t.html.substr(d+1).trim()).substr(0,1)&&(x=" "+x),t.html=b+x,t[i]=void 0):(p=(g=f)+n.length,u&&(g++,p++),b=t.html.substr(0,g),x=t.html.substr(p),t.html=b+r+x,t[i]=r),t);if(">"==y&&null!=r)return""!=r&&(t.html=t.html.substr(0,t.html.length-1)+" "+e+'="'+r+'">'),t[e]=r,t}else"<"==y&&(c=!0),n+=y;else'"'==y||"'"==y?(a=y,f=d,u=o=!0):" "!=y&&(a=" ",f=d,n=y,u=!(o=!0));else{if(">"==y&&0==s)return null==r?void 0:(""!=r&&(t.html=t.html.substr(0,t.html.length-1)+" "+e+'="'+r+'">',t[e]=r),t);if(s){if("="==y)h=!(s=!1),a=n="";else if(0==l)-1!=" \t\n".indexOf(y)?l=!0:i+=y;else if(-1==" \t\n".indexOf(y)){if(e==i)return null==r?"":(""==r?(b=t.html.substr(0,m).trim(),">"!=(x=t.html.substr(d).trim()).substr(0,1)&&(x=" "+x),t.html=b+x,t[i]=void 0):(g=m+i.length,b=t.html.substr(0,g),x=t.html.substr(g),t.html=b+'="'+r+'"'+x,t[i]=r),t);s=!1,i=""}}else-1==" \t\n".indexOf(y)&&(l=!(s=!0),i=y,m=d)}}},this.getDocument=function(t,e,r,s,l){if(null==t&&(t=""),null==s&&(s=!1),0==this.htmlArr.length)return console.log("%c 需要先解析一段html文本","font-size:14px;color:#FF3300"),"";if(-1!=t.indexOf(",")){for(var i=[],n=t.split(","),h=0;h<n.length;h++){var a=this.getDocument(n[h],e,r,s);i=i.concat(a)}return i=this.delDomListDuplicate(i)}if(""==(t=t.trim()))return"";null==e&&(e=0),null==r&&(r=this.htmlArr.length-1);var o=-1.1,u=-1.1,f=-1.1,m=-1.1,c=-1.1,d="",p=!1,g="",b="",x="",y="",v="",L="";if("number"==this.toType(l)&&(u=l),-1!=t.indexOf("'")||-1!=t.indexOf('"')||-1!=t.indexOf("(")){for(var A=!1,L="",h=0;h<t.length;h++){var _=t.substr(h,1);0!=A||"'"!=_&&'"'!=_&&"("!=_?1==A&&(" "==_?_="-Space-":"'"!=_&&'"'!=_&&")"!=_||(A=!1,"'"!=_&&'"'!=_||(_=""))):(A=!0,"'"!=_&&'"'!=_||(_="")),L+=_}t=L}var l=t.indexOf(">"),O=t.indexOf(" "),w=" ",C=O;-1!=l&&(l<O||-1==O)&&(w=">",C=l),-1<C&&(g=t.substr(C+1).trim(),t=t.substr(0,C));-1!=(C=t.indexOf(":"))&&(l=O="",N=(_=t.substr(C+1)).indexOf("("),S=_.indexOf(")"),-1!=N&&-1!=S?(O=_.substr(0,N).toLowerCase(),S=(l=_.substr(N+1)).indexOf(")"),l=l.substr(0,S).replace(/-Space-/g," ").trim()):O=_.toLowerCase(),"first"==O?o=0:"last"==O?o=-1:"even"==O?f=0:"odd"==O?f=1:"eq"==O?(o=0,(o=""!=l?parseInt(l):o)+""=="NaN"&&(o=-.1,t="")):"lv"==O?(u=1,(u=""!=l?parseInt(l):u)+""=="NaN"&&(u=-.1,t="")):"gt"==O?""!=l&&(m=parseInt(l))+""=="NaN"&&(m=-.1,t=""):"lt"==O?""!=l&&(c=parseInt(l))+""=="NaN"&&(c=-.1,t=""):"header"==O?p=!0:"contains"==O?d=l:console.log(t,"没有动作 "+O),""!=(t=t.substr(0,C))||-.1==o&&-.1==u||(t="*"));var I=[];if(-1!=t.indexOf("["))for(h=0;h<10;h++)if(-1!=(C=t.indexOf("["))){var H,S=(_=t.substr(C+1)).indexOf("]"),D=(v=y=x=b="",-1==(_=_.substr(0,S)).indexOf("=")?(b=_,x="*"):(b=(H=_.split("="))[0],x=H[1].replace(/-Space-/g," "),H=b.substr(b.length-1),-1!="!^$*~|".indexOf(H)&&(b=b.substr(0,b.length-1),y=H)),-1!=b.indexOf("|")&&(b=(H=b.split("|"))[0],"NOUL"==H[1]&&(x=x.toLowerCase(),v=H[1])),I.push({name:b,value:x,action:y,myaction:v}),t.substr(_.length+C+2));if(t=t.substr(0,C),-1!=D.indexOf("[")&&(t+=D),""==t&&(t="*"),-1==D.indexOf("["))break}if("#"==t.substr(0,1)){if(0<o)return"";o=0}var T,N={type:"",name:"",nFocus:-1.1},i=(-1<(C=t.substr(1).lastIndexOf("."))?(t=(T=t).substr(0,C+1),N={type:".",name:T.substr(C+2).toLowerCase()}):-1<(C=t.substr(1).lastIndexOf("#"))&&(t=(T=t).substr(0,C+1),N={type:"#",name:T.substr(C+2).toLowerCase()}),this.serchDocument(t,e,r,N,I));if(0<i.length)if(-1.1!=o)i=o<0?[i[i.length+o]]:[i[o]];else if(-1.1!=u){for(var F=[],h=0;h<i.length;h++)(P=this.htmlArr[i[h].x]).lv==u&&F.push(i[h]);i=F}else if(-1.1!=f){for(F=[],h=0;h<i.length;h++)h%2==f&&F.push(i[h]);i=F}else if(-1.1!=m){for(F=[],h=m+1;h<i.length;h++)F.push(i[h]);i=F}else if(-1.1!=c){c>i.length&&(c=i.length);for(F=[],h=0;h<c;h++)F.push(i[h]);i=F}else if(""!=d){for(var P,F=[],h=0;h<i.length;h++)(P=i[h]).x!=P.y&&-1!=this.text(P).indexOf(d)&&F.push(i[h]);i=F}else if(p){for(F=[],n="h1,h2,h3,h4,h5,h6,,h7,h8,h9".split(","),h=0;h<i.length;h++)for(var e=i[h].x,r=i[h].y,a=this.getDocument(t+" "+n[h],e,r,s),U=0;U<a.length;U++)F.push(a[U]);i=F}if(""!=g&&0<i.length){for(var j,F=[],h=0;h<i.length;h++)(e=i[h].x)!=(r=i[h].y)&&(j="",">"==w&&(j=this.htmlArr[e].lv+1),a=this.getDocument(g,e+1,r-1,!0,j),F=F.concat(a));i=F}return i=0==s?this.delDomListDuplicate(i):i},this.delDomListDuplicate=function(t){if(t.length<=1)return t;for(var e="",r=-1,s=[],l=0;l<t.length;l++){var i,n=t[l];null!=n&&n&&(i=n.x+"|"+n.y,-1==(","+e+",").indexOf(","+i+",")&&(e+=","+i,r++,n.index=r,s.push(n)))}return s},this.domListAsc=function(t){for(var e=[],r=-1,s=0;s<t.length;s++){for(var l,i=void 0,n=0;n<t.length;n++){var h=t[n];null!=h&&(null==i||h.x<i.x)&&(i=h,l=n)}r++,i.index=r,e.push(i),t[l]=void 0}return e},this.serchDocument=function(t,e,r,s,l){for(var i=!1,n=[],h=0,a=0,o=!1,u=e;u<=r;u++){var f=this.htmlArr[u];if(null!=f)if(i&&this.checkEndSelector(f,t)&&h==f.lv){i=!1,o&&(n[n.length-1].y=u);for(var o=!1,m=this.serchDocument(t,a+1,u,s,l),c=0;c<m.length;c++)n.push(m[c])}else if(this.checkStartSelector(f,t,s)&&0==i){2==f.tagpair&&(i=!0,h=f.lv);for(var a=u,d=!0,c=0;c<l.length;c++){var p=l[c].name,g=l[c].value,b=l[c].action,x=l[c].myaction;if(""!=p&&(p=this.handleLabelParam(f,p),"NOUL"==x&&null!=p&&(p=p.toLowerCase()),"^"==b?null!=p&&p.substr(0,g.length)==g||(d=!1):"|"==b?null!=p&&(p+"-").substr(0,g.length+1)==g+"-"||(d=!1):"$"==b?null!=p&&p.substr(-1*g.length)==g||(d=!1):"~"==b?null!=p&&-1!=(" "+p+" ").indexOf(" "+g+" ")||(d=!1):"*"==b?null!=p&&-1!=p.indexOf(g)||(d=!1):"!"==b?p==g&&(d=!1):null!=p&&"*"==g?d=!0:p!=g&&(d=!1)),0==d)break}d&&(n.push({index:n.length,x:u,y:u}),2==f.tagpair&&(o=!0))}}return n},this.checkStartSelector=function(t,e,r){if(""==t.label)return!1;var s=e+" ",l=t.label.substr(0,1),i=e.substr(0,1);if("/"==l)return!1;if("*"==i)return"."==r.type?null!=(h=this.handleLabelParam(t,"class"))&&-1!=(" "+h.toLowerCase()+" ").indexOf(" "+r.name+" "):"#"!=r.type||null!=(a=this.handleLabelParam(t,"id"))&&a.toLowerCase()==r.name;if("#"==i){var n=e.substr(1,s.indexOf(" ")-1);if(this.handleLabelParam(t,"id")==n)return""==r||("."==r.type?null!=(h=this.handleLabelParam(t,"class"))&&-1!=(" "+h.toLowerCase()+" ").indexOf(" "+r.name+" "):"#"!=r.type||null!=(a=this.handleLabelParam(t,"id"))&&a.toLowerCase()==r.name)}else if("."==i){var h,a,n=e.substr(1,s.indexOf(" ")-1).toLowerCase();if(null==(h=" "+this.handleLabelParam(t,"class")+" "))return!1;if(-1!=(h=h.toLowerCase()).indexOf(" "+n+" "))return""==r||("."==r.type?null!=(h=this.handleLabelParam(t,"class"))&&-1!=(" "+h.toLowerCase()+" ").indexOf(" "+r.name+" "):"#"!=r.type||null!=(a=this.handleLabelParam(t,"id"))&&a.toLowerCase()==r.name)}else if(t.label+" "==e.substr(0,t.label.length+1).toLowerCase()+" ")return"."==r.type?null!=(h=this.handleLabelParam(t,"class"))&&-1!=(" "+h.toLowerCase()+" ").indexOf(" "+r.name+" "):"#"!=r.type||null!=(a=this.handleLabelParam(t,"id"))&&a.toLowerCase()==r.name;return!1},this.checkEndSelector=function(t,e){t.label.substr(0,1);var r=e.substr(0,1);return"*"==r||("#"==r||"."==r||t.label=="/"+e.substr(0,t.label.length-1).toLowerCase())},this.handleDomList=function(t){return"object"==this.toType(t)?null!=t.domList?t.domList:null!=t._index?[{index:0,x:t._index,y:t._index}]:[t]:"string"==this.toType(t)?this.getDocument(t):t},this.each=function(t,e){if("function"!=typeof e)return!1;t=this.handleDomList(t);for(var r=[],s=0;s<t.length;s++){var l=t[s],i=e.call(l,s,l);if(l.value=i,r.push(l),"boolean"==typeof i&&0==i)break}return r},this.find=function(t,e){if(t=this.handleDomList(t=null==t?[]:t),"object"==this.toType(e)){for(var r=e.domList,s=[],l=0;l<r.length;l++)for(var i=r[l].x,n=r[l].y,h=0;h<t.length;h++){var a=t[h].x,o=t[h].y;a<=i&&i<=o&&s.push(r[l])}return this.delDomListDuplicate(s)}for(var u,s=[],h=0;h<t.length;h++)(i=t[h].x)!=(n=t[h].y)&&(u=this.getDocument(e,i,n),s=s.concat(u));return this.delDomListDuplicate(s)},this.add=function(t,e){t=this.handleDomList(t=null==t?[]:t);var r=[];if("number"==typeof e||"function"==typeof e)return t;if(null==e)return t;if(""==(r="object"==this.toType(e)?null!=e.domList?e.domList:[e]:this.getDocument(e+="")))return t;e=t.concat(r);return e=this.delDomListDuplicate(e),this.domListAsc(e)},this.not=function(t,e){t=this.handleDomList(t=null==t?[]:t);var r=[];if("number"==typeof e||"function"==typeof e)return t;if(null==e)return t;if(""==(r="object"==this.toType(e)?null!=e.domList?e.domList:[e]:this.getDocument(e+="")))return t;for(var s=[],l=0,i=0;i<t.length;i++){for(var n=t[i],h=!0,a=0;a<r.length;a++){var o=r[a];if(o.x==n.x&&o.y==n.y){h=!1;break}}h&&(n.index=l++,s.push(n))}return s},this.is=function(t,e){t=this.handleDomList(t=null==t?[]:t);var r=[];if("number"==typeof e||"function"==typeof e)return!1;if(null==e)return!1;if(""==(r="object"==this.toType(e)?null!=e.domList?e.domList:[e]:this.getDocument(e+="")))return!1;for(var s=0;s<t.length;s++)for(var l=t[s],i=0;i<r.length;i++){var n=r[i];if(n.x==l.x&&n.y==l.y)return!0}return!1},this.text=function(t,e){var r="get",t=this.handleTextHtml(t,e,"text",r=2<=arguments.length?"set":r);return t=null==t?"":t},this.html=function(t,e){var r=2<=arguments.length?"set":"get";return this.handleTextHtml(t,e,"html",r)},this.htmlwrap=function(t,e){var r=2<=arguments.length?"set":"get";return this.handleTextHtml(t,e,"htmlwrap",r)},this.handleTextHtml=function(t,e,r,s){if(null!=t){t=this.handleDomList(t);var l=this.toType(e);if("function"==l){for(var i=this.each(t,e),n=0;n<i.length;n++)i[n]&&this.handleTextHtml(i[n],i[n].value,r,s);return!1}if("set"==s){if("undefined"==l)return;null==e?e="":e+="","text"==r&&(e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;"))}for(var h="",n=0;n<t.length;n++)if(null!=t[n])for(var a=t[n].x,o=t[n].y,u=a;u<=o;u++){var f=this.htmlArr[u];if(f)if("text"==r)u==a?"get"==s&&(h+=f.downHtml):u<o?"set"==s?delete this.htmlArr[u]:h+=f.upHtml+f.downHtml:u==o&&("get"==s?h+=f.upHtml:f.upHtml=e);else if(u==a)"get"==s?("htmlwrap"==r&&(h+=f.html),h+=f.downHtml):"htmlwrap"==r&&(f.html="",u==o&&(f.upHtml=e));else if(u<o)"set"==s?delete this.htmlArr[u]:h+=f.upHtml+f.html+f.downHtml;else if(u==o)if("get"==s){if(h+=f.upHtml,"htmlwrap"==r&&(h+=f.html),"get"==s)return h}else f.upHtml=e,"htmlwrap"==r&&(f.html="")}return"get"==s?h:void 0}},this.handleCssParam=function(t,e,r){var s,l,i;if(null==r)return l="a{"+(i=null==(i=this.attr(t,"style"))?"":i)+"}",$xytcss("a").parse(l).css(e);r+="",s=i=null==(i=this.attr(t,"style"))?"":i,l="a{"+i+"}",$xytcss("a").parse(l).css(e,r),i=(i=$xytcss().print()).substr(2,i.length-3).trim(),s.trim()!=i&&(2<=i.split(";").length&&(i=i.replace(/ /g,"").replace(/:/g,": ").replace(/;/g,"; ").trim()),this.attr(t,"style",i))},this.css=function(t,e,r){var s=3<=arguments.length?"set":"get";return this.handleCssAttr(t,e,r,"css",s)},this.attr=function(t,e,r){var s=3<=arguments.length?"set":"get";return this.handleCssAttr(t,e,r,"attr",s)},this.prop=function(t,e,r){var s=3<=arguments.length?"set":"get";return this.handleCssAttr(t,e,r,"prop",s)},this.handleCssAttr=function(t,e,r,s,l){if("function"==this.toType(r)){for(var i=this.each(t,r),n=0;n<i.length;n++)i[n]&&this.handleCssAttr(i[n],e,i[n].value,s,l);return!1}if("object"==this.toType(e)){for(var h in e)this.handleCssAttr(t,h,e[h],s,l);return this}if(null!=t&&null!=e&&""!=(e=(e+="").trim())){t=this.handleDomList(t);for(n=0;n<t.length;n++){var a=t[n];if("attr"==s){if("get"==l)return this.handleLabelParam(this.htmlArr[a.x],e);this.handleLabelParam(this.htmlArr[a.x],e,r)}else if("prop"==s){var o=this.htmlArr[a.x],u=this.checkTagAttrExist(o.label,e);if("get"==l)return 0==u?void 0:this.handleLabelParam(o,e);u&&this.handleLabelParam(o,e,r)}else{if("get"==l)return this.handleCssParam(a,e);this.handleCssParam(a,e,r)}}}},this.data=function(t,e,r){if(null==t||null==e)return!1;if(""!=e.trim()){e="data_"+e;var s="get",l=(t=this.handleDomList(t)).length;"get"==(s=3<=arguments.length?"set":s)&&(l=1);for(var i=0;i<l;i++){var n=this.htmlArr[t[i].x];if(n){if("get"==s)return n[e];n[e]=r}}}},this.removeAttr=function(t,e){if(null==t||null==e)return!1;if(""==e.trim())return!1;t=this.handleDomList(t);for(var r=e.split(" "),s=0;s<r.length;s++){var l=r[s];""!=l&&this.attr(t,l,"")}return!0},this.val=function(t,e){if(null!=t){var r=this.toType(e);if("function"==r){for(var s=this.each(t,e),l=0;l<s.length;l++)s[l]&&this.val(s[l],s[l].value);return!1}t=this.handleDomList(t);var i="get";if(2<=arguments.length){if(i="set","undefined"==r)return;null==e?e="":e+=""}if("get"==i){if(a=0<t.length?this.htmlArr[t[0].x]:a){if("textarea"==a.label)return this.html(t[0]);if("select"!=a.label)return this.handleLabelParam(a,"value");for(var n=(m=this.getDocument("option",o,u)).length,h=0;h<n;h++)m[h].x==m[h].y||null==this.attr(m[h],"selected")&&null!=f||(f=this.attr(m[h],"value"));return f}}else for(l=0;l<t.length;l++)if(null!=t[l]){var a,o=t[l].x,u=t[l].y;if(a=this.htmlArr[o])if(o!=u)if("textarea"==a.label)this.html(t[l],e);else if("select"==a.label)for(var f,m=this.getDocument("option",o,u),h=0;h<m.length;h++)m[h].x!=m[h].y&&(this.attr(m[h],"value")==e?this.attr(m[h],"selected","selected"):this.attr(m[h],"selected",null));else this.attr(t[l],"value",e);else this.attr(t[l],"value",e)}}},this.remove=function(t,e,r){var s="",l=!1;if(2==arguments.length?"string"==typeof e?s=e:"boolean"==typeof e&&(l=e):3==arguments.length&&("string"==typeof e&&(s=e),"boolean"==typeof r&&(l=r)),null!=t){if(null==(t=this.handleDomList(t)))return"";null==s||-1!=(e=s.indexOf(":"))&&(h=r="",e=(s=s.substr(e+1)).indexOf("("),n=s.indexOf(")"),-1!=e&&-1!=n?(r=s.substr(0,e).toLowerCase(),n=(h=s.substr(e+1)).indexOf(")"),("'"==(e=(h=h.substr(0,n).replace(/-Space-/g," ").trim()).trim()).substr(0,1)&&"'"==e.substr(e.length-1,1)||'"'==e.substr(0,1)&&'"'==e.substr(e.length-1,1))&&(h=e.substr(1,e.length-2))):r=s.toLowerCase(),"contains"==r&&(i=h));var i,n,h,a=[];if(null!=i){for(var o=0;o<t.length;o++)(u=t[o]).x!=u.y&&-1!=this.text(u).indexOf(i)&&a.push(u);t=a}for(o=0;o<t.length;o++)for(var u,f=t[o].x,m=t[o].y,c=f;c<=m;c++)(u=this.htmlArr[c])&&(c==f?(u.html="",u.label="",l&&(u.upHtml="")):delete this.htmlArr[c]);return t}},this.addClass=function(t,e){var r=this.toType(e);if("function"==r){for(var s=this.each(t,e),l=0;l<s.length;l++)s[l]&&this.addClass(s[l],s[l].value);return!1}if(null!=t){if(t=this.handleDomList(t),"number"==r)return!1;if(null==t||null==e)return!1;if(this.common.isArray(e))var i=e;else{if(""==(e=(e+"").trim()))return!1;i=e.split(" ")}for(l=0;l<t.length;l++){for(var n=t[l],h=null!=(h=this.attr(n,"class"))?h.trim():"",a=0;a<i.length;a++)""!=i[a]&&-1==(" "+h+" ").indexOf(" "+i[a]+" ")&&(""!=h&&(h+=" "),h+=i[a]);this.attr(n,"class",h)}}},this.hasClass=function(t,e){if("number"==typeof e)return!1;if(null==t||null==e)return!1;if(""==(e=e.trim()))return!1;if(null==t)return!1;t=this.handleDomList(t);for(var r=0;r<t.length;r++){var s=null!=(s=this.attr(t[r],"class"))?s.trim():"";if(""!=s&&-1!=(" "+s+" ").indexOf(" "+e+" "))return!0}return!1},this.removeClass=function(t,e){if("function"==this.toType(e)){for(var r=this.each(t,e),s=0;s<r.length;s++)r[s]&&this.removeClass(r[s],r[s].value);return!1}if(null!=t){if(t=this.handleDomList(t),"array"==this.toType(e))var l=e;else{if(null==t||null==e)return!1;if(""==(e=(e+"").trim()))return!1;l=e.split(" ")}for(s=0;s<t.length;s++){var i=t[s];if(null!=(n=this.attr(i,"class"))){for(var n=" "+(n=n.trim())+" ",h=0;h<=l.length-1;h++)""!=l[h]&&(n=n.replace(" "+l[h]+" "," "));this.attr(i,"class",n.trim())}}}},this.wrap=function(t,e,r){if(null!=t){t=this.handleDomList(t);for(var s=0;s<t.length;s++){var l=t[s].x,i=t[s].y;this.htmlArr[l].upHtml+=e,this.htmlArr[i].downHtml+=r}return this}},this.unwrap=function(t){if(null!=t){t=this.handleDomList(t);for(var e=0;e<t.length;e++){for(var r=t[e].x,s=t[e].y,l=this.htmlArr[r].lv-1,i=r;0<=i;i--){var n=this.htmlArr[i];if("object"==typeof n&&this.htmlArr[i].lv==l){n.html="";break}}for(i=s;i<=this.htmlArr.length-1;i++){n=this.htmlArr[i];if("object"==typeof n&&this.htmlArr[i].lv==l){n.html="";break}}}return this}},this.append=function(t,e){if(null==t||null==e)return!1;if("function"==typeof e){for(var r=this.each(t,e),s=0;s<r.length;s++)r[s]&&this.append(r[s],r[s].value);return!1}t=this.handleDomList(t);for(s=0;s<t.length;s++){var l=t[s].x,i=t[s].y;l!=i?this.htmlArr[i]&&(this.htmlArr[i].upHtml+=e):this.htmlArr[l]&&(this.htmlArr[l].downHtml+=e)}return this},this.prepend=function(t,e){if(null==t||null==e)return!1;if("function"==typeof e){for(var r=this.each(t,e),s=0;s<r.length;s++)r[s]&&this.prepend(r[s],r[s].value);return!1}t=this.handleDomList(t);for(s=0;s<t.length;s++){var l=this.htmlArr[t[s].x];l.downHtml=e+l.downHtml}return this},this.after=function(t,e){if(null==t||null==e)return!1;if("function"==typeof e){for(var r=this.each(t,e),s=0;s<r.length;s++)r[s]&&this.after(r[s],r[s].value);return!1}"object"==this.toType(t)&&(t=[t]);for(s=0;s<t.length;s++){var l=this.htmlArr[t[s].y];l.downHtml=e+l.downHtml}return this},this.before=function(t,e){if(null==t||null==e)return!1;if("function"==typeof e){for(var r=this.each(t,e),s=0;s<r.length;s++)r[s]&&this.before(r[s],r[s].value);return!1}t=this.handleDomList(t);for(s=0;s<t.length;s++)this.htmlArr[t[s].x].upHtml+=e;return this},this.next=function(t){t=this.handleDomList(t);for(var e=0;e<t.length;e++)for(var r=this.htmlArr[t[e].x],s=-1,l=r._index+1;l<=this.htmlArr.length-1;l++){var i=this.htmlArr[l];if(i){if(i.lv<r.lv)break;if(-1!=s){if(r.lv==i.lv&&"/"==i.label.substr(0,1))return{index:0,x:s,y:i._index}}else if(r.lv==i.lv&&"/"!=i.label.substr(0,1)){if(1==i.tagpair)return{index:0,x:i._index,y:i._index};s=i._index}}}return[]},this.nextAll=function(t){t=this.handleDomList(t);for(var e=[],r=-1,s=0;s<t.length;s++)for(var l=this.htmlArr[t[s].x],i=-1,n=l._index+1;n<=this.htmlArr.length-1;n++){var h=this.htmlArr[n];if(h){if(h.lv<l.lv)break;-1!=i?l.lv==h.lv&&"/"==h.label.substr(0,1)&&(e.push({index:++r,x:i,y:h._index}),i=-1):l.lv==h.lv&&"/"!=h.label.substr(0,1)&&(1==h.tagpair?e.push({index:++r,x:h._index,y:h._index}):i=h._index)}}return e},this.prev=function(t){t=this.handleDomList(t);for(var e=0;e<t.length;e++)for(var r=this.htmlArr[t[e].x],s=-1,l=r._index-1;0<=l;l--){var i=this.htmlArr[l];if(i){if(i.lv<r.lv)break;if(-1!=s){if(r.lv==i.lv&&"/"!=i.label.substr(0,1))return{index:0,x:i._index,y:s}}else if(r.lv==i.lv&&"/"==i.label.substr(0,1)){if(1==i.tagpair)return{index:0,x:i._index,y:i._index};s=i._index}}}return[]},this.prevAll=function(t,e){t=this.handleDomList(t),null==e&&(e="desc");for(var r=[],s=0;s<t.length;s++)for(var l=this.htmlArr[t[s].x],i=-1,n=l._index-1;0<=n;n--){var h=this.htmlArr[n];if(h){if(h.lv<l.lv)break;-1!=i?l.lv==h.lv&&"/"!=h.label.substr(0,1)&&(r.push({index:0,x:h._index,y:i}),i=-1):l.lv==h.lv&&"/"==h.label.substr(0,1)&&(1==h.tagpair?r.push({x:h._index,y:h._index}):i=h._index)}}return r="asc"==e?this.domListAsc(r):r},this.parent=function(t){t=this.handleDomList(t);for(var e=[],r=0;r<t.length;r++){for(var s=this.htmlArr[t[r].x],l=-1,i=-1,n=s._index-1;0<=n;n--){var h=this.htmlArr[n];if(h&&s.lv-1==h.lv&&"/"!=h.label.substr(0,1)){l=h._index;break}}for(n=s._index+1;n<=this.htmlArr.length-1;n++){h=this.htmlArr[n];if(h&&s.lv-1==h.lv&&"/"==h.label.substr(0,1)){i=h._index;break}}-1!=l&&e.push({x:l,y:i})}return e},this.parents=function(t){t=this.handleDomList(t);for(var e=[],r=0;r<t.length;r++){for(var s=this.htmlArr[t[r].x],l=-1,i=-1,n=s._index-1;0<=n;n--){var h=this.htmlArr[n];if(h&&s.lv-1==h.lv&&"/"!=h.label.substr(0,1)){l=h._index;break}}for(n=s._index+1;n<=this.htmlArr.length-1;n++){h=this.htmlArr[n];if(h&&s.lv-1==h.lv&&"/"==h.label.substr(0,1)){i=h._index;break}}-1!=l&&(e.push({x:l,y:i}),e=e.concat(this.parents([{x:l,y:i}])))}return this.delDomListDuplicate(e)},this.children=function(t){t=this.handleDomList(t);for(var e,r=[],s=0,l=0;l<t.length;l++){var i=t[l].x,n=t[l].y;if(i!=n)for(var h=this.htmlArr[i],a=i+1;a<n;a++){var o=this.htmlArr[a];o&&h&&o.lv-h.lv==1&&(2!=o.tagpair||-1!=o.label.indexOf("/")?r.push({index:s++,x:e,y:o._index}):e=o._index)}}return r},this.closest=function(t,e){t=this.handleDomList(t);for(var r=[],s=0,l=0;l<t.length;l++){var i=t[l].x,n=(t[l].y,this.htmlArr[i]);if("string"==typeof e)for(var h=this.getDocument(e),a=h.length-1;0<=a;a--){var o=h[a].x,u=h[a].y;if(o!=u){var f=this.htmlArr[o];if(o<i&&f.lv-n.lv==-1){r.push({index:s++,x:o,y:u});break}}}}return r},this.filter=function(t,e){t=this.handleDomList(t);for(var r=[],s=0;s<t.length;s++){var l=t[s].x,i=t[s].y;this.htmlArr[l];"string"==typeof e&&(l=this.getDocument(e,l,i),r=r.concat(l))}return this.delDomListDuplicate(r)},this.eq=function(t,e){return t=this.handleDomList(t),"array"!=this.toType(t)?[]:(null==e||""==e?e=0:(e=parseInt(e))+""=="NaN"&&(e=-1.1),-1.1!=e?(e=e<0?t.length+e:e)>t.length?"":[t[e]]:[])},this.slice=function(t,e,r){if(t=this.handleDomList(t),"array"!=this.toType(t))return[];if(null==e&&null==r)return t;if(isNaN(e)?e=0:(e=parseInt(e))<0&&(e=t.length- -1*e),null==r?r=t.length:isNaN(r)?r=-1:(r=parseInt(r))<0&&(r=t.length- -1*r),e+""=="NaN"||r+""=="NaN")return t;for(var s=[],l=0;l<t.length;l++)e<=l&&l<r&&s.push(t[l]);return s},this.show=function(t){for(var e=0;e<t.length;e++){var r=t[e];r.x!=r.y&&this.css(r,"display","")}return this},this.hide=function(t){if(t=this.handleDomList(t),"array"!=this.toType(t))return[];for(var e=0;e<t.length;e++){var r=t[e];r.x!=r.y&&this.css(r,"display","none")}return[]},this.dom=function(t,e,r,s){1!=(r=null==r?-1:r)&&2!=r&&(r=-1),""!=e&&(e="|"+e+"|");var l=(s=null==s?"":s).split(" ");if(t=this.handleDomList(t),"array"!=this.toType(t))return[];for(var i="",n=0;n<t.length&&!(0<n);n++){var h=t[n].x,a=t[n].y;if(h!=a)for(var o=h;o<=a;o++){var u=this.htmlArr[o];if(u){var f="";if(-1!=e.indexOf("label"))for(var m=0;m<=l.length-1;m++){var c,d=l[m];""==d||null!=(c=this.attr(u,d))&&(f+=" "+d+'="'+c+'"')}r!=u.tagpair&&-1!=r||(o==h||o==a?-1!=e.indexOf("all")&&(-1!=e.indexOf("label")?""!=u.label&&(i+="<"+u.label+f+">"):i+=u.html):o<a&&(-1!=e.indexOf("label")?""!=u.label&&(i+="<"+u.label+f+">"):i+=u.html))}}}return i},this.getlv=function(t){if(t=this.handleDomList(t),"array"==this.toType(t)&&1<=t.length){t=this.htmlArr[t[0].x];if(t)return t.lv}},this.getLabel=function(t){if(t=this.handleDomList(t),"array"==this.toType(t)&&1<=t.length){t=this.htmlArr[t[0].x];if(t)return t.label}},this.printHTML=function(t){for(var e="",r=0,s=-1!=(t=","+(t=null==t?"":t).replace(/\|/g,",").replace(/\s/g,"")+",").indexOf(",color,")?"<br>":"\n",l=-1!=t.indexOf(",color,")?"&nbsp;&nbsp;&nbsp;&nbsp;":"    ",i=0;i<=this.htmlArr.length-1;i++){var n,h,a,o,u=this.htmlArr[i];u&&(-1!=t.indexOf(",format,")?(n=u.upHtml.trim(),h=u.downHtml.trim(),a=u.html.trim(),-1!=t.indexOf(",color,")&&(n=this.htmlColor(n),h=this.htmlColor(h),a=this.htmlColor(a)),"html"==u.label?r=-1:"head"!=u.label&&"body"!=u.label||(n+=s),""!=a&&(o=!0,2==u.tagpair?"/"==u.label.substr(0,1)&&(o=this.upCheckThisLabel(u)):-1!=this.singleLabelList.indexOf("|"+u.label+"|")&&(o=!1),o&&(a=s+this.common.copyStr(l,u.lv-1+r)+a)),e+=n+a+h):-1!=t.indexOf(",zip,")?e+=u.upHtml.trim()+u.html.trim()+u.downHtml.trim():-1!=t.indexOf(",color,")?e+=this.htmlColor(u.upHtml)+this.htmlColor(u.html)+this.htmlColor(u.downHtml):e+=u.upHtml+u.html+u.downHtml)}return-1!=t.indexOf(",format,")&&(e=e.trim()),e=-1!=t.indexOf(",color,")?"<div style='font-family: Menlo, Monaco, Consolas, \"Courier New\", monospace;padding: 0.2em;margin: 0;font-size: 14px;'>"+e+"</div>":e},this.upCheckThisLabel=function(t){if("/head"==t.label||"/body"==t.label)return!0;for(var e=t._index-1;0<=e;e--){var r=this.htmlArr[e];if(r){if(r.lv==t.lv)return!1;if(2==r.tagpair||"img"==r.label)return!0;if(-1!=(r.upHtml+r.downHtml).indexOf("\n"))return!0}}return!1},this.getDelHtml=function(){for(var t="",e=0;e<=this.htmlArr.length-1;e++){var r=this.htmlArr[e];r&&("/"!=r.label.substr(0,1)&&(t+=r.upHtml.trim()),t+=r.downHtml.trim())}return t},this.debug=function(t){((t=null==t?!1:t)?xiyueta:console).log(this.htmlArr)},this.info=function(){console.log("%c xiyueta%c v"+_xyt.version+" website: www.xiyueta.com ","font-size:22px;color:#00bbee","color:#000")}},_xyt=new _XIYUETA,xiyueta=function(t,e,r){return new xiyueta.fn.init(t,e,r)},init=(xiyueta.fn=xiyueta.prototype={length:0,selector:"",domList:void 0,x:null,y:null,domListIndex:0},xiyueta.extend=xiyueta.fn.extend=function(){var t,e,r,s=arguments[0]||{},l=1,i=arguments.length;for(l===i&&(s=this,l--);l<i;l++)if(null!=(t=arguments[l]))for(e in t)r=t[e],"__proto__"!==e&&s!==r&&void 0!==r&&(s[e]=r);return s},xiyueta.fn.init=function(t,e,r){this.length=0,this.selector=t,this.domList=[],this.x=e,this.y=r,this.domListArray=[],0<_xyt.htmlArr.length&&("string"==typeof t?(this.domList=_xyt.getDocument(t,e,r),this.length=this.domList.length):"object"==typeof t&&(this.domList=t,this.length=1,this.selector="")),null==this.selector&&(this.selector="")}),_XIYUETACSS=(init.prototype=xiyueta.fn,($=$xyt=xiyueta).fn.extend({parse:function(t,e){return _xyt.parseHTML(t),1==(e=null!=e||0==_xyt.lv&&1!=_xyt.isHtmlErr?e:!0)&&0<(t=this.repair(!1)).err&&""!=t.errList&&1==t.state&&(_xyt.parseHTML(this.print()),this.repairHTML=!0),0<_xyt.htmlArr.length&&"string"==typeof this.selector&&(this.domList=_xyt.getDocument(this.selector,this.x,this.y),this.length=this.domList.length),this},find:function(t){return this.domListArray.push({domList:this.domList,length:this.length,selector:this.selector}),this.domList=_xyt.find(this.domList,t),this.length=this.domList.length,this.selector="",this},add:function(t){return this.domListArray.push({domList:this.domList,length:this.length,selector:this.selector}),this.domList=_xyt.add(this.domList,t),this.length=this.domList.length,this.selector="",this},not:function(t){return this.domListArray.push({domList:this.domList,length:this.length,selector:this.selector}),this.domList=_xyt.not(this.domList,t),this.length=this.domList.length,this.selector="",this},is:function(t){return _xyt.is(this.domList,t)},text:function(t){return 1<=arguments.length?(_xyt.text(this.domList,t),this):_xyt.text(this.domList)},html:function(t){return 1<=arguments.length?(_xyt.html(this.domList,t),this):_xyt.html(this.domList)},attr:function(t,e){if(null!=t)return null!=e||"object"==typeof t?(_xyt.attr(this.domList,t,e),this):""!=t.trim()?_xyt.attr(this.domList,t):void 0},prop:function(t,e){if(null!=t)return null!=e||"object"==typeof t?(_xyt.prop(this.domList,t,e),this):""!=t.trim()?_xyt.prop(this.domList,t):void 0},data:function(t,e){if(null!=t)return 2<=arguments.length?(_xyt.data(this.domList,t,e),this):_xyt.data(this.domList,t)},removeAttr:function(t){return _xyt.removeAttr(this.domList,t),this},val:function(t){return null==t?_xyt.val(this.domList):(_xyt.val(this.domList,t),this)},remove:function(t){t=_xyt.remove(this.domList,t);return t!=this.domList&&(this.domList=t,this.length=this.domList.length),this},each:function(t){return _xyt.each(this.domList,t),this},css:function(t,e){return null==e&&"object"!=typeof t?_xyt.css(this.domList,t):(_xyt.css(this.domList,t,e),this)},print:function(t){return _xyt.printHTML(t)},debug:function(t){return _xyt.debug(t),this}}),xiyueta.fn.extend({eq:function(t){return this.domListArray.push({domList:this.domList,length:this.length,selector:this.selector}),this.domList=_xyt.eq(this.domList,t),this.selector="",this.length=0,""!=this.domList&&(this.length=1),this},first:function(){return this.eq(0),this},last:function(){return this.eq(-1),this},even:function(){this.domListArray.push({domList:this.domList,length:this.length,selector:this.selector});for(var t,e=-1,r=[],s=0;s<this.domList.length;s++)s%2==0&&((t=this.domList[s]).index=++e,r.push(t));return this.domList=r,this.length=r.length,this},odd:function(){this.domListArray.push({domList:this.domList,length:this.length,selector:this.selector});for(var t,e=-1,r=[],s=0;s<this.domList.length;s++)s%2==1&&((t=this.domList[s]).index=++e,r.push(t));return this.domList=r,this.length=r.length,this},slice:function(t,e){return this.domListArray.push({domList:this.domList,length:this.length,selector:this.selector}),this.domList=_xyt.slice(this.domList,t,e),this.length=this.domList.length,this},end:function(){var t;return this.domListArray.length<=0?(this.domList="",this.length=0,this.selector=""):(t=this.domListArray[this.domListArray.length-1],this.domList=t.domList,this.length=t.length,this.selector=t.selector,this.domListArray.pop()),this},addClass:function(t){return _xyt.addClass(this.domList,t),this},hasClass:function(t){return _xyt.hasClass(this.domList,t)},removeClass:function(t){return _xyt.removeClass(this.domList,t),this},wrap:function(t,e){if("function"==typeof t){for(var r=_xyt.each(this.domList,t),s=0;s<=r.length-1;s++)(u=r[s])&&this.wrap(u.value,u.domList);return this}var l=new _XIYUETA,i=0,n=(l.parseHTML(t),l.repairHTML(!1),l.printHTML());t!=n&&l.parseHTML(n);for(s=0;s<=l.htmlArr.length-1;s++)(u=l.htmlArr[s]).lv>i&&2==u.tagpair&&(i=u.lv);for(var h="",a="",o=!1,s=0;s<=l.htmlArr.length-1;s++){var u,f=(u=l.htmlArr[s]).upHtml;"/"==u.label.substr(0,1)&&u.lv==i&&(o=!0,h+=f,f=""),0==o?h+=f+u.html:a+=f+u.html}return null==e&&(e=this.domList),_xyt.wrap(e,h,a),this},unwrap:function(){return _xyt.unwrap(this.domList),this},append:function(t){return _xyt.append(this.domList,t),this},prepend:function(t){return _xyt.prepend(this.domList,t),this},after:function(t){return _xyt.after(this.domList,t),this},before:function(t){return _xyt.before(this.domList,t),this},show:function(){return _xyt.show(this.domList),this},hide:function(){return _xyt.hide(this.domList),this},next:function(){return this.domListArray.push({domList:this.domList,length:this.length,selector:this.selector}),this.domList=_xyt.next(this.domList),this.length=this.domList.length,this},nextAll:function(){return this.domListArray.push({domList:this.domList,length:this.length,selector:this.selector}),this.domList=_xyt.nextAll(this.domList),this.length=this.domList.length,this},prev:function(){return this.domListArray.push({domList:this.domList,length:this.length,selector:this.selector}),this.domList=_xyt.prev(this.domList),this.length=this.domList.length,this},prevAll:function(){return this.domListArray.push({domList:this.domList,length:this.length,selector:this.selector}),this.domList=_xyt.prevAll(this.domList),this.length=this.domList.length,this},siblings:function(){return this.domListArray.push({domList:this.domList,length:this.length,selector:this.selector}),this.domList=_xyt.prevAll(this.domList,"asc").concat(_xyt.nextAll(this.domList)),this.length=this.domList.length,this},parent:function(){return this.domListArray.push({domList:this.domList,length:this.length,selector:this.selector}),this.domList=_xyt.parent(this.domList),this.length=this.domList.length,this},parents:function(){return this.domListArray.push({domList:this.domList,length:this.length,selector:this.selector}),this.domList=_xyt.parents(this.domList),this.length=this.domList.length,this},children:function(){return this.domListArray.push({domList:this.domList,length:this.length,selector:this.selector}),this.domList=_xyt.children(this.domList),this.length=this.domList.length,this},closest:function(t){return this.domListArray.push({domList:this.domList,length:this.length,selector:this.selector}),this.domList=_xyt.closest(this.domList,t),this.length=this.domList.length,this},filter:function(t){return this.domListArray.push({domList:this.domList,length:this.length,selector:this.selector}),this.domList=_xyt.filter(this.domList,t),this.length=this.domList.length,this},replaceWith:function(t){var e;return"object"==typeof(t=null==t?"":t)&&null!=t.domList&&(e=t.domList,t=_xyt.htmlwrap(t.domList,""),_xyt.remove(e)),this.htmlwrap(t),this},index:function(){return("array"==_xyt.toType(this.domList)?this.domList[0]:this.domList).index},get:function(t){var e;return 1<=arguments.length?(e=[],"array"==_xyt.toType(this.domList)?e=this.domList:e.push(this.domList),e[t=t<0?e.length+t:t]):0!=this.domList.length?this.domList:void 0},toArray:function(){return this.domList},empty:function(){return this.html("")},htmlwrap:function(t){return 1<=arguments.length?(_xyt.htmlwrap(this.domList,t),this):_xyt.htmlwrap(this.domList)},dom:function(t){return _xyt.dom(this.domList,"",t)},domwrap:function(t){return _xyt.dom(this.domList,"all",t)},domlabel:function(t,e){return _xyt.dom(this.domList,"label|",t,e)},domlabelwrap:function(t,e){return _xyt.dom(this.domList,"all|label",t,e)},getlabel:function(){return _xyt.getLabel(this.domList)},getlv:function(){return _xyt.getlv(this.domList)},findlv:function(t){return this.find(":lv("+t+")"),this}}),_XIYUETA.prototype.checkTagAttrExist=function(t,e){null==this.tagNameAttrArr&&(this.tagNameAttrArr=[{name:"|a|",value:"|id|class|name|style|href|title|type|shape|coords|target|",count:1},{name:"|map|",value:"|id|class|name|style|title|",count:1},{name:"|area|",value:"|id|class|style|href|title|alt|shape|coords|target|",count:1},{name:"|img|",value:"|id|class|name|style|src|title|alt|width|height|border|",count:1},{name:"|audio|",value:"|id|class|style|src|title|loop|",count:1},{name:"|base|",value:"|id|class|style|href|title|target|",count:1},{name:"|body|",value:"|id|class|style|title|background|",count:1},{name:"|basefont|",value:"|id|class|style|title|color|size|",count:1},{name:"|button|",value:"|id|class|name|style|title|type|",count:1},{name:"|video|",value:"|id|class|style|src|title|loop|width|height|",count:1},{name:"|input|",value:"|id|class|name|style|src|title|alt|type|width|height|",count:1},{name:"|select|",value:"|id|class|name|style|title|size|",count:1},{name:"|form|",value:"|id|class|name|style|title|action|method|target|",count:1},{name:"|table|table|",value:"|id|class|style|title|width|border|",count:2},{name:"|ol|ul|li|",value:"|id|class|style|title|type|",count:3},{name:"|td|canvas|th|td|",value:"|id|class|style|title|width|height|",count:4},{name:"|abbr|acronym|address|div|span|b|p|br|tr|article|h1|h2|h3|h4|h5|h6|h7|h8|h9|aside|head|title|bdi|bdo|big|blockquote|caption|center|cite|em|strong|dfn|code|samp|kbd|var|wbr|",value:"|id|class|style|title|",count:37}]);for(var r=0;r<this.tagNameAttrArr.length;r++){var s=this.tagNameAttrArr[r];if(-1<s.name.indexOf("|"+t+"|")&&-1<s.value.indexOf("|"+e+"|"))return!0}return-1<"|id|class|title|style|".indexOf("|"+e+"|")},_XIYUETA.prototype.swap=function(t,e){if(null==t||null==e)return!1;"object"==this.toType(t)&&(t=[t]);var r=[],r="object"==this.toType(r)?null!=r.domList?r.domList:[r]:this.getDocument(e);if(0==t.length||0==r.length||t==r)return!1;var e=t[0],t=r[0],r=this.htmlwrap(e),s=this.htmlwrap(t);return this.htmlwrap(e,s),this.htmlwrap(t,r),!0},_XIYUETA.prototype.getItem=function(t,e){if(null==t)return"";null==e&&(e=""),"object"==this.toType(t)&&(t=[t]);for(var r=[],s=0;s<t.length;s++){obj=t[s];var l=!0;""!=e?(obj.value=this.handleLabelParam(this.htmlArr[obj.x],e),null==obj.value&&(l=!1)):obj.value=this.htmlwrap(obj),l&&r.push(obj)}return r},_XIYUETA.prototype.setConfig=function(t){if(null==t)return this.config;null!=t.httpurl&&(this.config.httpurl=t.httpurl),null!=t.serverurl&&(this.config.serverurl=t.serverurl),null!=t.jsdir&&(this.config.jsdir=t.jsdir),null!=t.cssdir&&(this.config.cssdir=t.cssdir),null!=t.imagesdir&&(this.config.imagesdir=t.imagesdir),null!=t.urlToNameList&&(this.config.urlToNameList=t.urlToNameList),null!=t.urlDefaultFileName&&(this.config.urlDefaultFileName=t.urlDefaultFileName)},_XIYUETA.prototype.charset=function(t){for(var e=0;e<=this.htmlArr.length-1;e++){var r=this.htmlArr[e];if(null!=r)if("meta"==r.label)if(-1!=r.html.toLowerCase().indexOf("charset=")){var s=this.handleLabelParam(r,"charset");if(null!=(s=null!=s?s.toLowerCase().trim():s))return null!=t&&this.handleLabelParam(r,"charset",t),s;if(-1!=(s=null!=(s=this.handleLabelParam(r,"content"))?s.toLowerCase().trim():s).indexOf("utf-8"))return null!=t?(this.handleLabelParam(r,"content","text/html; charset="+t),""):"utf-8";if(-1!=s.indexOf("gb2312"))return null!=t?(this.handleLabelParam(r,"content","text/html; charset="+t),""):"gb2312"}}},_XIYUETA.prototype.getHandleSrc=function(t,e,r,s){for(var l="",i=!0,n=0;n<=this.htmlArr.length-1;n++){var h,a,o,u=this.htmlArr[n];null!=u&&-1!=("|"+t+"|").indexOf("|"+u.label+"|")&&(null==(h=this.handleLabelParam(u,e))&&(h=""),"link"!=u.label||"dns-prefetch"!=(a=(a=null==(a=this.handleLabelParam(u,"rel"))?"":a).trim().toLowerCase())&&"alternate"!=a||(h=""),-1!=("|"+r+"|").indexOf("clean")?(i=!0,""!=h&&-1==h.indexOf("apps.bdimg.com/")&&(o=h=this.common.fullHttpUrl(s,h),-1!=("|"+r+"|").indexOf("web")&&""!=(h=this.common.getUrlFileName(h,u.label))&&("img"==u.label?h=this.config.imagesdir+h:"script"==u.label?h=this.config.jsdir+h:"link"==u.label?-1!=(a=(a=null==(a=this.handleLabelParam(u,"rel"))?"":a).trim().toLowerCase()).indexOf("shortcut icon")?h=this.config.imagesdir+h:-1!=a.indexOf("stylesheet")?h=this.config.cssdir+h:(h="",i=!1):(i=!1,h="")),i&&""!=h&&(-1!=("|"+r+"|").indexOf("down")?(""!=l&&(l+="[,]"),l+=o+"[|]"+h):(""!=l&&(l+="[,]"),l+=h)),this.handleLabelParam(u,e,h))):""!=h&&(""!=l&&(l+="[,]"),l+=h))}return l},_XIYUETA.prototype.replace=function(t,e,r,s){for(var l,i=this.getDocument(t),n=i.split(","),h=1;h<=n.length-1;h++)l=-1!=(i=n[h]).indexOf("|")?(l=i.split("|"),this.htmlArr[l[0]]):this.htmlArr[i],""!=e&&(i=this.handleLabelParam(l,e))==r&&this.handleLabelParam(l,e,s)},_XIYUETA.prototype.repairHTML=function(t,e){null==t&&(t=!1),null==e&&(e=0);var r=0,s=!1,l="",i=0,n=",";if(1<=this.htmlArr.length&&"no"==(h=this.htmlArr[0]).isFindDom)return!1;for(var h,a=0;a<=this.htmlArr.length-1;a++)(h=this.htmlArr[a])&&2==h.tagpair&&("/"==h.label.substr(0,1)?(f=h.label.substr(1),-1!=(","+n+",").indexOf(","+f+",")?n=n.replace(","+f+",",","):n+=h.label+","):n+=h.label+",");for(var o=n,a=0;a<this.htmlArr.length;a++)if((h=this.htmlArr[a])&&2==h.tagpair&&"/"==h.label.substr(0,1)){var u,f=h.label.substr(1),s=!0;if(null!=(u=this.upFindSameLvObj(a,h))&&(h.label=="/"+u.label?(s=!1,this.setNoFindDom(u._index,h._index),1==e&&console.log(" 找(Lv1) "+h.label+" "+u.label+"("+h._index+"-"+u._index+")")):0==this.lv||1==u.lv&&1==h.lv&&-1==n.indexOf(","+h.label+",")?1==s&&(l="",t&&(l="\x3c!--xiyueta提示: 原标签(LV) "+h.label+" 替换成 /"+u.label+"--\x3e"),h.html="</"+u.label+">"+l,r+=2,i+=2,s=!1,this.setNoFindDom(u._index,h._index),1!=e&&2!=e||console.log(" 找(Lv2) LV整体层级正确或两标签都为第一层  "+h.label+" 替换成 /"+u.label+" ("+h._index+"-"+u._index+")")):1==e&&console.log(" 找(Lv else) 没找到，交给下面找同名 "+h.label+" ("+h._index+")")),1==s)if(null==(u=this.upFindSameNameObj(a,h)))h.html=t?"\x3c!---xiyueta提示: 有多余结束标签 "+h.label+" --\x3e":"",i++,r++,this.setNoFindDom(h._index,h._index),this.reairHtmlLv(h,1),1!=e&&2!=e||console.log(" 找(Name 出错) 有多余结束标签 "+h.label+" ("+h._index+")"),s=!1,n=n.replace(","+h.label+",",",");else{l="",t&&(u.html+="\x3c!---xiyueta提示: 有问题标签开始位置--\x3e",h.html="\x3c!---xiyueta提示: 有问题标签结束位置--\x3e"+h.html),1!=e&&2!=e||console.log(" 找(Name2 有问题) "+h.label+" 与 "+u.label+"("+h._index+"-"+u._index+") 之间有问题 ");var m="",c=(this.setNoFindDom(u._index,h._index),u.lv-h.lv);this.reairHtmlLv(h,c);for(var d=u._index+1;d<=h._index;d++){var g=this.htmlArr[d];if(g&&"/"!=g.label.substr(0,1)&&2==g.tagpair){var b=!1;for(p=g._index+1;p<=h._index;p++){var x=this.htmlArr[p];if(x&&2==x.tagpair&&"/"==x.label.substr(0,1)&&x.lv==g.lv){b=!0;break}}0==b&&(m+="</"+g.label+">",t&&(m+="\x3c!--xiyueta提示: 追加 /"+g.label+" --\x3e"),1!=e&&2!=e||console.log(" 找(Name3)  追加结束标签 /"+g.label+" ("+g._index+")"),i++,r++,n=n.replace(","+g.label+",",","))}}h.upHtml+=m}}var y=n.split(",");if(y.length>r){m="";for(a=0;a<y.length;a++)""!=y[a]&&"/"!=y[a].substr(0,1)&&(l="",t&&(l="\x3c!--xiyueta提示: 追加 /"+y[a]+" --\x3e"),m="</"+y[a]+">"+l+m,i++,r++,1!=e&&2!=e||console.log(" 最后  追加结束标签 /"+y[a]));this.htmlArr[this.htmlArr.length-1]&&(this.htmlArr[this.htmlArr.length-1].downHtml+=m)}return{lv:this.lv,err:i,repair:r,state:i==r,errList:o=","==o?"":o}},_XIYUETA.prototype.setNoFindDom=function(t,e){for(var r=t;r<=e;r++){var s=this.htmlArr[r];s&&(s.isFindDom="no")}return null},_XIYUETA.prototype.upFindSameLvObj=function(t,e){for(var r=t-1;0<=r;r--){var s=this.htmlArr[r];if(s&&"no"!=s.isFindDom&&e.lv==s.lv)return s}return null},_XIYUETA.prototype.upFindSameNameObj=function(t,e){for(var r=t-1;0<=r;r--){var s=this.htmlArr[r];if(s&&"no"!=s.isFindDom&&e.label=="/"+s.label)return s}return null},_XIYUETA.prototype.reairHtmlLv=function(t,e){for(var r=t._index;r<=this.htmlArr.length-1;r++)(t=this.htmlArr[r])&&(t.lv+=e)},_XIYUETA.prototype.htmlColor=function(t){if("</"==t.substr(0,2))return"<font color='#800000'>"+t.replace("<","&lt;").replace(">","&gt;")+"</font>";if("<"!=t.substr(0,1))return"<font color='#000000'>"+t+"</font>";if("\x3c!--"==t.substr(0,4))return"<font color='#008000'>"+t.replace("<","&lt;").replace(">","&gt;")+"</font>";for(var e="",r="",s="",l=!1,i="",n="",h="",a=0;a<=t.length-1;a++){var o=t.substr(a,1);"findValueStart"==i?(l?o==s||">"==o?(n+=h+"<font color='#0000FF'>"+r+h+"</font>",l=!1,h=s=h="",i="findParamStart"):r+=o:'"'==o||"'"==o?(h+=o,s=o,l=!0):" "!=o?(s=" ",r=o,l=!0):h+="&nbsp;",">"==o&&(n+="<font color='#800000'>&gt;</font>")):"<"==o?(h="&lt;",i="findLabel"):"findLabel"==i?" "==o?(n+="<font color='#800000'>"+h+"</font> ",h="",i="findParamStart"):">"==o?n+="<font color='#800000'>"+h+"&gt;</font>":h+=o:">"==o?n+="<font color='#800000'>&gt;</font>":"findParamEnd"==i?"="==o?(i="findValueStart",n+="<font color='#FF0000'>"+e+"</font><font color='#000000'>=</font>",e=s=r=""):e+=o=" "==o?"&nbsp;":o:(i="findParamEnd",e+=o=" "==o?"&nbsp;":o)}return n},xiyueta.fullurl=function(t,e){return _xyt.common.fullHttpUrl(t,e)},xiyueta.resolve=function(t,e){return _xyt.common.fullHttpUrl(t,e)},xiyueta.getUrlDir=function(t,e){return _xyt.common.getUrlDir(t,e)},xiyueta.getUrlFileName=function(t,e){return _xyt.common.getUrlFileName(t,e)},xiyueta.setFileNameA=function(t,e){return _xyt.common.setFileNameA(t,e)},xiyueta.getUrlToFileName=function(t,e,r){return _xyt.common.getUrlToFileName(t,e,r)},xiyueta.getUrlParam=function(t,e){return _xyt.common.getUrlParam(t,e)},xiyueta.bystesLength=function(t){return _xyt.common.bystesLength(t)},xiyueta.renderSize=function(t){return _xyt.common.renderSize(t)},xiyueta.secondToDate=function(t){return _xyt.common.secondToDate(t)},xiyueta.timeFormat=function(t,e){var r=new Date,s="yyyy-MM-dd hh:mm:ss";return 1==arguments.length?"object"==typeof t?r=t:"string"==typeof t&&(s=t):2==arguments.length&&("object"==typeof t&&(r=t),"string"==typeof e&&(s=e)),_xyt.common.timeFormat(r,s)},xiyueta.getDomain=function(t){return _xyt.common.getDomain(t)},xiyueta.htmlColor=function(t){return _xyt.htmlColor(t)},xiyueta.lv=function(){return _xyt.lv},xiyueta.htmlerr=function(){return _xyt.isHtmlErr},xiyueta.config=function(t){t=_xyt.setConfig(t);return null==t?this:t},xiyueta.charset=function(t){return null==t?_xyt.charset():(_xyt.charset(t),this)},xiyueta.toType=function(t){return _xyt.toType(t)},xiyueta.delHtml=function(t){var e=new _XIYUETA;return e.parseHTML(t),e.getDelHtml()},xiyueta.debug=function(t){return xiyueta().debug(t)},xiyueta.load=function(t,e){return xiyueta().parse(t,e),this},xiyueta.html=function(t){return _xyt.printHTML(t)},xiyueta.log=function(t,e){if(null==e&&(e="<br>"),"object"==typeof t)for(var r in t){var s;-1==(t[r]+"").indexOf("function")&&(s=(s=t[r]+"").replace(/</g,"&lt;").replace(/\n/g,"<br>").replace(/ /g,"&nbsp;"),void 0===(s="object"==typeof t[r]?xiyueta.log(t[r]," , "):s)?response.write(r+e):response.write(r+":  "+s+e))}else t+="",response.write(t.replace(/</g,"&lt;").replace(/\n/g,"<br>").replace(/ /g,"&nbsp;")+e)},xiyueta.fn.extend({swap:function(t){return _xyt.swap(this.domList,t),this},item:function(t){return _xyt.getItem(this.domList,t)},handle:function(t,e,r){return _xyt.getHandleSrc(this.selector,t,e,r)},replace:function(t,e,r){return _xyt.replace(this.selector,t,e,r)},clear:function(){return this},repair:function(t,e){return _xyt.repairHTML(t,e)}}),function(t){"use strict";this.cssSource=t=null==t?"":t,this.cssArr=[],this.common=new XiyuetaCommon,this.lv=0,this.config={parentdir:"../",imagesdir:"images/"};for(var e={},r="Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),s=0;s<r.length;s++){var l=r[s];e["[object "+l+"]"]=l.toLowerCase()}this.toType=function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?e[Object.prototype.toString.call(t)]||"object":typeof t},this.cssParse=function(t){null!=t&&(this.cssSource=t,this.cssArr=[]);for(var e,r="",s="",l="",i="",n=!1,h=!1,a=!1,o=!1,u=!1,f=0,m=-1,c=0;c<=this.cssSource.length-1;c++)e=r,r=this.cssSource.substr(c,1),n?(l+=r,a?"/"==r&&"*"==e&&(n=a=!1,this.cssArr.push({_index:++m,lv:1,label:"/*",upHtml:i,downHtml:"",html:l}),i=l=""):h&&"*"==r&&"/"==e?a=!0:o?!u||";"!=r&&"\n"!=r?" "==r&&h?"@charset "==l.toLowerCase()||"@import "==l.toLowerCase()?h=!(u=!0):"@font-face "==l.toLowerCase()&&(o=!1):"{"==r&&("@font-face{"==l.toLowerCase()?o=!1:(o=n=h=!1,this.cssArr.push({_index:++m,lv:1,label:this.handleClsCssLabel(s),upHtml:i,downHtml:"",html:l}),f++,i=l="")):(o=n=h=u=!1,this.cssArr.push({_index:++m,lv:1,label:this.handleClsCssLabel(s),upHtml:i,downHtml:"",html:l}),i=l=""):"{"==r&&h?h=!1:"}"==r&&(n=h=!1,this.cssArr.push({_index:++m,lv:f+1,label:this.handleClsCssLabel(s),upHtml:i,downHtml:"",html:l}),i=l=""),h&&(s+=r)):" "!=r&&";"!=r&&"\n"!=r&&"\t"!=r?"}"==r&&1==f?(this.cssArr.push({_index:++m,lv:f,label:"}",upHtml:i,downHtml:"",html:"}"}),i=l="",f--):(i=l,h=n=!0,"@"==(s=l=r)&&(o=!0)):l+=r;""!=l&&this.cssArr.push({_index:++m,lv:f,label:"",upHtml:"",downHtml:"",html:l}),this.lv=f},this.handleClsCssLabel=function(t){for(var e=0;e<9&&-1!=(t=t.replace(/  /g," ")).indexOf("  ");e++);return(t=t.replace(/\n/g,"")).toLowerCase().trim()},this.handleLabelParam=function(t,e,r){if(null==e&&(e="(all)"),null==r&&null!=t[e])return t[e];var s,l="";-1!=e.indexOf("|")&&(e=(s=e.split("|"))[0],l=s[1],""==e&&(e="(all)"));for(var i=!1,n="",h="",a=!1,o="",u=!1,f=!0,m=0,c=0,d=!1,p="",g=t.html.indexOf("{")+1;g<=t.html.length-1;g++){var b=t.html.substr(g,1);if(a)if(u){if(0!=(d=1==d&&")"==b?!1:d)||b!=o&&"}"!=b&&g!=t.html.length-1)h+=b,"("==b&&(d=!0);else if(t[n=n.toLowerCase().trim()]=h,u=a=!1,o="",e==n||"(all)"==e)if(null==r){if("url"!=l)return h;""!=(h=this.cssSrcUrl(h))&&(""!=p&&(p+="\n"),p+=h)}else{if(""==r)return v=t.html.substr(0,c),L=-1<(L=t.html.substr(g).indexOf(";"))?t.html.substr(g+L+1):t.html.substr(g),t.html=v+L,t;var x=m,y=m+h.length,v=(f&&(x++,y++),t.html.substr(0,x)),L=t.html.substr(y);if("url"!=l)return t.html=v+r+L,t[n]=r,t;x=this.cssSrcUrl(h,r);if(""!=x)return""!=p&&(p+="\n"),p+=x,t.html=v+x+L,g=(v+(t[n]=x)).length,t}}else" "!=b&&(o=";",m=g,f=!(u=!0),h=b);else i?":"==b?(a=!(i=!1),o=h=""):" "!=b&&(n+=b):" "!=b&&(i=!0,n=b,c=g)}if(null!=r&&""!=r&&""==l){for(var A=e+": "+r+";",_=t.html.length-1;0<=_;_--)if(" "!=(b=t.html.substr(_,1))&&"}"!=b){if(";"==b)break;if("{"==b)break;A="; "+A;break}t.html=t.html.replace("}",A+"}")}return p=""==p?void 0:p},this.getDocument=function(t,e,r){null==e&&(e=0),null==r&&(r=this.cssArr.length-1);var s=-1.1,l=-1.1,i=-1.1,n=-1.1,h="",a="",o="",u="",f="";if(t=(t=null==t?"":t).trim(),0==this.cssArr.length)return console.log("%c 需要先解析一段css文本","font-size:14px;color:#FF3300"),"";if(-1!=t.indexOf("'")||-1!=t.indexOf('"')||-1!=t.indexOf("(")){for(var m=!1,c="",d=0;d<=t.length;d++){var p=t.substr(d,1);0!=m||"'"!=p&&'"'!=p&&"("!=p&&")"!=p?1==m?" "==p?p="-Space-":"'"!=p&&'"'!=p&&"("!=p&&")"!=p||(m=!1,"'"!=p&&'"'!=p||(p="")):" "==p&&(p=""):(m=!0,"'"!=p&&'"'!=p||(p="")),c+=p}t=c}var g,b,x,y,v=t.indexOf(":");-1!=v&&(x=y="",b=(p=t.substr(v+1)).indexOf("("),g=p.indexOf(")"),-1!=b&&-1!=g?(y=p.substr(0,b).toLowerCase(),g=(x=p.substr(b+1)).indexOf(")"),x=x.substr(0,g).replace(/-Space-/g," ").trim()):y=p.toLowerCase(),"first"==y?s=0:"last"==y?s=-1:"even"==y?l=1:"odd"==y?l=0:"eq"==y?(s=0,(s=""!=x?parseInt(x):s)+""=="NaN"&&(s=-.1,t="")):"gt"==y?""!=x&&(i=parseInt(x)):"lt"==y?""!=x&&(n=parseInt(x)):"contains"==y?h=x:console.log(t,"没有动作 "+y),""==(t=t.substr(0,v))&&-.1!=s&&(t="(all)")),-1!=(v=t.indexOf("["))&&(g=(p=t.substr(v+1)).indexOf("]"),-1==(p=p.substr(0,g)).indexOf("=")?(a=p,o="*"):(a=(b=p.split("="))[0],o=b[1].replace(/-Space-/g," "),x=a.substr(a.length-1),-1!="!^$*~|".indexOf(x)&&(a=a.substr(0,a.length-1),u=x)),-1!=a.indexOf("|")&&(a=(y=a.split("|"))[0],"NOUL"==y[1]&&(o=o.toLowerCase(),f=y[1])),""==(t=t.substr(0,v))&&(t="(all)"));for(d=0;d<10&&-1!=t.indexOf("  ");d++)t=t.replace(/  /g," ");for(c="",d=e;d<=r;d++){var L=this.cssArr[d];null!=L&&(t==L.label||"(all)"==t&&""!=L.label)&&(c+=","+d)}if(""!=c&&-1.1!=s){var A=c.split(",");""!=(c=s<0?A[A.length+s]:A[s+1])&&(c=","+c)}else if(""!=c&&-1.1!=l){A=c.split(",");c="";for(d=1;d<=A.length-1;d++)d%2==l&&(c+=","+A[d])}else if(""!=c&&-1.1!=i){A=c.split(",");c="";for(d=i+2;d<=A.length-1;d++)c+=","+A[d]}else if(""!=c&&-1.1!=n){A=c.split(",");c="",n>A.length-1&&(n=A.length-1);for(d=1;d<=n;d++)c+=","+A[d]}else if(""!=c&&""!=h){A=c.split(",");c="";for(d=1;d<=A.length-1;d++){p=A[d];-1!=this.text(","+p).indexOf(h)&&(c+=","+A[d])}}else if(""!=a){A=c.split(",");c="";for(d=1;d<=A.length-1;d++){var _=A[d],O=!0,p=this.css(domList=","+_);"NOUL"==f&&null!=p&&(p=p.toLowerCase()),"^"==u?null!=p&&p.substr(0,o.length)==o||(O=!1):"|"==u?null!=p&&(p+"-").substr(0,o.length+1)==o+"-"||(O=!1):"$"==u?null!=p&&p.substr(-1*o.length)==o||(O=!1):"~"==u?null!=p&&-1!=(" "+p+" ").indexOf(" "+o+" ")||(O=!1):"*"==u?null!=p&&-1!=p.indexOf(o)||(O=!1):"!"==u?p==o&&(O=!1):null!=p&&"*"==o?O=!0:p!=o&&(O=!1),O&&(c+=","+_)}}for(var w=c.split(","),C=[],d=0;d<w.length;d++)""!=w[d]&&C.push({index:w[d],x:w[d],y:w[d]});return C},this.handleDomList=function(t){return"object"==this.toType(t)?null!=t.domList?t.domList:null!=t._index?[{index:t._index,x:t._index,y:t._index}]:[t]:"string"==this.toType(t)?this.getDocument(t):t},this.each=function(t,e){if("function"!=typeof e)return!1;t=this.handleDomList(t);for(var r=[],s=0;s<t.length;s++){var l=t[s],i=e.call(l,s,l);if(l.value=i,r.push(l),"boolean"==typeof i&&0==i)break}return r},this.text=function(t,e){var r="get",t=this.handleHtmlText(t,e,"text",r=2<=arguments.length?"set":r);return t=null==t?"":t},this.html=function(t,e){var r=2<=arguments.length?"set":"get";return this.handleHtmlText(t,e,"html",r)},this.htmlwrap=function(t,e){var r=2<=arguments.length?"set":"get";return this.handleHtmlText(t,e,"htmlwrap",r)},this.getBackground=function(t,e){var r="get",t=this.handleHtmlText(t,e,"background",r=2<=arguments.length?"set":r);return t=null==t?"":t},this.handleHtmlText=function(t,e,r,s){if(null!=t){t=this.handleDomList(t);var l=this.toType(e);if("function"==l){for(var i=this.each(t,e),n=0;n<i.length;n++)i[n]&&this.handleHtmlText(i[n],i[n].value,r,s);return!1}if("set"==s){if("undefined"==l)return;null==e?e="":e+=""}for(var h="",n=0;n<t.length;n++){var a=this.cssArr[t[n].index];if(null!=a)if("htmlwrap"==r){if("get"==s)return a.html;a.html=e}else if("background"==r){var o,u=this.css(a,"background");"get"==s?null!=u&&(o=this.cssSrcUrl(u),h+=this.handleClearBackground(o)):null!=u&&(o=u,"server="==e.substr(0,7)?(o=this.handleClearBackground(o),e=this.common.fullHttpUrl(e.substr(7),o)):"dir="==e.substr(0,4)&&(o=this.handleClearBackground(o),e=e.substr(4)+this.common.getUrlFileName(o)),e=this.cssSrcUrl(u,e),this.css(a,"background",e))}else if("@charset"==a.label)if("get"==s){if(h+=a.html.substr(9).replace(/"/g,"").replace(/'/g,"").replace(/;/g,"").trim(),"html"==r)return h}else a.html='@charset "'+e+'";';else if("@import"==a.label)if("get"==s){u=(u=a.html.substr(8)).replace(/"/g,"").replace(/'/g,"").replace(/;/g,"").trim();if(h+=u=this.handleClearBackground(u),"html"==r)return h}else a.html='@import url("'+e+'");';else{var f=a.html.indexOf("{"),m=a.html.indexOf("}");if("get"==s){if(-1!=f&&-1!=m&&(h+=a.html.substr(f+1,m-f-1)),"html"==r)return h}else a.html=a.html.substr(0,f+1)+e+"}"}}return h}},this.css=function(t,e,r){if(null!=t){t=this.handleDomList(t);var s=this.toType(r);if("function"==s){for(var l=this.each(t,r),i=0;i<l.length;i++)l[i]&&this.css(l[i],e,l[i].value);return!1}var n=3<=arguments.length?"set":"get";if("set"==n){if("undefined"==s)return;null==r?r="":r+=""}for(i=0;i<t.length;i++){var h=this.cssArr[t[i].index];if(null!=h){if("get"==n)return this.handleLabelParam(h,e);this.handleLabelParam(h,e,r)}}}},this.remove=function(t){if(null!=t){t=this.handleDomList(t);for(var e=0;e<t.length;e++){var r=this.cssArr[t[e].index];null!=r&&(r.html="",r.label="<del>")}return this}},this.getsrc=function(t,e){if(null!=t){t=this.handleDomList(t);for(var r="",s=0;s<t.length;s++){var l=this.cssArr[t[s].index];if(null!=l){var l=this.text(l),i=this.cssSrcUrl(l),i=this.handleClearBackground(i);if(null!=e)for(var n=i.split(","),h=0;h<=n.length-1;h++)""!=(i=n[h])&&("server="==e.substr(0,7).toLowerCase()?i=this.common.fullHttpUrl(e.substr(7),i):"dir="==e.substr(0,4).toLowerCase()?i=e.substr(4)+this.common.getUrlFileName(i):"filename"==e.substr(0,8).toLowerCase()&&(i=this.common.getUrlFileName(i)),""!=r&&(r+=","),r+=i);else""!=i&&(""!=r&&(r+=","),r+=i)}}return r}},this.setsrc=function(t,e,r){if(null!=t){t=this.handleDomList(t);var s=this.toType(e);if("function"==s){for(var l=this.each(t,e),i=0;i<l.length;i++)l[i]&&this.setsrc(l[i],l[i].value);return!1}if("undefined"!=s){null==e?e="":e+="";for(i=0;i<t.length;i++){var n=this.cssArr[t[i].index];if(null!=n){for(var h="",a=this.text(n),o=a.split(";"),u=0;u<=o.length-1;u++){var f=o[u];""!=h&&(h+=";"),h+=this.cssSrcUrl(f,e)}a!=h&&this.text(n,h)}}return this}}},this.handleClearBackground=function(t){var e=t.indexOf("(");if(-1==(t=-1!=(e=(t=-1!=e?t.substr(e+1):t).indexOf(")"))?t.substr(0,e):t).indexOf("'")&&-1==t.indexOf('"')&&-1==t.indexOf("("))return t;for(var r=!1,s="",l=0;l<=t.length;l++){var i=t.substr(l,1);0!=r||"'"!=i&&'"'!=i&&"("!=i&&")"!=i?1==r?"'"!=i&&'"'!=i&&"("!=i&&")"!=i||(r=!1,"'"!=i&&'"'!=i||(i="")):" "==i&&(i=""):(r=!0,"'"!=i&&'"'!=i||(i="")),s+=i}return s.trim()},this.cssSrcUrl=function(t,e){if(-1==t.indexOf(","))return this.handleCssSrcUrl(t,e);for(var r=t.split(","),s="",l=0;l<r.length;l++){var i=r[l];""!=(i=this.handleCssSrcUrl(i,e))&&(""!=s&&(s+=","),s+=i)}return s},this.handleCssSrcUrl=function(t,e){if(null==t)return"";if(null==e){if(-1==t.indexOf("(")||-1==t.indexOf(")"))return null!=e&&"dir="!=e.substr(0,4)&&"server="!=e.substr(0,7)?t:"";if(-1==t.toLowerCase().indexOf("url"))return null!=e&&"dir="!=e.substr(0,4)&&"server="!=e.substr(0,7)?t:""}for(var r="",s=!1,l=!1,i="",n=-1,h=0;h<=t.length-1;h++){var a=t.substr(h,1);if(s)if(l){if(i==a){var o=t.substr(n,h-n);if(null!=e)if("server="==e.substr(0,7)){if(-1!=o.indexOf("data:"))return t;o=t.substr(0,n)+this.common.fullHttpUrl(e.substr(7),o)+t.substr(h)}else if("dir="==e.substr(0,4)){if(-1!=o.indexOf("data:"))return t;o=t.substr(0,n)+e.substr(4)+xiyueta.getUrlToFileName(o)+t.substr(h)}else-1==o.indexOf("data:")&&(o=t.substr(0,n)+e+t.substr(h));return o}}else""!=a&&('"'==a||"'"==a?(l=!0,i=a,-1==n&&(n=h+1)):" "!=a&&(l=!0,i=")",-1==n&&(n=h)));else if("("==a){o=r.trim().toLowerCase();if("url"==o.substr(o.length-3,3))s=!0;else if(null==e)return""}else r+=a}return t},this.after=function(t,e){if(null!=t){t=this.handleDomList(t);var r=this.toType(e);if("function"==r){for(var s=this.each(t,e),l=0;l<s.length;l++)s[l]&&this.after(s[l],s[l].value);return!1}if("undefined"!=r){null==e?e="":e+="";for(l=0;l<t.length;l++){var i=this.cssArr[t[l].index];null!=i&&null!=e&&(i.downHtml+=e)}return this}}},this.before=function(t,e){if(null!=t){t=this.handleDomList(t);var r=this.toType(e);if("function"==r){for(var s=this.each(t,e),l=0;l<s.length;l++)s[l]&&this.before(s[l],s[l].value);return!1}if("undefined"!=r){null==e?e="":e+="";for(l=0;l<t.length;l++){var i=this.cssArr[t[l].index];null!=i&&null!=e&&(i.upHtml+=e)}return this}}},this.handleCssCharset=function(t){for(var e=0;e<=this.cssArr.length-1;e++){var r=this.cssArr[e];if(null!=r)if("@charset"==r.label)return null!=t?(r.html='@charset "'+t+'";',""):r.html.substr(9).replace(/"/g,"").replace(/'/g,"").replace(/;/g,"").trim().toLowerCase()}return""},this.handleCssImport=function(t){for(var e=0;e<=this.cssArr.length-1;e++){var r=this.cssArr[e];if(null!=r&&"@import"==r.label){if(null!=t)return r.html='@import url("'+t+'");',"";r=(r=r.html.substr(8)).replace(/"/g,"").replace(/'/g,"").replace(/;/g,"").trim().toLowerCase();return r=this.handleClearBackground(r)}}return""},this.setConfig=function(t){if(null==t)return this.config;if(null!=t.imagesdir&&(this.config.imagesdir=t.imagesdir,null!=t.cssdir)){for(var e=t.cssdir.split("/"),r="",s=0;s<=e.length-2;s++)r+="../";this.config.parentdir=r}null!=t.parentdir&&(this.config.parentdir=t.parentdir)},this.printCss=function(t){for(var e="",r=0;r<=this.cssArr.length-1;r++){var s,l=this.cssArr[r];null!=l&&(s=l.upHtml+l.html+l.downHtml,"zip"==t?s="/*"==l.label?"":s.replace(/  /g," ").replace(/  /g," ").replace(/{ /g,"{").replace(/ {/g,"{").replace(/\n/g,"").trim():"format"==t&&(s=s.trim()+"\n"),""!=s&&(e+=s))}return e},this.debug=function(t){((t=null==t?!1:t)?xiyueta:console).log(this.cssArr)},this.eq=function(t,e){return t=this.handleDomList(t),"array"!=this.toType(t)?[]:(null==e||""==e?e=0:(e=parseInt(e))+""=="NaN"&&(e=-1.1),-1.1!=e?(e=e<0?t.length+e:e)>t.length?"":[t[e]]:[])}}),_xytcss=new _XIYUETACSS,xiyuetaCss=function(t,e,r){return new xiyuetaCss.fn.init(t,e,r)};xiyuetaCss.fn=xiyuetaCss.prototype={length:0,selector:"",docList:void 0,x:null,y:null},xiyuetaCss.extend=xiyuetaCss.fn.extend=function(){var t,e,r,s=arguments[0]||{},l=1,i=arguments.length;for(l===i&&(s=this,l--);l<i;l++)if(null!=(t=arguments[l]))for(e in t)r=t[e],"__proto__"!==e&&s!==r&&void 0!==r&&(s[e]=r);return s};(init=xiyuetaCss.fn.init=function(t,e,r){this.length=0,this.selector=t,this.domList=void 0,this.x=e,this.y=r,this.domListArray=[],0<_xytcss.cssArr.length&&("string"==typeof t?(this.domList=_xytcss.getDocument(t,e,r),this.length=this.domList.length):"object"==typeof t&&(this.domList=t,this.length=1,this.selector="")),null==this.selector&&(this.selector="")}).prototype=xiyuetaCss.fn,(xiyuetaCSS=$xytcss=$css=xiyuetaCss).fn.extend({parse:function(t){return _xytcss.cssParse(t),0<_xytcss.cssArr.length&&"string"==typeof this.selector&&(this.domList=_xytcss.getDocument(this.selector,this.x,this.y),this.length=this.domList.length),this},each:function(t){return _xytcss.each(this.domList,t),this},text:function(t){return 1<=arguments.length?(_xytcss.text(this.domList,t),this):_xytcss.text(this.domList)},html:function(t){return 1<=arguments.length?(_xytcss.html(this.domList,t),this):_xytcss.html(this.domList)},htmlwrap:function(t){return 1<=arguments.length?(_xytcss.htmlwrap(this.domList,t),this):_xytcss.htmlwrap(this.domList)},css:function(t,e){return 2<=arguments.length?(_xytcss.css(this.domList,t,e),this):_xytcss.css(this.domList,t)},background:function(t){return 1<=arguments.length?(_xytcss.getBackground(this.domList,t),this):_xytcss.getBackground(this.domList)},remove:function(){return _xytcss.remove(this.domList),this},getsrc:function(t){return _xytcss.getsrc(this.domList,t)},setsrc:function(t){return _xytcss.setsrc(this.domList,t),this},after:function(t){return _xytcss.after(this.domList,t),this},before:function(t){return _xytcss.before(this.domList,t),this},print:function(t){return _xytcss.printCss(t)},debug:function(t){return _xytcss.debug(t)}}),xiyuetaCSS.fn.extend({eq:function(t){return this.domListArray.push({domList:this.domList,length:this.length,selector:this.selector}),this.domList=_xyt.eq(this.domList,t),this.selector="",this.length=0,""!=this.domList&&(this.length=1),this},first:function(){return this.eq(0),this},last:function(){return this.eq(-1),this},even:function(){this.domListArray.push({domList:this.domList,length:this.length,selector:this.selector});for(var t,e=-1,r=[],s=0;s<this.domList.length;s++)s%2==0&&((t=this.domList[s]).index=++e,r.push(t));return this.domList=r,this.length=r.length,this},odd:function(){this.domListArray.push({domList:this.domList,length:this.length,selector:this.selector});for(var t,e=-1,r=[],s=0;s<this.domList.length;s++)s%2==1&&((t=this.domList[s]).index=++e,r.push(t));return this.domList=r,this.length=r.length,this},slice:function(t,e){return this.domListArray.push({domList:this.domList,length:this.length,selector:this.selector}),this.domList=_xyt.slice(this.domList,t,e),this.length=this.domList.length,this},end:function(){var t;return this.domListArray.length<=0?(this.domList="",this.length=0,this.selector=""):(t=this.domListArray[this.domListArray.length-1],this.domList=t.domList,this.length=t.length,this.selector=t.selector,this.domListArray.pop()),this}}),xiyuetaCSS.debug=function(t){return xiyuetaCSS().debug(t)},xiyuetaCSS.load=function(t,e){return xiyuetaCSS().parse(t,e),this},xiyuetaCSS.html=function(t){return _xytcss.printCss(t)},xiyuetaCSS.charset=function(t){return _xytcss.handleCssCharset(t)},xiyuetaCSS.config=function(t){return _xytcss.setConfig(t)},xiyuetaCSS.lv=function(){return _xytcss.lv};var _XIYUETAASP=function(t){"use strict";this.aspSource=t=null==t?"":t,this.aspArr=[],this.common=new XiyuetaCommon,this.config={},this.phpPublicObjectList="",this.phpPublicFunList="",this.aspParse=function(t){null!=t&&(this.aspSource=t,this.aspArr=[]);for(var e="",r="",s="",l="",i="",n="",h="",a=!1,o=!1,u=0,f="",m=0,c=(this.aspSource=this.aspSource.replace(/\t/g,"  "),this.aspSource.split("\n")),d=0;d<=c.length-1;d++){for(var p,g,b,x=0;x<=c[d].length;x++)if(r=e,e=c[d].substr(x,1),s=c[d].substr(x+1,1),b=c[d].substr(x+1,2),0==a)"%"==e&&"<"==r?(a=!0,this.aspArr.push({lv:u,type:"<asp>",label:"<%",upHtml:h.substr(0,h.length-1),downHtml:"",html:"<%",tagpair:2}),l=h=n="",u++):h+=e;else if("%"==e&&">"==s)a=!1,u--,this.aspArr.push({lv:u,type:"<asp>",label:"%>",upHtml:h,downHtml:"",html:"%>",tagpair:2}),l=h=n="",x++,r=e,e=c[d].substr(x,1),s=c[d].substr(x+1,1);else if(n+=e,'"'==e||""!=f)'"'==e&&m++,m%2==0&&'"'!=s?(f+=e,this.aspArr.push({lv:u,type:"<str>",label:l,upHtml:h,downHtml:"",html:f,tagpair:2}),m=0,l=h=n=f=""):f+=e;else if("("==e)u++,this.aspArr.push({lv:u,type:"<(>",label:e,upHtml:h,downHtml:"",html:n,tagpair:2}),l=h=n="";else if(")"==e)this.aspArr.push({lv:u,type:"<)>",label:e,upHtml:h,downHtml:"",html:n,tagpair:2}),l=h=n="",u--;else if(-1!="|&|,|+|-|*|/|=|:|>|<|".indexOf("|"+e+"|"))this.aspArr.push({lv:u,type:"<fuhao>",label:e,upHtml:h,downHtml:"",html:n,tagpair:1}),"="!=e&&">"!=e||">"!=(g=this.aspArr[this.aspArr.length-2]).label&&"<"!=g.label||(g.label+=e,g.html+=" "+e,this.aspArr.pop()),l=h=n="";else{if("'"==e){this.aspArr.push({lv:u,type:"<note>",label:e,upHtml:n,downHtml:"",html:c[d].substr(x+1),tagpair:1}),l=h=n="";break}""==e||" "==e||"\t"==e||-1=="' ()+-*/=><&,:".indexOf(s)&&x!=c[d].length&&"%>"!=b?" "!=e&&"\t"!=e&&(l+=e.toLowerCase()):(l+=e.toLowerCase(),i=-1!="0123456789".indexOf(l.substr(0,1))?"<int>":"("==s||-1!=",not,strcomp,vbtextcompare,step,dim,if,then,elseif,else,end,function,sub,sele/ct,case,call,for,to,next,set,nothing,do,while,loop,and,true,false,vbcrlf,in,class,new,mod,byval,byref,or,exit,rnd,lcase,ucse,asc,".indexOf(","+l+",")||-1!=l.indexOf(".")?"<fun>":"<var>",this.aspArr.push({lv:u,type:i,label:l,upHtml:h,downHtml:"",html:n,tagpair:2}),"function"==l?"end"==(p=this.aspArr[this.aspArr.length-2]).label?(u--,p.lv--,p.label+="function",p.html+=" function",this.aspArr.pop()):"exit"==p.label?(p.label+="function",p.html+=" function",this.aspArr.pop()):u++:"sub"==l?"end"==(p=this.aspArr[this.aspArr.length-2]).label?(u--,p.lv--,p.label+="sub",p.html+=" sub",this.aspArr.pop()):"exit"==p.label?(p.label+="sub",p.html+=" sub",this.aspArr.pop()):u++:"if"==l?"end"==(p=this.aspArr[this.aspArr.length-2]).label?(u--,p.lv--,p.label+="if",p.html+=" if",this.aspArr.pop()):u++:"else"==l||"elseif"==l||"then"==l?(this.aspArr[this.aspArr.length-1].lv--,"else"==l&&"case"==(p=this.aspArr[this.aspArr.length-2]).label&&(p.lv,p.label+="else",p.html+=" else",this.aspArr.pop())):"select"==l?"end"==(p=this.aspArr[this.aspArr.length-2]).label?(u--,p.lv--,p.label+="select",p.html+=" select",this.aspArr.pop(),o&&(o=!1,u--,p.lv--)):u++:"case"==l?"select"==(g=this.aspArr[this.aspArr.length-2]).label?(g.label+="case",g.html+=" case",this.aspArr.pop()):o?this.aspArr[this.aspArr.length-1].lv--:(u++,o=!0):"class"==l?"end"==(p=this.aspArr[this.aspArr.length-2]).label?(u--,p.lv--,p.label+="class",p.html+=" class",this.aspArr.pop()):u++:"each"==l?"for"==(g=this.aspArr[this.aspArr.length-2]).label&&(g.label+="each",g.html+=" each",this.aspArr.pop()):"while"==l?("do"==(g=this.aspArr[this.aspArr.length-2]).label&&(g.label+="while",g.html+=" while",this.aspArr.pop()),u++):"do"==l?"exit"==(g=this.aspArr[this.aspArr.length-2]).label&&(g.label+="do",g.html+=" do",this.aspArr.pop()):"loop"==l?(u--,this.aspArr[this.aspArr.length-1].lv--):"for"==l?"exit"==(g=this.aspArr[this.aspArr.length-2]).label?(g.label+="for",g.html+=" for",this.aspArr.pop()):u++:"next"==l?(g=this.aspArr[this.aspArr.length-2],b=this.aspArr[this.aspArr.length-4],"resume"==g.label?(b.label+="errorresumenext",b.html+=" error resume next",this.aspArr.pop(),this.aspArr.pop(),this.aspArr.pop()):(u--,this.aspArr[this.aspArr.length-1].lv--)):"goto"==l&&(g=this.aspArr[this.aspArr.length-2],b=this.aspArr[this.aspArr.length-3],"error"==g.label&&(b.label+="errorgoto",b.html+=" error goto",this.aspArr.pop(),this.aspArr.pop())),i=l=h=n="")}d+1<c.length&&(this.aspArr.push({lv:u,type:"<br>",label:"\n",upHtml:h,downHtml:"",html:"\n",tagpair:1}),h="")}""!=h&&this.aspArr.push({lv:u,type:"<html>",label:"",upHtml:h,downHtml:"",html:"",tagpair:1})},this.tophp=function(){for(var t="",e="",r=[],s=[],l=[],i=0,n=!1,h=!1,a=!1,o="",u="",f="++",m="",c=!1,d=-1,p=-1,g=!1,b=-1,x="",y=",",v=","+this.phpPublicFunList,L=","+this.phpPublicObjectList,A=-1,_=[],O=!0,w="",C="",H=",",S=!1,D=0;D<=this.aspArr.length-1;D++){var T,O=!0;A==D&&(":"==(r=this.aspArr[D]).label?(e+=":",D++):e+=":",A=-1),0<D&&(s=this.aspArr[D-1]),r=this.aspArr[D],l={},D<this.aspArr.length-1&&(l=this.aspArr[D+1]),null!=_[r.lv]&&(e=_[r.lv]+"\n"+e,_[r.lv]=void 0),"<br>"==s.type&&(e+=this.common.copyStr("    ",r.lv+i)),1!=r.phpDel&&("<%"==r.label?(e+=r.upHtml+"<?",i--,"="!=l.label&&(e+="PHP","<br>"!=l.type&&"<note>"!=l.type&&"<asp>"!=l.type&&(e+=" "))):"%>"==r.label?e+="?>":"<br>"==r.type?(h&&(e+="}",h=!1),e+=r.upHtml+"\n"):"<note>"==r.type?e+="//"+r.html:"<html>"==r.type?e+=r.upHtml+r.html:"<var>"==r.type?"onerrorresumenext"!=r.label&&("onerrorgoto"==r.label?e+="$"+r.label:(!a&&0!=S||""==w||(H+=r.label+","),-1!=v.indexOf(","+r.label+",")?"class"==s.label?(O=!1,e+=r.label+"{"):"new"==s.label?e+=r.label+"()":"="==l.label?(e+="return ",D++):(e+=r.label,"<(>"!=l.type&&(e+="()")):0==a&&-1==H.indexOf(","+r.label+",")&&S?e+="$GLOBALS['"+r.label+"']":(e+="$"+r.label,a&&(e+="=''")),e+=this.getAddFenHao(e,l,h))):"<fuhao>"==r.type||"<int>"==r.type||"<(>"==r.type||"<)>"==r.type?n&&"="==r.label?e+="==":"&"==r.label?e+=".":"("==r.label?d==r.lv?e+="[":e+="(":")"==r.label?(d==r.lv?(e+="]","("!=l.label&&(d=-1)):b==r.lv?(t+=e+","+x+")",b=-1,x=e=""):p==r.lv?(p=-1,e+="){",""!=w&&(S=!0,"function"==C&&(e+="\n"+this.common.copyStr("    ",r.lv+i-1)+"$"+w+"=''"))):e+=")",e+=this.getAddFenHao(e,l,h)):","==r.label?c?(e+="]=",c=!1):b==r.lv?(x=e,e=""):a?(e+=";","<br>"!=l.type&&"<note>"!=l.type&&"<asp>"!=l.type||(a=!1)):e+=",":":"==r.label?(";"!=e.substr(e.length-1)&&(e+=";"),a=!1):"<>"==r.label?e+="!=":"<int>"==r.type?(e+=r.label,-1!=A||"selectcase"==m||"<br>"!=l.type&&"<note>"!=l.type&&"<asp>"!=l.type||(e+=";")):e+=r.label:"<str>"==r.type?e=(e+="'"+r.html.substr(1,r.html.length-2).replace(/""/g,'"').replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'")+this.getAddFenHao(e,l,h):"<fun>"==r.type&&("response.write"==r.label?e+="echo":"response.end"==r.label?e+="die":"request.querystring"==r.label?e+="querystring":"request.form"==r.label?e+="form":"request.servervariables"==r.label?e+="servervariables":"err.number"==r.label?e+="0":"err.clear"==r.label?e+="echo('');":"nothing"==r.label?e+="null":"step"==r.label?(e+=";",f="+="+l.label,l.phpDel=!0):"byref"==r.label?e+="&":"isnumeric"==r.label?e+="is_numeric":"strcomp"==r.label?e+="aspStrComp":"vbtextcompare"==r.label?e+="''":"chr"==r.label?e+="aspchr":"hex"==r.label?e+="dechex":"and"==r.label?e+=" && ":"or"==r.label?e+=" || ":"mod"==r.label?e+=" % ":"not"==r.label?e+="!":"exitfor"==r.label?e+="break":"ubound"==r.label?e+="count":"split"==r.label?(y+=this.aspArr[D-2].label+".add,",t+=e+="explode(",e="",b=r.lv+1,D++):"new"==r.label?e+="new ":"function"==r.label||"sub"==r.label?(p=this.aspArr[D+2].lv,e+="function ",-1==v.indexOf(","+l.label+",")&&(v+=l.label+","),w=l.label,C=r.label):"endfunction"==r.label||"endsub"==r.label?("endsub"==r.label?e+=this.common.copyStr("    ",r.lv)+"return '';\n}":e+=this.common.copyStr("    ",r.lv)+"return @$"+w+";\n}",C=w="",S=!(H=",")):"exitfunction"==r.label?e+="return ''":"if"==r.label?(e+=r.label+"(",n=!0):"elseif"==r.label?(e+="}else if(",n=!0):"then"==r.label?(e+="){","<br>"!=l.type&&"<note>"!=l.type&&"<asp>"!=l.type&&(h=!0),n=!1):"else"==r.label?e+="}else{":"endif"==r.label?(e+="}",h=!1):"selectcase"==r.label?(e+="switch ","("!=l.label&&(e+="("),m="selectcase"):"endselect"==r.label?(null!=_[r.lv+1]&&(e=_[r.lv+1]+"\n"+e,_[r.lv+1]=void 0),e+="}",0):"caseelse"==r.label?(e+="default ",_[r.lv]=this.common.copyStr("    ",r.lv)+"break;",A=D+1,O=!!0):"case"==r.label?(e+=r.label+" ",_[r.lv]=this.common.copyStr("    ",r.lv)+"break;",A=D+2):"vbcrlf"==r.label?e+='"\\n"':"createobject"==r.label?(0<D-1&&(y+=this.aspArr[D-2].label+".add,"),D+1<this.aspArr.length&&'"scripting.dictionary"'==this.aspArr[D+2].html.toLowerCase()&&(e+="array();",D+=3)):-1!=y.indexOf(","+r.label+",")?(-1!=r.label.indexOf(".")?e+="$"+r.label.substr(0,r.label.indexOf("."))+"[":(e+="$"+r.label,d=l.lv),","==this.aspArr[D+2].label&&(c=!0)):-1!=y.indexOf(","+r.label+".")?(e+="$"+r.label,d=l.lv):"do"==r.label?e+="for(;;) {":"exitdo"==r.label?e+="break":"dowhile"==r.label?(e+="while","("!=l.label&&(e+="("),g=!0):"loop"==r.label?e+="}":"class"==r.label?(e+="class ",-1==v.indexOf(","+l.label+",")&&(v+=l.label+","),-1==L.indexOf(","+l.label+",")&&(L+=l.label+",")):"endclass"==r.label?e+="}":"foreach"==r.label?(T=this.aspArr[D+1],e+="foreach($"+this.aspArr[D+3].label+" as $key=>$"+T.label+"){",D+=3):"for"==r.label?(e+=r.label,"("!=l.label&&(e+="("),o="for",u=l.label,f="++"):"for"==o&&"to"==r.label?(T=this.aspArr[D+1],"ubound"==l.label?e+=";$"+u+"<":e+=";$"+u+"<=",o="forto"):"next"==r.label?e+="}":"dim"==r.label?a=!0:-1!=r.label.indexOf(".")?e+="$"+r.label.replace(/\./g,"->"):-1==",call,set,byval,".indexOf(","+r.label+",")&&(-1!=v.indexOf(","+r.label+",")?(w==r.label&&"function"!=s.label&&"sub"!=s.label&&(e+="$"),"class"==s.label?e+=r.label+"{":"new"==s.label?e+=r.label+"()":(e+=r.label,"<(>"!=l.type&&w!=r.label&&(e+="()"))):e+=r.label),"<br>"!=l.type&&"<note>"!=l.type||!O||-1==",endfunction,then,endif,next,else,endselect,endclass,".indexOf(","+r.label+",")&&0==g&&(e+=";"))),"forto"!=o||"<br>"!=l.type&&"<note>"!=l.type&&"<asp>"!=l.type||"to"==r.label?"selectcase"!=m||"<br>"!=l.type&&"<note>"!=l.type&&"<asp>"!=l.type||"selectcase"==r.label?!g||"<br>"!=l.type&&"<note>"!=l.type&&"<asp>"!=l.type||(")"!=s.label&&(e+=")"),e+="{",n=g=!1):(m="",")"!=s.label&&(e+=")"),e+="{"):(e+="$"+u+f,u=o="",")"!=s.label&&(e+=")"),e+="{"),"<br>"==r.type&&(a=!1,t+=e,e="")}return t+e},this.getAddFenHao=function(t,e,r){return("<br>"==e.type||"<note>"==e.type||"<asp>"==e.type)&&"{"!=t.substr(t.length-1,1)||r&&"else"==e.label?";":""},this.aspBeautify=function(t){for(var e=0;e<=this.aspArr.length-1;e++){var r=this.aspArr[e];if("class"==r.label)e<this.aspArr.length&&(s=this.aspArr[e+1],this.phpPublicObjectList+=s.label+",",this.phpPublicFunList+=s.label+",");else if("then"==r.label){var s={};if("<br>"!=(s=e<this.aspArr.length-1?this.aspArr[e+1]:s).type&&"<note>"!=s.type&&"<asp>"!=s.type)for(var l=e+1;l<=this.aspArr.length-1;l++)--this.aspArr[l].lv}else if("sub"==r.label||"function"==r.label)e<this.aspArr.length-1&&(s=this.aspArr[e+1],this.phpPublicFunList+=s.label+",");else if("do"==r.label){if("<br>"==(s=this.aspArr[e+1]).type)for(l=e+1;l<=this.aspArr.length-1;l++)(r=this.aspArr[l]).lv++}else"echo"==r.label?r.label=r.html="aspEcho":"die"==r.label?r.label=r.html="aspDie":"print"==r.label&&(r.label=r.html="aspPrint")}if(""!=this.phpPublicFunList)for(var i=","+this.phpPublicFunList+",",e=0;e<=this.aspArr.length-1;e++)"<var>"==(r=this.aspArr[e]).type&&-1!=i.indexOf(","+r.label+",")&&(r.type="<fun>")},this.printASP=function(t){for(var e="",r=0;r<=this.aspArr.length-1;r++){var s,l=this.aspArr[r];null!=l&&(s=l.upHtml+l.html+l.downHtml,"zip"==t?s="/*"==l.label?"":s.replace(/  /g," ").replace(/  /g," ").replace(/{ /g,"{").replace(/ {/g,"{").replace(/\n/g,"").trim():"format"==t&&(s=s.trim()+"\n"),""!=s&&(e+=s))}return e},this.debug=function(t){((t=null==t?!1:t)?xiyueta:console).log(this.aspArr)}},_xytasp=new _XIYUETAASP;(xiyuetaASP=$xytasp=$asp=function(t){return{parse:function(t){return _xytasp.aspParse(t),this},beautify:function(){return _xytasp.aspBeautify(t),this},tophp:function(t){return this.beautify(),((t=null==t?!1:t)?'<?PHP include_once "ASP.php" ?>\n':"")+_xytasp.tophp()},print:function(t){return _xytasp.printASP(t)},debug:function(t){return _xytasp.debug(t)}}}).load=function(t){return xiyuetaASP().parse(t),this},xiyuetaASP.html=function(t){return xiyuetaASP().tophp(t)},XiyuetaCommon.prototype.handleFileUrl=function(t){var e="",r=t.indexOf("://");if(-1!=r&&(e=t.substr(0,r+3),t=t.substr(r+3)),-1!=(t=-1!=(t=t.replace(/\/\//g,"/")).indexOf("/./")?t.replace(/\/.\//g,"/"):t).indexOf("/../")){for(var s=[],l=0,i=t.split("/"),n=0;n<=i.length-1;n++)".."==(h=i[n])?(0==l?l=n-1:--l,0<=l&&delete s[l]):(s.push(h),l=0);for(t="",n=0;n<=s.length-1;n++){var h=s[n];null!=s[n]&&(""!=t&&(t+="/"),t+=s[n])}}return e+t},XiyuetaCommon.prototype.fullHttpUrl=function(t,e){if(null==e)return"";if(""==(e=(e+="").replace(/\\/g,"/").trim())||"./"==e)return"";var r,s="",l="",i="",n=t.indexOf("://");return l=-1!=n?(s=t.substr(0,n+3),n=(r=t.substr(n+3)).lastIndexOf("/"),i=s+r.substr(0,n+1),n=r.indexOf("/"),s+r.substr(0,n+1)):(n=t.lastIndexOf("/"),i=t.substr(0,n+1),n=t.indexOf("/"),t.substr(0,n+1)),"//"==e.substr(0,2)?e="http:"+e:-1==e.indexOf("://")&&(e="/"==e.substr(0,1)?l+e:i+e),this.handleFileUrl(e)},XiyuetaCommon.prototype.getUrlDir=function(t,e){if("string"!=typeof t)return"";var r;-1<(t=t.replace(/\\/g,"/").trim()).indexOf("://")&&(r=t.indexOf("://",1),t=-1!=(t=t.substring(r+3,t.length)).indexOf("/")?t.substr(t.indexOf("/")+1):""),-1!=(t=-1!=(t="/"==t.substr(0,1)?t.substr(1):t).indexOf("?")?t.substr(0,t.indexOf("?")):t).indexOf("#")&&(t=t.substr(0,t.indexOf("#")));for(var s=1;s<9&&-1!=t.indexOf("//");s++)t=t.replace(/\/\//g,"/");return-1!=t.indexOf("/")?"fz"==e?(t=t.substr(0,t.lastIndexOf("/"))).replace(/\//g,"_"):t.substr(0,t.lastIndexOf("/")+1):""},XiyuetaCommon.prototype.getUrlFileName=function(t,e){if("string"!=typeof t)return"";-1<(t=t.replace(/\\/g,"/").trim()).indexOf("://")&&(s=t.indexOf("://",1),t=-1!=(t=t.substring(s+3,t.length)).indexOf("/")?t.substr(t.indexOf("/")+1):"");var r,s=t.split("/"),t=s[s.length-1],s="",l="";return-1!=(t=-1!=(t=-1!=t.indexOf("?")?t.substr(0,t.indexOf("?")):t).indexOf("#")?t.substr(0,t.indexOf("#")):t).indexOf(".")?(r=t.lastIndexOf("."),s=t.substr(0,r),l=t.substr(r+1).toLowerCase()):s=t,""==s?"":("image"==e?""==l?t+=".jpg":-1=="|bmp|jpg|jpeg|gif|png|svg|".indexOf("|"+l+"|")&&(t=s+".jpg"):"css"==e?""==l?t+=".css":-1=="|css|".indexOf("|"+l+"|")&&(t=s+".css"):"js"==e?""==l?t+=".js":-1=="|js|".indexOf("|"+l+"|")&&(t=s+".js"):"html"==e?""==l?t+=".html":-1=="|html|htm|".indexOf("|"+l+"|")&&(t=s+".html"):(t=s,""!=l&&(t+="."+l)),t)},XiyuetaCommon.prototype.setFileNameA=function(t){return t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/\\/g,"pie")).replace(/\//g,"la")).replace(/:/g,"maohao")).replace(/\*/g,"xin")).replace(/\?/g,"wen")).replace(/"/g,"yinhao")).replace(/</g,"zou")).replace(/>/g,"you")).replace(/\|/g,"heng")).replace(/\./g,"juhao")).replace(/,/g,"douhao")).replace(/&nbsp;/g," ")).replace(/&quot;/g,"shuang")).replace(/\n/g,"")},XiyuetaCommon.prototype.checkUrl=function(t){return!!/^\b(((https?|ftp):\/\/)?[-a-z0-9]+(\.[-a-z0-9]+)*\.(?:com|edu|gov|int|mil|net|org|biz|info|name|museum|asia|coop|aero|[a-z][a-z]|((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]\d)|\d))\b(\/[-a-z0-9_:\@&?=+,.!\/~%\$]*)?)$/i.test(t=null==t?"":t)},XiyuetaCommon.prototype.getDomain=function(t){return"string"==typeof t&&-1<t.indexOf("//")?(e=t.indexOf("//",1),t=(e=t.substring(e+1,t.length)+"/").indexOf("/",1),e.substring(1,t)):"";var e},XiyuetaCommon.prototype.getUrlToFileName=function(t,e){var r=xiyueta.config().urlToNameList,s=(null!=e&&""!=e||(e="txt"),t.indexOf("?")),l=(-1!=(s=(t=-1!=s?t.substr(0,s):t).indexOf("#"))&&(t=t.substr(0,s)),""),i="\r\n"+r+"|";if(""==(l=-1!=(s=i.indexOf("\r\n"+t+"|"))?i.substr(s).split("|")[1]:l)){""==(l=this.getUrlFileName(t,e))&&""==(l="_"==(l=this.getUrlDir(t+"/","fz")).substr(l.length-1,1)?l.substr(0,l.length-1):l)&&(l=xiyueta.config().urlDefaultFileName+"."+e),""!=e&&-1==l.indexOf(".")&&(l+="."+e);for(var n=l,h=1;h<9&&-1!=r.indexOf("|"+l+"|");h++)l=n.substr(0,n.length-e.length-1)+"_"+h+"."+e}return l},XiyuetaCommon.prototype.getUrlParam=function(t,e){if(e+="",1<(r=(t+="").split("?")).length)for(var r=r[1].split("&"),s=0;s<r.length;s++){var l,i=r[s].split("=");if(i[0]==e)return 1<(l=i[1].split("#")).length?l[0]:i[1]}return""},_XIYUETA.prototype.cutLabel=function(t,e){t=this.handleDomList(t);for(var r="",s=0;s<this.htmlArr.length;s++)(o=this.htmlArr[s])&&("/style"==o.label?r+=o.upHtml:"link"==o.label&&"stylesheet"==(this.attr(o,"rel")+"").toLowerCase().trim()&&(r+=o.content));if(0<t.length){var l="",i=!1,n="",h="",a=new _XIYUETACSS;a.cssParse(r),a.debug();for(var o,u,s=0;s<a.cssArr.length;s++)(o=a.cssArr[s])&&(u=o.label.toLowerCase(),0==i&&1==o.lv&&-1!=u.indexOf(" screen ")?(i=!0,l+=h,h="",n=o.label+"{\n"):1==i&&1==o.lv&&"}"==o.label?(i=!1,""!=h&&(l+=n+h+"}\n"),h=""):this.checkCssInHtml(t,o.label)&&(h+=o.html+"\n"));l+=h,xiyuetaCSS().parse(l),""!=(l=xiyuetaCSS().print("format"))&&(l="<style>"+l+"\n</style>\n");var f=xiyueta(t).htmlwrap();return xiyueta.load(f),l+this.printHTML("format")}return""},_XIYUETA.prototype.checkCssInHtml=function(t,e){t=this.handleDomList(t);var r=e,s=e.indexOf("{");if(""==(e=-1<s?e.substr(0,s):e))return!1;for(var l=e.split(" "),i="",n=0;n<l.length;n++){for(var h=l[n],a=0;a<9;a++)h=this.extractCssStyleName(h,h.lastIndexOf(".")),h=this.extractCssStyleName(h,h.lastIndexOf(":")),h=this.extractCssStyleName(h,h.lastIndexOf("["));""!=i&&(i+=" "),i+=h}e=i,console.log("显示",r,"=",e);var s=","+e+",",h=",*,",r=",* ";if(-1!=s.indexOf(h)||-1!=s.indexOf(r))return!0;h=",html,",r=",html ";if(-1!=s.indexOf(h)||-1!=s.indexOf(r))return!0;h=",body,",r=",body ";if(-1!=s.indexOf(h)||-1!=s.indexOf(r))return!0;s=t[0].x,r=t[0].y;return 0<xiyueta(e,s,r).length},_XIYUETA.prototype.extractCssStyleName=function(t,e){var r,s,l;return 0<e&&(l=t.substr(0,e),r=(e=t.substr(e+1)).indexOf(" "),s=e.indexOf(","),t=l,-1==r&&-1==s||(l=99,-1!=r&&r<l&&(l=r),t+=e.substr(l=-1!=s&&s<l?s:l))),t},xiyueta.fn.extend({cutlabel:function(t){return _xyt.cutLabel(this.domList,t)}});