/*! xiyueta v1.2.8 | Author xiyueta Adream | MIT License By http://xiyueta.com/  */
String.prototype.trim=function(){return(this+"").replace(/(^s*)|(s*$)/g,"")};var _CONSOLE=function(t){this.log=function(t){if("object"==typeof t)for(var e in t)-1==(t[e]+"").indexOf("function")&&response.write(e+":  "+t[e]+"<br>");else response.write(t)}},console=new _CONSOLE;function XiyuetaCommon(){this.copyStr=function(t,e){for(var l="",s=1;s<=e;s++)l+=t;return l},this.bystesLength=function(t){for(var e=0,l=0;l<t.length;l++)255<t.charCodeAt(l)?e+=2:e++;return e},this.getFileSize=function(t){return t<1048576?(t/1024).toFixed(2)+"KB":1048576==t?"1MB":1048576<t&&t<1073741824?(t/1048576).toFixed(2)+"MB":1048576<t&&1073741824==t?"1GB":1073741824<t&&t<1099511627776?(t/1073741824).toFixed(2)+"GB":"文件超过1TB"}}var _XIYUETA=function(t){"use strict";this.htmlSource=t=null==t?"":t,this.htmlArr=[],this.lv=0,this.common=new XiyuetaCommon,this.config={version:"1.2.7",httpurl:"",serverurl:"/api/downWeb/default.asp",jsdir:"js/",cssdir:"css/",imagesdir:"images/"},this.tplConfig={type:"xiyuetacms",item:4},this.htmlParse=function(t){null!=t&&(this.htmlSource=t,this.htmlArr=[]);for(var e="",l="",s="",r="",i=!1,n=!1,a=!1,h=!1,u=!1,o=0,c=0;c<=this.htmlSource.length-1;c++){var f,p,e=this.htmlSource.substr(c,1);i?(s+=e,h?">"==e&&"--\x3e"==s.substr(-3,3)&&(a=i=h=!1,this.htmlArr.push({lv:o+1,label:"!--",upHtml:r,html:s,tagpair:1}),r=s=""):n&&"\x3c!--"==s?h=!0:u?">"==e&&"%>"==s.substr(-2,2)&&(a=i=u=!1,this.htmlArr.push({lv:o+1,label:"<%",upHtml:r,html:s,tagpair:1}),r=s=""):n&&"<%"==s?u=!0:" "==e&&n?n=!1:">"==e&&(i=n=!1,p=2,"/"==l.substr(0,1)?a=!0:(o++,"/"!=l.substr(-1,1)&&-1=="|br|hr|img|link|meta|param|input|!doctype|rect|line|".indexOf("|"+l.toLowerCase()+"|")||(a=!0,p=1,l=l.replace(/\//g,"").trim())),this.htmlArr.push({lv:o,label:l.toLowerCase(),upHtml:r,html:s,tagpair:p}),r=s="",a&&(o--,a=!1),"script"==l.toLowerCase()?(f=this.htmlSource.substr(c+1).toLowerCase().indexOf("<\/script>"),s=this.htmlSource.substr(c+1,f),c+=f):"textarea"==l.toLowerCase()&&(f=this.htmlSource.substr(c+1).toLowerCase().indexOf("</textarea>"),s=this.htmlSource.substr(c+1,f),c+=f)),n&&(l+=e)):"<"==e?(p=this.htmlSource.substr(c+1,1).toLowerCase(),-1!="abcdefghijklmnopqrstuvwxyz!/%?".indexOf(p)?(r=s,s=e,a=!(n=i=!0),l=""):s+=e):s+=e}""!=s&&this.htmlArr.push({lv:o,label:"",upHtml:"",html:s}),this.lv=o},this.handleLabelParam=function(t,e,l){if(null==l){if(null!=t[e])return t[e]}else l=l.toString();for(var s=!1,r="",i="",n=!1,a="",h=!1,u=!0,o=0,c=0,f=!1,p=t.label.length+1;p<=t.html.length-1;p++){var m=t.html.substr(p,1);if(n)if(h)if(f)">"==m&&(f=!1),i+=m;else if(m==a||">"==m){var b,r=r.toLowerCase();if(t[r]=i,h=n=!1,a="",e==r)return null==l?i:(""==l?(g=t.html.substr(0,c-1),x=t.html.substr(p+1),t.html=g+x):(y=(b=o)+i.length,u&&(b++,y++),g=t.html.substr(0,b),x=t.html.substr(y),t.html=g+l+x),t[r]=l,t);else if(">"==m&&null!=l)return t.html=t.html.substr(0,t.html.length-1)+" "+e+'="'+l+'">',t[e]=l,!0}else"<"==m&&(f=!0),i+=m;else'"'==m||"'"==m?(a=m,o=p,u=h=!0):" "!=m&&(a=" ",o=p,i=m,u=!(h=!0));else if(">"==m){if(null!=l)return t.html=t.html.substr(0,t.html.length-1)+" "+e+'="'+l+'">',t[e]=l,!0;if(e==(r=r.trim()))return null!=l&&(d=c+r.length,g=t.html.substr(0,d),x=t.html.substr(d),t.html=g+'="'+l+'"'+x),""}else if(s)if("="==m){if(-1!=(r=r.trim()).indexOf(" ")){var d,g,x,y=r.split(" ");if(e==(r=y[0]))return null!=l&&(d=c+r.length,g=t.html.substr(0,d),x=t.html.substr(d),t.html=g+'="'+l+'"'+x),""}n=!(s=!1),a=i=""}else r+=m;else" "!=m&&(s=!0,r=m,c=p)}},this.getDocument=function(t,e,l,s){if(null==t&&(t=""),null==s&&(s=!1),0==this.htmlArr.length)return console.log("%c 需要先解析一段html文本","font-size:14px;color:#FF3300"),"";if(-1!=t.indexOf(",")){for(var r="",i=t.split(","),n=0;n<=i.length-1;n++)r+=h=this.getDocument(i[n],e,l,s);for(var a="",i=r.split(","),n=0;n<=i.length-1;n++){var h=i[n];-1==(","+a+",").indexOf(","+h+",")&&(""!=a&&(a+=","),a+=h)}return a=""!=a?","+a:a}if(""==(t=t.trim()))return"";null==e&&(e=0),null==l&&(l=this.htmlArr.length-1);var u=-1.1,o="",c="",f="",p="",r="";if(-1!=t.indexOf("'")||-1!=t.indexOf('"')){for(var m=!1,r="",n=0;n<=t.length;n++){h=t.substr(n,1);0!=m||"'"!=h&&'"'!=h?1==m&&(" "==h?h="-Space-":"'"!=h&&'"'!=h||(m=!1,h="")):(m=!0,h=""),r+=h}t=r}var b,d=t.indexOf(" ");if(-1!=d&&(o=t.substr(d+1).trim(),t=t.substr(0,d)),-1!=(d=t.indexOf(":eq("))&&(b=(h=t.substr(d+4)).indexOf(")"),""!=(u=h.substr(0,b))&&(u=parseInt(u)),t=t.substr(0,d)),-1!=(d=t.indexOf("["))&&(b=(h=t.substr(d+1)).indexOf("]"),c=(b=(h=h.substr(0,b)).split("="))[0],f=b[1].replace(/-Space-/g," "),-1!=c.indexOf("|")&&(c=(b=c.split("|"))[0],p=b[1]),t=t.substr(0,d)),"#"==t.substr(0,1)){if(0<u)return"";u=0}if(""!=(r=this.serchDocument(t,e,l,c,f,p))&&-1.1!=u&&(i=r.split(","),""!=(r=u<0?i[i.length+u]:i[u+1])&&(r=","+r)),""!=o&&""!=r){i=r.split(",");r="";for(var g,n=1;n<=i.length-1;n++)-1!=(h=i[n]).indexOf("|")&&(g=h.split("|"),e=parseInt(g[0])+1,l=parseInt(g[1])-1,r+=this.getDocument(o,e,l,!0))}if(0==s){i=r.split(",");r="";for(n=1;n<=i.length-1;n++){h=i[n];-1==(","+r+",").indexOf(","+h+",")&&(r+=","+h)}}return r},this.serchDocument=function(t,e,l,s,r,i){null==s&&(s=""),null==r&&(r=""),null==i&&(i="");for(var n=!1,a="",h=0,u=0,o=!1,c=e;c<=l;c++){var f,p,m=this.htmlArr[c];null!=m&&(n&&this.checkEndSelector(m,t)&&h==m.lv?(o&&(a+="|"+c),o=n=!1,a+=this.serchDocument(t,u+1,c,s,r,i)):this.checkStartSelector(m,t)&&0==n&&(2==m.tagpair&&(n=!0,h=m.lv),u=c,f=!0,""!=s&&(p=this.handleLabelParam(m,s),(p="NOUL"==i?p.toLowerCase():p)!=r&&(f=!1)),f&&(a+=","+c,2==m.tagpair&&(o=!0))))}return a},this.checkStartSelector=function(t,e){if(""==t.label)return!1;var l=e+" ",s=t.label.substr(0,1),r=e.substr(0,1);if("*"==r&&"/"!=s)return!0;if("#"==r){var i=e.substr(1,l.indexOf(" ")-1);if(this.handleLabelParam(t,"id")==i)return!0}else if("."==r){i=e.substr(1,l.indexOf(" ")-1);if(this.handleLabelParam(t,"class")==i)return!0}else if(t.label+" "==e.substr(0,t.label.length+1)+" ")return!0;return!1},this.checkEndSelector=function(t,e){t.label.substr(0,1);var l=e.substr(0,1);return"*"==l||("#"==l||"."==l||t.label=="/"+e.substr(0,t.label.length-1))},this.getText=function(t,e,l){t="object"==typeof t?(e=t.x,l=t.y,""):t.trim();for(var s="",r=this.domList,i=(r=null==this.domList?this.getDocument(t,e,l):r).split(","),n=1;n<=i.length-1;n++)if(-1!=(r=i[n]).indexOf("|"))for(var a=r.split("|"),h=parseInt(a[0])+1;h<=a[1];h++)null!=this.htmlArr[h]&&(s+=this.htmlArr[h].upHtml);return s},this.getHtml=function(t,e,l,s){""!=(s=null==s?"":s)&&(s="|"+s+"|"),t="object"==typeof t?(e=t.x,l=t.y,""):t.trim();var r="",i=this.domList,t=(i=null==this.domList?this.getDocument(t,e,l):i).split(",");if(!(t.length<2)){if(-1!=(i=t[1]).indexOf("|"))for(var t=i.split("|"),e=parseInt(t[0]),l=parseInt(t[1]),n=e;n<=l;n++){var a=this.htmlArr[n];a&&(e<n&&-1==s.indexOf("doc")&&(r+=a.upHtml),-1!=s.indexOf("all")?-1!=s.indexOf("label")?r+="<"+a.label+">":r+=a.html:e<n&&n<l&&(-1!=s.indexOf("doc")&&"!--"!=a.label?-1!=s.indexOf("label")?r+="<"+a.label+">":r+=a.html:""==s&&(r+=a.html)))}else""!=i&&-1!=s.indexOf("all")&&(-1!=s.indexOf("label")?r+="<"+a.label+">":r=this.htmlArr[i].html);return r}},this.setHtml=function(t,e,l,s,r){"object"==typeof t?i=","+t.x+"|"+t.y:(i=this.domList,null==this.domList&&(i=this.getDocument(t,e,l)));for(var i,n=i.split(","),a=1;a<=n.length-1;a++)if(-1!=(i=n[a]).indexOf("|"))for(var h=i.split("|"),e=parseInt(h[0]),l=parseInt(h[1]),u=e;u<=l;u++){var o=this.htmlArr[u];o&&(u==e?"all"==r&&(o.html=""):u<l?delete this.htmlArr[u]:u==l&&(o.upHtml=s,"all"==r&&(o.html="")))}return this},this.handleCssParam=function(t,e,l){var s,r;if(null==l){var i,n="a{"+(i=null==(i=this.attr(t,s,r,"style"))?"":i)+"}";return $xytcss("a").parse(n).css(e)}l=l.toString();n="a{"+(i=null==(i=this.attr(t,s,r,"style"))?"":i)+"}",$xytcss("a").parse(n).css(e,l),l=(l=$xytcss().print()).substr(2,l.length-3);this.attr(t,s,r,"style",l)},this.css=function(t,e,l,s,r){if(""==(s=(s=null==s?"":s).trim()))return"";if("object"==typeof t)return null==r?this.handleCssParam(t,s):this.handleCssParam(t,s,r);var i=this.domList,n=(i=null==this.domList?this.getDocument(t,e,l):i).split(",");if(null==r){if(null==(i=n[1]))return;var a=i.split("|"),h=this.htmlArr[a[0]];return i=this.handleCssParam(h,s)}for(var u=1;u<=n.length-1;u++)h=-1!=(i=n[u]).indexOf("|")?(a=i.split("|"),this.htmlArr[a[0]]):this.htmlArr[i],this.handleCssParam(h,s,r)},this.attr=function(t,e,l,s,r){if(""==(s=(s=null==s?"":s).trim()))return"";if("object"==typeof t)return null==r?this.handleLabelParam(t,s):this.handleLabelParam(t,s,r);var i=this.domList,n=(i=null==this.domList?this.getDocument(t,e,l):i).split(",");if(null==r){if(null==(i=n[1]))return;var a=i.split("|"),h=this.htmlArr[a[0]];return i=this.handleLabelParam(h,s)}for(var u=1;u<=n.length-1;u++)h=-1!=(i=n[u]).indexOf("|")?(a=i.split("|"),this.htmlArr[a[0]]):this.htmlArr[i],this.handleLabelParam(h,s,r)},this.val=function(t,e,l,s){"object"==typeof t?o=","+t.x+"|"+t.y:(o=this.domList,null==this.domList&&(o=this.getDocument(t,e,l)));var r=o.split(",");if(null==s){if(null==(o=r[1]))return"";var i=o.split("|");if("textarea"==(c=this.htmlArr[i[0]]).label)return this.getHtml(c);if("select"!=c.label)return this.handleLabelParam(c,"value");l=this.getDocument("option",c.x,c.y);if(""==l)return;for(var n,a=l.split(","),h=1;h<=a.length-1;h++){var u=a[h];-1!=u.indexOf("|")&&(u=u.split("|"),u=this.htmlArr[u[0]],null==this.handleLabelParam(u,"selected")&&null!=n||(n=this.handleLabelParam(u,"value")))}return n}for(var o,c,h=1;h<=r.length-1;h++)-1!=(o=r[h]).indexOf("|")?(i=o.split("|"),"textarea"==(c=this.htmlArr[i[0]]).label?(c.x=i[0],c.y=i[1],this.setHtml(c,void 0,void 0,s)):"select"==c.label||this.handleLabelParam(c,"value",s)):(c=this.htmlArr[o],this.handleLabelParam(c,"value",s));return""},this.each=function(t,e,l,s){var r=[];t=t.trim();for(var i,n,a=this.domList,h=(a=null==this.domList?this.getDocument(t,e,l):a).split(","),u=1;u<=h.length-1;u++)-1!=(a=h[u]).indexOf("|")?(i=a.split("|"),(n=this.htmlArr[i[0]]).x=parseInt(i[0]),n.y=parseInt(i[1])):((n=this.htmlArr[a]).x=parseInt(a),n.y=parseInt(a)),r.push(n);if(Array.isArray(r))for(var u=0,o=r.length;u<o&&0!=s.call(null,u,r[u]);u++);},this.remove=function(t,e,l){if("object"==typeof t?i=","+t.x+"|"+t.y:(i=this.domList,null==this.domList&&(i=this.getDocument(t,e,l))),""==i)return!1;for(var s=i.split(","),r=1;r<=s.length-1;r++){var i=s[r];if(-1!=i.indexOf("|"))for(var n,a=i.split("|"),e=parseInt(a[0]),l=parseInt(a[1]),h=e;h<=l;h++)(n=this.htmlArr[h])&&(h==e?(n.html="",n.label=""):delete this.htmlArr[h]);else(n=this.htmlArr[i])&&(n.html="",n.label="")}return!0},this.addClass=function(t,e,l,s){if(null==s)return!1;if(""==(s=s.trim()))return!1;var r=s.split(" ");"object"==typeof t?a=","+t.x+"|"+t.y:(a=this.domList,null==this.domList&&(a=this.getDocument(t,e,l)));for(var i=a.split(","),n=1;n<=i.length-1;n++){for(var a,h=(a=i[n]).split("|"),h=this.htmlArr[h[0]],u=null!=(u=this.attr(h,e,l,"class"))?u.trim():"",o=0;o<=r.length-1;o++)""!=r[o]&&(""!=u&&(u+=" "),u+=r[o]);this.attr(h,e,l,"class",u)}},this.removeClass=function(t,e,l,s){if(null==s)return!1;if(""==(s=s.trim()))return!1;var r=s.split(" ");"object"==typeof t?a=","+t.x+"|"+t.y:(a=this.domList,null==this.domList&&(a=this.getDocument(t,e,l)));for(var i=a.split(","),n=1;n<=i.length-1;n++){var a,h=(a=i[n]).split("|"),h=this.htmlArr[h[0]];if(null!=(u=this.attr(h,e,l,"class"))){for(var u=" "+(u=u.trim())+" ",o=0;o<=r.length-1;o++)""!=r[o]&&(u=u.replace(" "+r[o]+" "," "));this.attr(h,e,l,"class",u.trim())}}},this.printHtml=function(t){for(var e="",l=-1,s=-1,r=0,i=0;i<=this.htmlArr.length-1;i++){var n,a,h=this.htmlArr[i];h&&("format"==t?(n=h.upHtml.trim(),a=h.html.trim(),s=h.lv,"html"==h.label?r=-1:"head"!=h.label&&"body"!=h.label||(n+="\n"),""!=a&&0==("/"==h.label.substr(0,1)&&h.lv==l)&&(a="\n"+this.common.copyStr("    ",h.lv-1+r)+a,h.lv!=l&&""!=n&&"\n"!=n&&(s=h.lv,"/"!=h.label.substr(0,1)&&s--,n="\n"+this.common.copyStr("    ",s+r)+n)),e+=n+a):e+="zip"==t?h.upHtml.trim()+h.html.trim():h.upHtml+h.html,2==h.tagpair&&(l=h.lv))}return e="format"==t?e.trim():e},this.debug=function(t){console.log(this.htmlArr)},this.info=function(){console.log("%c xiyueta%c v"+_xyt.config.version+" website: www.xiyueta.com ","font-size:22px;color:#00bbee","color:#000")}},_xyt=new _XIYUETA,xiyueta=function(t,e,l){return new xiyueta.fn.init(t,e,l)};xiyueta.fn=xiyueta.prototype={length:1,selector:"",domList:void 0,x:null,y:null},xiyueta.extend=xiyueta.fn.extend=function(){var t,e,l,s=arguments[0]||{},r=1,i=arguments.length;for(r===i&&(s=this,r--);r<i;r++)if(null!=(t=arguments[r]))for(e in t)l=t[e],"__proto__"!==e&&s!==l&&void 0!==l&&(s[e]=l);return s};var init=xiyueta.fn.init=function(t,e,l){this.length=0,this.selector=t,this.domList=void 0,this.x=e,this.y=l,0<_xyt.htmlArr.length&&"string"==typeof t&&(l=(e=_xyt.getDocument(t,e,l)).split(","),this.length=l.length-1,this.domList=e),_xyt.domList=this.domList,null==this.selector&&(this.selector="")};init.prototype=xiyueta.fn,($=$xyt=xiyueta).fn.extend({parse:function(t){var e;return _xyt.htmlParse(t),0<_xyt.htmlArr.length&&"string"==typeof this.selector&&(t=(e=_xyt.getDocument(this.selector,this.x,this.y)).split(","),this.length=t.length-1,this.domList=e,_xyt.domList=this.domList),this},find:function(t){if("string"==typeof this.selector&&""!=this.selector){for(var e=this.selector.split(","),l="",s=0;s<=e.length-1;s++)""!=l&&(l+=","),l+=e[s]+" "+t;this.selector=l;var r=_xyt.getDocument(this.selector,this.x,this.y),e=r.split(",");this.length=e.length-1,this.domList=r,_xyt.domList=this.domList}else"object"==typeof this.selector&&(this.x=this.selector.x+1,this.y=this.selector.y-1,this.selector=t);return this},text:function(t){return null!=t?(t=t.replace(/</g,"&lt;").replace(/>/g,"&gt;"),_xyt.setHtml(this.selector,this.x,this.y,t),this):_xyt.getText(this.selector,this.x,this.y)},html:function(t,e){return null!=t?(_xyt.setHtml(this.selector,this.x,this.y,t,e),this):_xyt.getHtml(this.selector,this.x,this.y,e)},attr:function(t,e){return null==e?_xyt.attr(this.selector,this.x,this.y,t):(_xyt.attr(this.selector,this.x,this.y,t,e),this)},val:function(t){return null==t?_xyt.val(this.selector,this.x,this.y):(_xyt.val(this.selector,this.x,this.y,t),this)},remove:function(){return _xyt.remove(this.selector,this.x,this.y),this},each:function(t){return _xyt.each(this.selector,this.x,this.y,t)},css:function(t,e){return null==e?_xyt.css(this.selector,this.x,this.y,t):(_xyt.css(this.selector,this.x,this.y,t,e),this)},print:function(t){return _xyt.printHtml(t)},debug:function(t){return _xyt.debug(t),this}}),xiyueta.fn.extend({eq:function(t){var e=this.domList.split(",");0<=t?t++:t=e.length+t;t=e[t];return _xyt.domList=this.domList=t=""!=t?","+t:t,this},first:function(){return this.eq(0),this},last:function(){return this.eq(-1),this},addClass:function(t){return _xyt.addClass(this.selector,this.x,this.y,t),this},removeClass:function(t){return _xyt.removeClass(this.selector,this.x,this.y,t),this},htmlWrap:function(t){return null!=t?(_xyt.setHtml(this.selector,this.x,this.y,t,"all"),this):_xyt.getHtml(this.selector,this.x,this.y,"all")},doc:function(t){return _xyt.getHtml(this.selector,this.x,this.y,"doc|"+t)},docWrap:function(){return _xyt.getHtml(this.selector,this.x,this.y,"doc|all")},docLabel:function(t){return _xyt.getHtml(this.selector,this.x,this.y,"doc|label|"+t)},docLabelWrap:function(){return _xyt.getHtml(this.selector,this.x,this.y,"doc|all|label")},lv:function(){return _xyt.lv}}),_XIYUETA.prototype.swap=function(t,e){if(null==t||null==e)return!1;t=this.getDocument(t),e=this.getDocument(e);if(""==t||""==e)return!1;if(t=t.replace(/,/,""),e=e.replace(/,/,""),-1==t.indexOf("|"))var l=this.htmlArr[t];else{for(var s=t.split("|"),l=this.htmlArr[s[0]],r="",i=parseInt(s[0])+1;i<=s[1];i++)null!=(a=this.htmlArr[i])&&(r+=a.upHtml+a.html,delete this.htmlArr[i]);l.html+=r}if(-1==e.indexOf("|"))var n=this.htmlArr[e];else{for(var a,s=e.split("|"),n=this.htmlArr[s[0]],r="",i=parseInt(s[0])+1;i<=s[1];i++)null!=(a=this.htmlArr[i])&&(r+=a.upHtml+a.html,delete this.htmlArr[i]);n.html+=r}e=l.html;return l.html=n.html,n.html=e,!0},_XIYUETA.prototype.getItem=function(t,e,l,s){null==s&&(s="");for(var r=[],i=(c=this.getDocument(t,e,l)).split(","),n=1;n<=i.length-1;n++)if(-1!=(c=i[n]).indexOf("|")){var a=c.split("|"),h=this.htmlArr[a[0]];if(""!=s)void 0!==(c=this.handleLabelParam(h,s))&&r.push(c);else{for(var u=h.html,o=parseInt(a[0])+1;o<=a[1];o++)null!=(h=this.htmlArr[o])&&(u+=h.upHtml+h.html);""!=u&&r.push(u)}}else{var c,h=this.htmlArr[c];""!=s?void 0!==(c=this.handleLabelParam(h,s))&&r.push(c):r.push(h.html)}return r},_XIYUETA.prototype.setConfig=function(t){if(null==t)return this.config;null!=t.httpurl&&(this.config.httpurl=t.httpurl),null!=t.serverurl&&(this.config.serverurl=t.serverurl),null!=t.jsdir&&(this.config.jsdir=t.jsdir),null!=t.cssdir&&(this.config.cssdir=t.cssdir),null!=t.imagesdir&&(this.config.imagesdir=t.imagesdir)},_XIYUETA.prototype.charset=function(t){for(var e=0;e<=this.htmlArr.length-1;e++){var l=this.htmlArr[e];if(null!=l)if("meta"==l.label)if(-1!=l.html.toLowerCase().indexOf("charset=")){var s=this.handleLabelParam(l,"charset");if(null!=(s=null!=s?s.toLowerCase().trim():s))return null!=t&&this.handleLabelParam(l,"charset",t),s;if(-1!=(s=null!=(s=this.handleLabelParam(l,"content"))?s.toLowerCase().trim():s).indexOf("utf-8"))return null!=t?(this.handleLabelParam(l,"content","text/html; charset="+t),""):"utf-8";if(-1!=s.indexOf("gb2312"))return null!=t?(this.handleLabelParam(l,"content","text/html; charset="+t),""):"gb2312"}}},_XIYUETA.prototype.getHandleSrc=function(t,e,l,s){for(var r="",i=!0,n=0;n<=this.htmlArr.length-1;n++){var a,h,u,o=this.htmlArr[n];null!=o&&-1!=("|"+t+"|").indexOf("|"+o.label+"|")&&(null==(a=this.handleLabelParam(o,e))&&(a=""),"link"==o.label&&("dns-prefetch"!=(h=(h=null==(h=this.handleLabelParam(o,"rel"))?"":h).trim().toLowerCase())&&"alternate"!=h||(a="")),-1!=("|"+l+"|").indexOf("clean")?(i=!0,""!=a&&-1==a.indexOf("apps.bdimg.com/")&&(u=a=this.common.fullHttpUrl(s,a),-1!=("|"+l+"|").indexOf("web")&&""!=(a=this.common.getUrlFileName(a,o.label))&&("img"==o.label?a=this.config.imagesdir+a:"script"==o.label?a=this.config.jsdir+a:"link"==o.label?-1!=(h=(h=null==(h=this.handleLabelParam(o,"rel"))?"":h).trim().toLowerCase()).indexOf("shortcut icon")?a=this.config.imagesdir+a:-1!=h.indexOf("stylesheet")?a=this.config.cssdir+a:(a="",i=!1):(i=!1,a="")),i&&""!=a&&(-1!=("|"+l+"|").indexOf("down")?(""!=r&&(r+="[,]"),r+=u+"[|]"+a):(""!=r&&(r+="[,]"),r+=a)),this.handleLabelParam(o,e,a))):""!=a&&(""!=r&&(r+="[,]"),r+=a))}return r},_XIYUETA.prototype.replace=function(t,e,l,s){for(var r,i=this.getDocument(t),n=i.split(","),a=1;a<=n.length-1;a++)r=-1!=(i=n[a]).indexOf("|")?(r=i.split("|"),this.htmlArr[r[0]]):this.htmlArr[i],""!=e&&(i=this.handleLabelParam(r,e))==l&&this.handleLabelParam(r,e,s)},_XIYUETA.prototype.htmlrepair=function(t){null==t&&(t=!0);var e=0,l=!1,s="",r=this.lv,i=",";r<0&&(r*=-1);for(var n,a,h,u,o,c=0;c<=this.htmlArr.length-1;c++)(o=this.htmlArr[c])&&(o.id=c,2==o.tagpair&&("/"==o.label.substr(0,1)?(n=o.label.substr(1),-1!=(","+i+",").indexOf(","+n+",")?i=i.replace(","+n+",",","):i+=o.label+",",l=!0,null!=(h=this.upFindSameLvObj(c,o))&&(o.label=="/"+h.label?(o.start=h.id,h.end=o.id,l=!1):(0==this.lv||1==o.lv&&1==h.lv)&&(3<=o.id-h.id&&("ul"==h.label||"/ul"==o.label)&&(n=this.htmlArr[h.id+1],a=this.htmlArr[o.id-1],"li"==n.label&&"/li"==a.label&&"/li"==a.label&&(s="",t&&(s="\x3c!--原标签 "+h.label+" 修改成 "+o.label.substr(1)+"--\x3e"),h.html="<"+o.label.substr(1)+h.html.substr(h.label.length+1)+s,h.label=o.label,e++,r++,l=!1)),l&&(s="",t&&(s="\x3c!--原标签 "+o.label+" 替换成 /"+h.label+"--\x3e"),o.html="</"+h.label+o.html.substr(o.label.length+1)+s,o.label="/"+h.label,e++,r++,l=!1))),1==l&&null!=(u=this.upFindSameNameObj(c,o))&&(0==this.lv?(o.html="</"+startObj.label+o.html.substr(o.label.length+1),o.label="/"+startObj.label,e++):(s="",l&&(o.id-u.id==3&&(a=this.htmlArr[u.id+1],h=this.htmlArr[u.id+2],a.label==h.label&&(s="",t&&(s="\x3c!--原标签 "+h.label+" 替换成 /"+a.label+"--\x3e"),h.html="</"+a.label+h.html.substr(h.label.length+1)+s,h.label="/"+a.label,e++,l=!1)),1==l&&(u.html+="\x3c!---有问题标签开始位置--\x3e",o.html="\x3c!---有问题标签结束位置--\x3e"+o.html))))):i+=o.label+","));var f=!1;return this.lv==e&&(f=!0),{lv:this.lv,err:r,repair:e,state:f,errList:i=","==i?"":i}},_XIYUETA.prototype.upFindSameLvObj=function(t,e){for(var l=t-1;0<=l;l--){var s=this.htmlArr[l];if(s&&e.lv==s.lv)return s}return null},_XIYUETA.prototype.upFindSameNameObj=function(t,e){for(var l=t-1;0<=l;l--){var s=this.htmlArr[l];if(s&&e.label=="/"+s.label)return s}return null},xiyueta.fn.extend({swap:function(t){return _xyt.swap(this.selector,t),this},item:function(t){return _xyt.getItem(this.selector,this.x,this.y,t)},config:function(t){t=_xyt.setConfig(t);return null==t?this:t},charset:function(t){return null==t?_xyt.charset():(_xyt.charset(t),this)},fullurl:function(t){return _xyt.common.fullHttpUrl(this.selector,t)},getUrlFileName:function(t){return _xyt.common.getUrlFileName(this.selector,t)},handle:function(t,e,l){return _xyt.getHandleSrc(this.selector,t,e,l)},replace:function(t,e,l){return _xyt.replace(this.selector,t,e,l)},clear:function(){return this},repair:function(t){return _xyt.htmlrepair(t)}}),XiyuetaCommon.prototype.handleFileUrl=function(t){var e="",l=t.indexOf("://");for(-1!=l&&(e=t.substr(0,l+3),t=t.substr(l+3));-1!=t.indexOf("//");)t=t.replace(/\/\//g,"/");if(-1!=(t=-1!=t.indexOf("/./")?t.replace(/\/.\//g,"/"):t).indexOf("/../")){for(var s=[],r=0,i=t.split("/"),n=0;n<=i.length-1;n++)".."==(a=i[n])?(0==r?r=n-1:--r,0<=r&&delete s[r]):(s.push(a),r=0);for(t="",n=0;n<=s.length-1;n++){var a=s[n];null!=s[n]&&(""!=t&&(t+="/"),t+=s[n])}}return e+t},XiyuetaCommon.prototype.fullHttpUrl=function(t,e){if(null==e)return"";if(""==(e=e.replace(/\\/g,"/"))||"./"==e)return"";var l="",s="",r="",i=t.indexOf("://");return-1!=i&&(l=t.substr(0,i+3),i=(t=t.substr(i+3)).lastIndexOf("/"),r=l+t.substr(0,i+1),i=t.indexOf("/"),s=l+t.substr(0,i+1)),"//"==e.substr(0,2)?e="http:"+e:-1==e.indexOf("://")&&(e="/"==e.substr(0,1)?s+e:r+e),this.handleFileUrl(e)},XiyuetaCommon.prototype.getUrlFileName=function(t,e){if(null==e&&(e=""),""==t||null==t)return"";var l=(t=t.replace(/\\/g,"/").trim()).split("/"),s=l[l.length-1],r="",t="";return-1!=(s=-1!=s.indexOf("?")?s.substr(0,s.indexOf("?")):s).indexOf(".")&&(l=s.lastIndexOf("."),r=s.substr(0,l),t=s.substr(l+1).toLowerCase()),"image"==e?""==t?s+=".jpg":-1=="|bmp|jpg|jpeg|gif|png|".indexOf("|"+t+"|")&&(s=r+".jpg"):"css"==e?""==t?s+=".css":-1=="|css|".indexOf("|"+t+"|")&&(s=r+".css"):"js"==e?""==t?s+=".js":-1=="|js|".indexOf("|"+t+"|")&&(s=r+".js"):s=r+"."+t,s},XiyuetaCommon.prototype.setFileNameA=function(t){return t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/\\/g,"撇")).replace(/\//g,"X")).replace(/:/g,"：")).replace(/\*/g,"星")).replace(/\?/g,"？")).replace(/"/g,"“")).replace(/</g,"左")).replace(/>/g,"右")).replace(/\|/g,"横")).replace(/\./g,"。")).replace(/,/g,"，")).replace(/&nbsp;/g," ")).replace(/&quot;/g,"双")).replace(/\n/g,"")},XiyuetaCommon.prototype.checkUrl=function(t){return!!/^\b(((https?|ftp):\/\/)?[-a-z0-9]+(\.[-a-z0-9]+)*\.(?:com|edu|gov|int|mil|net|org|biz|info|name|museum|asia|coop|aero|[a-z][a-z]|((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]\d)|\d))\b(\/[-a-z0-9_:\@&?=+,.!\/~%\$]*)?)$/i.test(t=null==t?"":t)},XiyuetaCommon.prototype.getDomain=function(t){if("string"!=typeof t)return"";if(-1<t.indexOf("//")){var e=t.indexOf("//",1),e=t.substring(e+1,t.length),t=e.indexOf("/",1);return e=e.substring(1,t)}return""},_XIYUETA.prototype.cutLabel=function(t,e){for(var l="",s=0;s<=this.htmlArr.length-1;s++)null!=(f=this.htmlArr[s])&&("/style"==f.label?l+=f.upHtml:"link"==f.label&&"stylesheet"==f.rel&&(l+=f.content));var r="*,body,",i=-1;if(""!=(p=this.getDocument(t))){var n=p=p.replace(/,/,""),a=p;-1!=p.indexOf("|")&&(n=(u=p.split("|"))[0],a=u[1]);for(var h,s=n;s<=parseInt(a)-1;s++)null!=(f=this.htmlArr[s])&&"/"!=f.label.substr(0,1)&&(-1==i&&(f.label,i=f.lv),i+1==f.lv&&f.label,i+2==f.lv&&f.label,i+3==f.lv&&f.label,r+=f.label+",",null!=(h=this.handleLabelParam(f,"id"))&&(r+="#"+h.toLowerCase()+","),null!=(h=this.handleLabelParam(f,"class"))&&(r+="."+h.toLowerCase().replace(/ /g,",.")+","));for(var u=r.split(","),r="",s=0;s<=u.length-1;s++)-1==(","+r+",").indexOf(","+u[s]+",")&&(""!=r&&(r+=","),r+=u[s]);var o="",c=new _XIYUETACSS;c.cssParse(l);for(var f,s=0;s<=c.cssArr.length-1;s++)if(null!=(f=c.cssArr[s]))for(var p=","+f.label+",",m=(f.label,0);m<=u.length-1;m++)-1==p.indexOf(","+u[m]+",")&&-1==p.indexOf(","+u[m]+" ")||-1==("\n"+o+"\n").indexOf("\n"+f.html+"\n")&&(o+=f.html+"\n");xiyuetaCSS(o).parse(),""!=(o=xiyuetaCSS().print("zip"))&&(o="<style>"+o+"\n</style>\n");n=xiyueta(t).html(null,"all");this.htmlParse(n);n=o+this.printHtml("format")}return n},_XIYUETA.prototype.getUrlStr=function(e,l){var s=this;$.ajax({url:this.config.serverurl+"?act=getUrlStr&n="+Math.random(),type:"POST",data:{httpurl:l},error:function(t,e,l){},success:function(t){xiyuetaCSS(t).parse(),xiyuetaCSS().allcss("|url","server="+l),e.content=xiyuetaCSS().print(),s.config.downcss--,0==s.config.downcss?alert("下载全部CSS完成，可以点击下一步 了"):alert("下载CSS完成,还乘"+s.config.downcss)}})},xiyueta.fn.extend({cutlabel:function(t){return globalXYG.cutLabel(this.selector,t)}});var _XIYUETACSS=function(t){"use strict";this.cssSource=t=null==t?"":t,this.cssArr=[],this.common=new XiyuetaCommon,this.config={parentdir:"../",imagesdir:"images/"},this.cssParse=function(t){null!=t&&(this.cssSource=t,this.cssArr=[]);for(var e,l="",s="",r="",i="",n=!1,a=!1,h=!1,u=!1,o=!1,c=0,f=0;f<=this.cssSource.length-1;f++)e=l,l=this.cssSource.substr(f,1),n?(r+=l,h?"/"==l&&"*"==e&&(n=h=!1,this.cssArr.push({lv:1,label:"/*",upHtml:i,html:r}),i=r=""):a&&"*"==l&&"/"==e?h=!0:u?!o||";"!=l&&"\n"!=l?" "==l&&a?"@charset "==r.toLowerCase()?a=!(o=!0):"@font-face "==r.toLowerCase()&&(u=!1):"{"==l&&("@font-face "==r.toLowerCase()?u=!1:(u=n=a=!1,this.cssArr.push({lv:1,label:s.toLowerCase().trim(),upHtml:i,html:r}),c++,i=r="")):(u=n=a=o=!1,this.cssArr.push({lv:1,label:s.toLowerCase().trim(),upHtml:i,html:r}),i=r=""):"{"==l&&a?a=!1:"}"==l&&(n=a=!1,this.cssArr.push({lv:c+1,label:s.toLowerCase().trim(),upHtml:i,html:r}),i=r=""),a&&(" "!=l||" "!=e&&","!=e)&&(s+=l)):" "!=l&&";"!=l&&"\n"!=l?"}"==l&&1==c?(this.cssArr.push({lv:c,label:"}",upHtml:i,html:"}"}),i=r="",c--):(i=r,a=n=!0,"@"==(s=r=l)&&(u=!0)):r+=l;""!=r&&this.cssArr.push({lv:c,label:"",upHtml:"",html:r})},this.handleLabelParam=function(t,e,l){if(null==e&&(e="[All]"),null==l&&null!=t[e])return t[e];var s,r="";-1!=e.indexOf("|")&&(e=(s=e.split("|"))[0],r=s[1],""==e&&(e="[All]"));for(var i=!1,n="",a="",h=!1,u="",o=!1,c=!0,f=0,p=!1,m="",b=t.html.indexOf("{")+1;b<=t.html.length-1;b++){var d=t.html.substr(b,1);if(h)if(o){if(0!=(p=1==p&&")"==d?!1:p)||d!=u&&"}"!=d&&b!=t.html.length-1)a+=d,"("==d&&(p=!0);else if(t[n=n.toLowerCase().trim()]=a,o=h=!1,u="",e==n||"[All]"==e)if(null==l){if("url"!=r)return a;""!=(a=this.getSetCssBg(a))&&(""!=m&&(m+="\n"),m+=a)}else{var g=f,x=f+a.length;c&&(g++,x++);var y=t.html.substr(0,g),g=t.html.substr(x);if("url"!=r){v=y+l+g;return t.html=v,t[n]=l,t}x=this.getSetCssBg(a,l);if(""!=x){""!=m&&(m+="\n"),m+=x;var v=y+x+g;return t.html=v,b=(y+(t[n]=x)).length,t}}}else" "!=d&&(u=";",f=b,c=!(o=!0),a=d);else i?":"==d?(h=!(i=!1),u=a=""):" "!=d&&(n+=d):" "!=d&&(i=!0,n=d)}return null!=l&&(t.html=t.html.replace("{","{"+e+":"+l+";")),m},this.getSetCss=function(t,e,l){t=(t=null==t?"[All]":t).trim();for(var s=0;s<=this.cssArr.length-1;s++){var r=this.cssArr[s];if(null!=r&&(t==r.label||"[All]"==t))return null==e?r.html:this.handleLabelParam(r,e,l)}},this.getSetCssBg=function(t,e){if(-1==t.indexOf(","))return this.handleCssBg(t,e);for(var l=t.split(","),s="",r=0;r<l.length;r++){var i=l[r];""!=s&&(s+=","),s+=i=this.handleCssBg(i,e)}return s},this.handleCssBg=function(t,e){if(null==t)return"";if(null==e){if(-1==t.indexOf("(")||-1==t.indexOf(")"))return null==e||"dir="==e.substr(0,4)||"server="==e.substr(0,7)?"":t;if(-1==t.toLowerCase().indexOf("url"))return null==e||"dir="==e.substr(0,4)||"server="==e.substr(0,7)?"":t}for(var l="",s=!1,r=!1,i="",n=-1,a=0;a<=t.length-1;a++){var h=t.substr(a,1);if(s)if(r){if(i==h){var u=t.substr(n,a-n);if(null!=e)if("server="==e.substr(0,7)){if(-1!=u.indexOf("data:"))return t;u=t.substr(0,n)+this.common.fullHttpUrl(e.substr(7),u)+t.substr(a)}else if("dir="==e.substr(0,4)){if(-1!=u.indexOf("data:"))return t;u=t.substr(0,n)+e.substr(4)+this.common.getUrlFileName(u)+t.substr(a)}else-1==u.indexOf("data:")&&(u=t.substr(0,n)+e+t.substr(a));return u}}else""!=h&&('"'==h||"'"==h?(r=!0,i=h,-1==n&&(n=a+1)):(r=!0,i=")",-1==n&&(n=a)));else if("("==h){if("url"==l.trim().toLowerCase().substr(-3,3))s=!0;else if(null==e)return""}else l+=h}return t},this.getSetAllCss=function(t,e,l){for(var s=","+(t=(t=null==t?"[All]":t).trim())+",",r="",i=0;i<=this.cssArr.length-1;i++){var n,a,h=this.cssArr[i];null!=h&&(n=","+h.label+",",h.label,-1==n.indexOf(s)&&"[All]"!=t||(null==e||"object"==typeof(a=this.handleLabelParam(h,e,l))?(""!=r&&(r+="\n"),r+=h.html):a&&(""!=r&&(r+="\n"),r+=a)))}return r},this.handleCssCharset=function(t){for(var e=0;e<=this.cssArr.length-1;e++){var l=this.cssArr[e];if(null!=l)if("@charset"==l.label)return null!=t?(l.html='@charset "'+t+'";',""):l.html.substr(9).replace(/"/g,"").replace(/'/g,"").replace(/;/g,"").trim().toLowerCase()}return""},this.handleCssBackGround=function(t,e){null==e&&(e="");var l="";xiyuetaCSS().allcss("|url","server="+e),l=(l=xiyuetaCSS().allcss("|url")).replace(/,/g,"\n"),xiyuetaCSS().allcss("|url","dir="+this.config.parentdir+this.config.imagesdir);for(var s,r=l.split("\n"),i="",n=0;n<=r.length-1;n++)""!=(s=r[n])&&(""!=i&&(i+="[,]"),i+=(s=-1!=s.indexOf("?")?s.substr(0,s.indexOf("?")):s)+"[|]"+this.config.parentdir+this.config.imagesdir+xiyueta().getUrlFileName(s));return i},this.setConfig=function(t){if(null==t)return this.config;if(null!=t.imagesdir){this.config.imagesdir=t.imagesdir;for(var e=t.cssdir.split("/"),l="",s=0;s<=e.length-2;s++)l+="../";this.config.parentdir=l}null!=t.parentdir&&(this.config.parentdir=t.parentdir)},this.printCss=function(t){for(var e="",l=0;l<=this.cssArr.length-1;l++){var s,r=this.cssArr[l];null!=r&&(s=r.upHtml+r.html,"zip"==t?s="/*"==r.label?"":s.replace(/  /g," ").replace(/  /g," ").replace(/{ /g,"{").replace(/ {/g,"{").replace(/\n/g,"").trim():"format"==t&&(s=s.trim()+"\n"),""!=s&&(e+=s))}return e},this.debug=function(){console.log(this.cssArr)}},_xytcss=new _XIYUETACSS,xiyuetaCss=function(t,e,l){return new xiyuetaCss.fn.init(t,e,l)};xiyuetaCss.fn=xiyuetaCss.prototype={length:1,selector:"",docList:"",x:null,y:null},xiyuetaCss.extend=xiyuetaCss.fn.extend=function(){var t,e,l,s=arguments[0]||{},r=1,i=arguments.length;for(r===i&&(s=this,r--);r<i;r++)if(null!=(t=arguments[r]))for(e in t)l=t[e],"__proto__"!==e&&s!==l&&void 0!==l&&(s[e]=l);return s},(init=xiyuetaCss.fn.init=function(t,e,l){this.length=0,this.selector=t,this.x=e,this.y=l,null==this.selector&&(this.selector="")}).prototype=xiyuetaCss.fn,(xiyuetaCSS=$xytcss=$css=xiyuetaCss).fn.extend({css:function(t,e){return null!=e?(_xytcss.getSetCss(this.selector,t,e),this):_xytcss.getSetCss(this.selector,t)},allcss:function(t,e){return _xytcss.getSetAllCss(this.selector,t,e)},handlecssimg:function(t,e){return _xytcss.handleCssBackGround(t,e)},charset:function(t){return _xytcss.handleCssCharset(t)},parse:function(t){return _xytcss.cssParse(t),this},config:function(t){return _xytcss.setConfig(t)},print:function(t){return _xytcss.printCss(t)},debug:function(t){return _xytcss.debug(t)}});var _XIYUETAASP=function(t){"use strict";this.aspSource=t=null==t?"":t,this.aspArr=[],this.common=new XiyuetaCommon,this.config={},this.phpPublicObjectList="",this.phpPublicFunList="",this.aspParse=function(t){null!=t&&(this.aspSource=t,this.aspArr=[]);for(var e="",l="",s="",r="",i="",n="",a="",h=!1,u=!1,o=0,c="",f=0,p=this.aspSource.split("\n"),m=0;m<=p.length-1;m++){for(var b,d,g=0;g<=p[m].length;g++)if(l=e,e=p[m].substr(g,1),s=p[m].substr(g+1,1),0==h)"%"==e&&"<"==l&&(h=!0,this.aspArr.push({lv:o,type:"<asp>",label:"<%",upHtml:a,html:"<%",tagpair:2}),r=a=n="",o++);else if("%"==e&&">"==s)h=!1,o--,this.aspArr.push({lv:o,type:"<asp>",label:"%>",upHtml:a,html:"%>",tagpair:2}),r=a=n="",g++,l=e,e=p[m].substr(g,1),s=p[m].substr(g+1,1);else if(n+=e,'"'==e||""!=c)'"'==e&&f++,f%2==0&&'"'!=s?(c+=e,this.aspArr.push({lv:o,type:"<str>",label:r,upHtml:a,html:c,tagpair:2}),f=0,r=a=n=c=""):c+=e;else if("("==e)o++,this.aspArr.push({lv:o,type:"<(>",label:e,upHtml:a,html:n,tagpair:2}),r=a=n="";else if(")"==e)this.aspArr.push({lv:o,type:"<)>",label:e,upHtml:a,html:n,tagpair:2}),r=a=n="",o--;else if(-1!="|&|,|+|-|*|/|=|:|>|<|".indexOf("|"+e+"|"))this.aspArr.push({lv:o,type:"<fuhao>",label:e,upHtml:a,html:n,tagpair:1}),"="!=e&&">"!=e||">"!=(d=this.aspArr[this.aspArr.length-2]).label&&"<"!=d.label||(d.label+=e,d.html+=" "+e,this.aspArr.pop()),r=a=n="";else{if("'"==e){this.aspArr.push({lv:o,type:"<note>",label:e,upHtml:n,html:p[m].substr(g+1),tagpair:1}),r=a=n="";break}""==e||" "==e||"\t"==e||-1=="' ()+-*/=><&,".indexOf(s)&&g!=p[m].length?" "!=e&&"\t"!=e&&(r+=e.toLowerCase()):(r+=e.toLowerCase(),i=-1!="0123456789".indexOf(r.substr(0,1))?"<int>":"("==s||-1!=",dim,if,then,elseif,else,end,function,select,case,call,for,to,next,set,nothing,do,while,loop,and,true,false,vbcrlf,in,class,new,".indexOf(","+r+",")||-1!=r.indexOf(".")?"<fun>":"<var>",this.aspArr.push({lv:o,type:i,label:r,upHtml:a,html:n,tagpair:2}),"function"==r?"end"==(b=this.aspArr[this.aspArr.length-2]).label?(o--,b.lv--,b.label+="function",b.html+=" function",this.aspArr.pop()):o++:"if"==r?"end"==(b=this.aspArr[this.aspArr.length-2]).label?(o--,b.lv--,b.label+="if",b.html+=" if",this.aspArr.pop()):o++:"else"==r||"elseif"==r||"then"==r?(this.aspArr[this.aspArr.length-1].lv--,"else"==r&&"case"==(b=this.aspArr[this.aspArr.length-2]).label&&(b.lv,b.label+="else",b.html+=" else",this.aspArr.pop())):"select"==r?"end"==(b=this.aspArr[this.aspArr.length-2]).label?(o--,b.lv--,b.label+="select",b.html+=" select",this.aspArr.pop(),u&&(u=!1,o--,b.lv--)):o++:"case"==r?"select"==(d=this.aspArr[this.aspArr.length-2]).label?(d.label+="case",d.html+=" case",this.aspArr.pop()):u?this.aspArr[this.aspArr.length-1].lv--:(o++,u=!0):"class"==r?"end"==(b=this.aspArr[this.aspArr.length-2]).label?(o--,b.lv--,b.label+="class",b.html+=" class",this.aspArr.pop()):o++:"each"==r?"for"==(d=this.aspArr[this.aspArr.length-2]).label&&(d.label+="each",d.html+=" each",this.aspArr.pop()):"while"==r?("do"==(d=this.aspArr[this.aspArr.length-2]).label&&(d.label+="while",d.html+=" while",this.aspArr.pop()),o++):"loop"==r?(o--,this.aspArr[this.aspArr.length-1].lv--):"for"==r?o++:"next"==r&&(o--,this.aspArr[this.aspArr.length-1].lv--),i=r=a=n="")}m+1<p.length&&this.aspArr.push({lv:o,type:"<br>",label:"\n",upHtml:"",html:"\n",tagpair:1})}},this.toPHP=function(t){for(var e,l,s="",r="",i=[],n=[],a=[],h=0,u=!1,o=!1,c="",f="",p="",m=!1,b=-1,d=-1,g=!1,x=-1,y="",v=",",A=","+this.phpPublicFunList,O=","+this.phpPublicObjectList,L=-1,C=!1,_=0;_<=this.aspArr.length-1;_++)L==_&&(":"==(i=this.aspArr[_]).label?(r+=":",_++):r+=":",L=-1),0<_&&(n=this.aspArr[_-1]),i=this.aspArr[_],a=[],_<this.aspArr.length&&(a=this.aspArr[_+1]),"<br>"==n.type&&(r+=this.common.copyStr("    ",i.lv+h)),"<%"==i.label?(r+="<?PHP",h--):"%>"==i.label?r+="?>":"<br>"==i.type?r+="\n":"<note>"==i.type?r+="//"+i.html:"<var>"==i.type?(e=!0,-1!=A.indexOf(","+i.label+",")?"class"==n.label?(e=!1,r+=i.label+"{"):"new"==n.label?r+=i.label+"()":"="==a.label?(r+="return ",_++):r+=i.label:r+="$"+i.label,"<br>"==a.type&&""==p&&e&&(r+=";")):"<fuhao>"==i.type||"<int>"==i.type||"<(>"==i.type||"<)>"==i.type?u&&"="==i.label?r+="==":"&"==i.label?r+=".":"("==i.label?b==i.lv?r+="[":r+="(":")"==i.label?(b==i.lv?(r+="]",b=-1):x==i.lv?(s+=r+","+y+")",x=-1,y=r=""):d==i.lv?(d=-1,r+="){"):r+=")","<br>"!=a.type&&"<note>"!=a.type||(r+=";")):","==i.label?m?(r+="]=",m=!1):x==i.lv?(y=r,r=""):o?(r+=";","<br>"!=a.type&&"<note>"!=a.type||(o=!1)):r+=",":":"==i.label?r+=";":"<>"==i.label?r+="!=":"<int>"==i.type?(r+=i.label,"<br>"!=a.type&&"<note>"!=a.type||-1!=L||(r+=";")):r+=i.label:"<str>"==i.type?(r+=i.html,"<br>"!=a.type&&"<note>"!=a.type||-1!=L||(r+=";")):"<fun>"==i.type&&("response.write"==i.label?r+="echo":"nothing"==i.label?r+="null":"and"==i.label?r+=" && ":"ubound"==i.label?r+="count":"split"==i.label?(v+=this.aspArr[_-2].label+".add,",s+=r+="explode(",r="",x=i.lv+1,_++):"new"==i.label?r+="new ":"function"==i.label?(d=this.aspArr[_+2].lv,r+=i.label+" ",-1==A.indexOf(","+a.label+",")&&(A+=a.label+",")):"endfunction"==i.label?r+="}":"if"==i.label?(r+=i.label,"("!=a.label&&(r+="("),u=!0):"elseif"==i.label?(r+="}else if","("!=a.label&&(r+="("),u=!0):"then"==i.label?(")"!=n.label&&(r+=")"),r+="{",u=!1):"else"==i.label?r+="}else{":"endif"==i.label?r+="}":"selectcase"==i.label?(r+="switch ","("!=a.label&&(r+="("),p="selectcase"):"endselect"==i.label?(r+="}",C&&(s+=this.common.copyStr("    ",i.lv+1)+"break;\n"),C=!1):"caseelse"==i.label?(r+="default ",C&&(s+=this.common.copyStr("    ",i.lv)+"break;\n"),C=!0,L=_+1):"case"==i.label?(r+=i.label+" ",C&&(s+=this.common.copyStr("    ",i.lv)+"break;\n"),C=!0,L=_+2):"vbcrlf"==i.label?r+='"\\n"':"createobject"==i.label?(0<_-1&&(v+=this.aspArr[_-2].label+".add,"),_+1<this.aspArr.length&&'"scripting.dictionary"'==this.aspArr[_+2].html.toLowerCase()&&(r+="array();",_+=3)):-1!=v.indexOf(","+i.label+",")?(r+="$"+i.label.substr(0,i.label.indexOf("."))+"[",","==this.aspArr[_+2].label&&(m=!0)):-1!=v.indexOf(","+i.label+".")?(r+="$"+i.label,b=a.lv):"dowhile"==i.label?(r+="while","("!=a.label&&(r+="("),g=!0):"loop"==i.label?r+="}":"class"==i.label?(r+="class ",-1==A.indexOf(","+a.label+",")&&(A+=a.label+","),-1==O.indexOf(","+a.label+",")&&(O+=a.label+",")):"endclass"==i.label?r+="}":"foreach"==i.label?(l=this.aspArr[_+1],r+="foreach($"+this.aspArr[_+3].label+" as $key=>$"+l.label+"){",_+=3):"for"==i.label?(r+=i.label,"("!=a.label&&(r+="("),c="for",f=a.label):"for"==c&&"to"==i.label?(l=this.aspArr[_+1],"ubound"==a.label?r+=";$"+f+"<":r+=";$"+f+"<=",c="forto"):"next"==i.label?r+="}":"dim"==i.label?o=!0:-1!=i.label.indexOf(".")?r+="$"+i.label.replace(/\./g,"->"):-1==",call,set,".indexOf(","+i.label+",")&&(r+=i.label),"<br>"==a.type&&-1==",endfunction,then,endif,next,else,endselect,endclass,".indexOf(","+i.label+",")&&0==g&&(r+=";")),"forto"!=c||"<br>"!=a.type&&"<note>"!=a.type||"to"==i.label?"selectcase"!=p||"<br>"!=a.type&&"<note>"!=a.type||"selectcase"==i.label?!g||"<br>"!=a.type&&"<note>"!=a.type||(")"!=n.label&&(r+=")"),r+="{",u=g=!1):(p="",")"!=n.label&&(r+=")"),r+="{"):("<note>"==a.type&&(r+=";"),r+="$"+f+"++",f=c="",")"!=n.label&&(r+=")"),r+="{"),"<br>"==i.type&&(s+=r,r="",o=!1);return s+r},this.aspBeautify=function(){for(var t,e=0;e<=this.aspArr.length-1;e++)"class"==this.aspArr[e].label&&e<this.aspArr.length&&(t=this.aspArr[e+1],this.phpPublicObjectList+=t.label+",",this.phpPublicFunList+=t.label+",")},this.debug=function(){console.log(this.aspArr)}},_xytasp=new _XIYUETAASP;xiyuetaASP=$xytasp=$asp=function(t){return{parse:function(t){return _xytasp.aspParse(t),this},beautify:function(){return _xytasp.aspBeautify(t),this},toPHP:function(t){return _xytasp.toPHP(t)},debug:function(t){return _xytasp.debug(t)}}};